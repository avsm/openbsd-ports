$OpenBSD: patch-lib_rubygems_installer_rb,v 1.5 2008/01/12 14:51:15 bernd Exp $

This is for GEM_SKIPDEPENDS in ruby.port.mk.

--- lib/rubygems/installer.rb.orig	Fri Dec 21 01:43:06 2007
+++ lib/rubygems/installer.rb	Fri Dec 21 16:46:28 2007
@@ -73,6 +73,7 @@ class Gem::Installer
     @format_executable = options[:format_executable]
     @security_policy = options[:security_policy]
     @wrappers = options[:wrappers]
+    @skip_dependencies = options[:skip_dependencies]
 
     begin
       @format = Gem::Format.from_file_by_path @gem, @security_policy
@@ -117,7 +118,12 @@ class Gem::Installer
 
       unless @ignore_dependencies then
         @spec.dependencies.each do |dep_gem|
-          ensure_dependency @spec, dep_gem
+          if @skip_dependencies && @skip_dependencies.include?(dep_gem.name)
+            say "Skipping '#{dep_gem.name}' dependency."
+            @spec.dependencies.delete(dep_gem)
+          else
+            ensure_dependency @spec, dep_gem
+          end
         end
       end
     end

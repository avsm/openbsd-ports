$OpenBSD: patch-Makefile,v 1.3 2010/04/21 07:02:42 giovanni Exp $
--- Makefile.orig	Tue Mar 16 02:52:51 2010
+++ Makefile	Thu Mar 18 09:10:29 2010
@@ -1,9 +1,9 @@
-PREFIX 		?= /usr/local
+PREFIX 		?= ${TRUEPREFIX}
 LIBINSTALLDIR 	?= /lib
-XDGCONFDIR 	?= /etc/xdg
+XDGCONFDIR 	?= ${PREFIX}/share/exaile/xdg
 
-EXAILELIBDIR 	= $(DESTDIR)$(PREFIX)$(LIBINSTALLDIR)/exaile
-EXAILESHAREDIR 	= $(DESTDIR)$(PREFIX)/share/exaile
+EXAILELIBDIR 	= $(DESTDIR)${MODPY_SITEPKG}/exaile
+EXAILESHAREDIR 	= $(DESTDIR)${TRUEPREFIX}/share/exaile
 EXAILECONFDIR 	= $(DESTDIR)$(XDGCONFDIR)/exaile
 
 .PHONY: dist test coverage clean sanitycheck
@@ -17,12 +17,12 @@ all_no_locale: compile
 	@echo "Ready to install..."
 
 compile:
-	python -m compileall -q xl xlgui
-	-python -O -m compileall -q xl xlgui
+	${MODPY_BIN} -m compileall -q xl xlgui
+	-${MODPY_BIN} -O -m compileall -q xl xlgui
 	$(MAKE) -C plugins compile
 
 make-install-dirs:
-	mkdir -p $(DESTDIR)$(PREFIX)/bin
+	mkdir -p $(DESTDIR)${TRUEPREFIX}/bin
 	mkdir -p $(EXAILELIBDIR)
 	mkdir -p $(EXAILELIBDIR)/xl
 	mkdir -p $(EXAILELIBDIR)/xl/metadata
@@ -44,8 +44,8 @@ make-install-dirs:
 	mkdir -p $(EXAILESHAREDIR)/data/ui
 	mkdir -p $(EXAILESHAREDIR)/data/migrations
 	mkdir -p $(EXAILESHAREDIR)/data/migrations/migration_200907100931
-	mkdir -p $(DESTDIR)$(PREFIX)/share/pixmaps
-	mkdir -p $(DESTDIR)$(PREFIX)/share/applications
+	mkdir -p $(DESTDIR)${TRUEPREFIX}/share/pixmaps
+	mkdir -p $(DESTDIR)${TRUEPREFIX}/share/applications
 	mkdir -p $(EXAILECONFDIR)
 
 uninstall:
@@ -89,18 +89,18 @@ install-target: make-install-dirs
 	install -m 644 data/images/scalable/*.svg $(EXAILESHAREDIR)/data/images/scalable
 	install -m 644 data/images/*.png $(EXAILESHAREDIR)/data/images
 	install -m 644 data/images/48x48/exaile.png \
-		$(DESTDIR)$(PREFIX)/share/pixmaps/exaile.png
+		$(DESTDIR)${TRUEPREFIX}/share/pixmaps/exaile.png
 	install -m 644 data/ui/*.ui $(EXAILESHAREDIR)/data/ui
 	install -m 644 data/migrations/*.py $(EXAILESHAREDIR)/data/migrations/
 	install -m 644 data/migrations/migration_200907100931/*.py \
 	    	$(EXAILESHAREDIR)/data/migrations/migration_200907100931/
 	install -m 644 data/exaile.desktop \
-		$(DESTDIR)$(PREFIX)/share/applications/	
+		$(DESTDIR)${TRUEPREFIX}/share/applications/	
 	install -m 644 data/config/settings.ini $(EXAILECONFDIR)
 	# 2010-03-12 danfuhry: moved this to an external script to clean up syntax
 	# and avoid makefile limitations
-	tools/generate-launcher "$(DESTDIR)" "$(PREFIX)" "$(LIBINSTALLDIR)"
-	chmod 755 $(DESTDIR)$(PREFIX)/bin/exaile
+	tools/generate-launcher "$(DESTDIR)" "${TRUEPREFIX}" "$(LIBINSTALLDIR)"
+	chmod 755 $(DESTDIR)${TRUEPREFIX}/bin/exaile
 	$(MAKE) -C plugins install
 
 locale:
@@ -109,10 +109,10 @@ locale:
 install-locale:
 	for f in `find po -name exaile.mo` ; do \
 	  install -d -m 755 \
-	    `echo $$f | sed "s|^po|$(DESTDIR)$(PREFIX)/share/locale|" | \
+	    `echo $$f | sed "s|^po|$(DESTDIR)${TRUEPREFIX}/share/locale|" | \
 	      xargs dirname` && \
 	  install -m 644 $$f \
-	    `echo $$f | sed "s|^po|$(DESTDIR)$(PREFIX)/share/locale|"` ; \
+	    `echo $$f | sed "s|^po|$(DESTDIR)${TRUEPREFIX}/share/locale|"` ; \
 	  done
 
 plugins_dist:

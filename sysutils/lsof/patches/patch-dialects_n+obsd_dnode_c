$OpenBSD: patch-dialects_n+obsd_dnode_c,v 1.7 2005/12/20 08:13:46 pvalchev Exp $
--- dialects/n+obsd/dnode.c.orig	Thu Dec 30 11:42:30 2004
+++ dialects/n+obsd/dnode.c	Mon Dec 19 23:56:13 2005
@@ -563,12 +563,12 @@ process_overlaid_node:
 		nty = EXT2NODE;
 
 # if	defined(HASI_E2FS_PTR)
-		if (i.i_din.e2fs_din
-		&&  !kread((KA_T)i.i_din.e2fs_din, (char *)&ed, sizeof(ed)))
+		if (i.dinode_u.e2fs_din
+		&&  !kread((KA_T)i.dinode_u.e2fs_din, (char *)&ed, sizeof(ed)))
 		    edp = &ed;
 # else	/* !defined(HASI_E2FS_PTR) */
 #  if	HASEXT2FS<2
-		edp = &i.i_din.e2fs_din;
+		edp = &i.dinode_u.e2fs_din;
 #  else	/* HASEXT2FS>=2 */
 		edp = &i.i_e2din;
 #  endif	/* HASEXT2FS>=2 */
@@ -588,16 +588,16 @@ process_overlaid_node:
 		    &&  !kread((KA_T)i.i_ump, (char *)&um, sizeof(um))) {
 			if (um.um_fstype == UFS1) {
 			    ffs = 1;
-			    if (i.i_din.ffs1_din
-			    &&  !kread((KA_T)i.i_din.ffs1_din, (char *)&u1,
+			    if (i.dinode_u.ffs1_din
+			    &&  !kread((KA_T)i.dinode_u.ffs1_din, (char *)&u1,
 				       sizeof(u1)))
 			    {
 				u1s = 1;
 			    }
 			} else if (um.um_fstype == UFS2) {
 			    ffs = 2;
-			    if (i.i_din.ffs2_din
-			    &&  !kread((KA_T)i.i_din.ffs2_din, (char *)&u2,
+			    if (i.dinode_u.ffs2_din
+			    &&  !kread((KA_T)i.dinode_u.ffs2_din, (char *)&u2,
 				       sizeof(u2)))
 			    {
 				u2s = 1;
@@ -719,7 +719,7 @@ process_overlaid_node:
 		}
 # else	/* !defined(HASI_E2FS_PTR) */
 #  if	HASEXT2FS<2
-		rdev = i.i_din.e2fs_din.e2di_rdev;
+		rdev = i.dinode_u.e2fs_din.e2di_rdev;
 #  else	/* HASEXT2FS>=2 */
 		rdev = i.i_e2din.e2di_rdev;
 #  endif	/* HASEXT2FS>=2 */

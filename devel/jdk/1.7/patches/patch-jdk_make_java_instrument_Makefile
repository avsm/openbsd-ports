$OpenBSD: patch-jdk_make_java_instrument_Makefile,v 1.1 2008/03/19 18:05:45 kurt Exp $
--- jdk/make/java/instrument/Makefile.orig	Tue Oct 30 05:04:22 2007
+++ jdk/make/java/instrument/Makefile	Wed Nov  7 18:01:59 2007
@@ -102,6 +102,15 @@ ifeq ($(PLATFORM), windows)
   # equivalent of strcasecmp is stricmp on Windows
   CPPFLAGS_COMMON += -Dstrcasecmp=stricmp
 else
+ifeq ($(PLATFORM), bsd)
+  LDFLAGS += -Wl,--whole-archive
+  LDFLAGS += $(OUTPUTDIR)/tmp/java/jli/$(OBJDIRNAME)/static/libjli.a
+  LDFLAGS += -Wl,--no-whole-archive
+  ICONV_DIR = /usr/local
+# Use CPPFLAGS instead of OTHER_INCLUDES to force this last
+  CPPFLAGS += -I$(ICONV_DIR)/include
+  OTHER_LDLIBS += -L$(ICONV_DIR)/lib -liconv
+else
   LDFLAGS += -L $(LIBDIR)/$(LIBARCH)/jli
   OTHER_LDLIBS += -ljli
   OTHER_LDLIBS += -ldl 
@@ -113,6 +122,7 @@ else
     LDFLAGS += -Wl,--allow-shlib-undefined
     LDFLAGS += -Wl,-rpath -Wl,\$$ORIGIN/jli
   endif
+endif
 endif
 
 #

$OpenBSD: patch-configure,v 1.3 2009/09/22 11:19:37 ajacoutot Exp $
--- configure.orig	Sat Aug 15 03:06:17 2009
+++ configure	Mon Sep 21 23:43:54 2009
@@ -3013,8 +3013,11 @@ _ACEOF
 		;;
 	*-*-*openbsd*)
 		platform_win32=no
-		CPPFLAGS="$CPPFLAGS -D_THREAD_SAFE -DGC_FREEBSD_THREADS -DPLATFORM_BSD"
-		libmono_cflags="-D_THREAD_SAFE"
+		CPPFLAGS="$CPPFLAGS -D_THREAD_SAFE -DGC_FREEBSD_THREADS -DPLATFORM_BSD -D_GNU_SOURCE -D_REENTRANT -DUSE_MMAP"
+		if test "x$disable_munmap" != "xyes"; then
+			CPPFLAGS="$CPPFLAGS -DUSE_MUNMAP"
+		fi
+		libmono_cflags="-D_THREAD_SAFE -D_REENTRANT"
 		LDFLAGS="$LDFLAGS -pthread"
 		libmono_ldflags="-pthread"
 		need_link_unlink=yes
@@ -22353,6 +22356,7 @@ cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
+#include <sys/param.h>
 #include <$ac_header>
 _ACEOF
 rm -f conftest.$ac_objext
@@ -29227,13 +29231,13 @@ fi
 
 		;;
 		*)
-			{ echo "$as_me:$LINENO: checking for main in -lpthread" >&5
-echo $ECHO_N "checking for main in -lpthread... $ECHO_C" >&6; }
+			{ echo "$as_me:$LINENO: checking for main in -pthread" >&5
+echo $ECHO_N "checking for main in -pthread... $ECHO_C" >&6; }
 if test "${ac_cv_lib_pthread_main+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
+LIBS="-pthread  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -29283,7 +29287,7 @@ fi
 { echo "$as_me:$LINENO: result: $ac_cv_lib_pthread_main" >&5
 echo "${ECHO_T}$ac_cv_lib_pthread_main" >&6; }
 if test $ac_cv_lib_pthread_main = yes; then
-  LIBS="$LIBS -lpthread"
+  LIBS="$LIBS -pthread"
 fi
 
 		;;
@@ -37294,6 +37298,7 @@ _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
+#include <sys/param.h>
 #include <sys/types.h>
 		 #include <sys/sysctl.h>
 		 #include <sys/proc.h>
@@ -37337,6 +37342,7 @@ _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
+#include <sys/param.h>
 #include <sys/types.h>
 		 #include <sys/sysctl.h>
 		 #include <sys/proc.h>
@@ -39366,7 +39372,7 @@ echo "${ECHO_T}$try_dev_random" >&6; }
 
 case "{$target}" in
     *-openbsd*)
-    NAME_DEV_RANDOM="/dev/srandom"
+    NAME_DEV_RANDOM="/dev/arandom"
     ;;
 
 
@@ -39870,8 +39876,8 @@ JIT_SUPPORTED=no
 INTERP_SUPPORTED=no
 LIBC="libc.so.6"
 INTL="libc.so.6"
-SQLITE="libsqlite.so.0"
-SQLITE3="libsqlite3.so.0"
+SQLITE="libsqlite.so"
+SQLITE3="libsqlite3.so"
 X11="libX11.so"
 
 sizeof_register="SIZEOF_VOID_P"
@@ -40163,6 +40169,15 @@ _ACEOF
 		ACCESS_UNALIGNED="no"
 		JIT_SUPPORTED=yes
 		jit_wanted=true
+		;;
+	arm*-openbsd*)
+		TARGET=ARM;
+		arch_target=arm;
+		ACCESS_UNALIGNED="no"
+		JIT_SUPPORTED=no
+		jit_wanted=no
+		INTERP_SUPPORTED=yes
+		interp_wanted=true
 		;;
 	s390-*-linux*)
 		TARGET=S390;

$OpenBSD: patch-filter_Makefile,v 1.5 2009/04/27 08:25:39 bernd Exp $
--- filter/Makefile.orig	Sat Sep  6 02:30:39 2008
+++ filter/Makefile	Tue Mar 17 16:21:50 2009
@@ -57,7 +57,7 @@ all:	$(TARGETS)
 
 clean:
 	$(RM) $(OBJS) $(TARGETS)
-	$(RM) libcupsimage.so libcupsimage.sl libcupsimage.dylib
+	$(RM) libcupsimage.so libcupsimage.${LIBcupsimage_VERSION} libcupsimage.sl libcupsimage.dylib
 	$(RM) -r 32bit 64bit
 
 
@@ -88,9 +88,9 @@ install:	all installhdrs $(INSTALLSTATIC) $(INSTALL32)
 	$(LN) rastertolabel $(SERVERBIN)/filter/rastertodymo
 	$(INSTALL_DIR) -m 755 $(LIBDIR)
 	$(INSTALL_LIB) $(LIBCUPSIMAGE) $(LIBDIR)
-	-if test $(LIBCUPSIMAGE) = "libcupsimage.so.2" -o $(LIBCUPSIMAGE) = "libcupsimage.sl.2"; then \
-		$(RM) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .2`; \
-		$(LN) $(LIBCUPSIMAGE) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .2`; \
+	-if test $(LIBCUPSIMAGE) = "libcupsimage.so.${LIBcupsimage_VERSION}" -o $(LIBCUPSIMAGE) = "libcupsimage.sl.2"; then \
+		$(RM) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .${LIBcupsimage_VERSION}`; \
+		$(LN) $(LIBCUPSIMAGE) $(LIBDIR)/`basename $(LIBCUPSIMAGE) .${LIBcupsimage_VERSION}`; \
 	fi
 	-if test $(LIBCUPSIMAGE) = "libcupsimage.2.dylib"; then \
 		$(STRIP) -x $(LIBDIR)/$(LIBCUPSIMAGE); \
@@ -116,13 +116,13 @@ installhdrs:
 
 install32bit:
 	$(INSTALL_DIR) -m 755 $(LIB32DIR)
-	$(INSTALL_LIB) 32bit/libcupsimage.so.2 $(LIB32DIR)/libcupsimage.so.2
-	$(LN) libcupsimage.so.2 $(LIB32DIR)/libcupsimage.so
+	$(INSTALL_LIB) 32bit/libcupsimage.so.${LIBcupsimage_VERSION} $(LIB32DIR)/libcupsimage.so.${LIBcupsimage_VERSION}
+	$(LN) libcupsimage.so.${LIBcupsimage_VERSION} $(LIB32DIR)/libcupsimage.so
 
 install64bit:
 	$(INSTALL_DIR) -m 755 $(LIB64DIR)
-	$(INSTALL_LIB) 64bit/libcupsimage.so.2 $(LIB64DIR)/libcupsimage.so.2
-	$(LN) libcupsimage.so.2 $(LIB64DIR)/libcupsimage.so
+	$(INSTALL_LIB) 64bit/libcupsimage.so.${LIBcupsimage_VERSION} $(LIB64DIR)/libcupsimage.so.${LIBcupsimage_VERSION}
+	$(LN) libcupsimage.so.${LIBcupsimage_VERSION} $(LIB64DIR)/libcupsimage.so
 
 
 #
@@ -143,7 +143,7 @@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
 	$(RM) $(LIBDIR)/libcupsimage.sl
 	$(RM) $(LIBDIR)/libcupsimage.sl.2
 	$(RM) $(LIBDIR)/libcupsimage.so
-	$(RM) $(LIBDIR)/libcupsimage.so.2
+	$(RM) $(LIBDIR)/libcupsimage.so.${LIBcupsimage_VERSION}
 	-$(RMDIR) $(LIBDIR)
 	$(RM) $(INCLUDEDIR)/cups/image.h
 	$(RM) $(INCLUDEDIR)/cups/raster.h
@@ -151,12 +151,12 @@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
 
 uninstall32bit:
 	$(RM) $(LIB32DIR)/libcupsimage.so
-	$(RM) $(LIB32DIR)/libcupsimage.so.2
+	$(RM) $(LIB32DIR)/libcupsimage.so.${LIBcupsimage_VERSION}
 	-$(RMDIR) $(LIB32DIR)
 
 uninstall64bit:
 	$(RM) $(LIB64DIR)/libcupsimage.so
-	$(RM) $(LIB64DIR)/libcupsimage.so.2
+	$(RM) $(LIB64DIR)/libcupsimage.so.${LIBcupsimage_VERSION}
 	-$(RMDIR) $(LIB64DIR)
 
 
@@ -199,22 +199,22 @@ hpgltops:	$(HPGLOBJS) common.o ../cups/$(LIBCUPS)
 
 
 #
-# libcupsimage.so.2, libcupsimage.sl.2
+# libcupsimage.so.${LIBcupsimage_VERSION}, libcupsimage.sl.2
 #
 
-libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS)
+libcupsimage.so.${LIBcupsimage_VERSION} libcupsimage.sl.2:	$(IMAGEOBJS)
 	echo Linking $@...
 	$(DSO) $(ARCHFLAGS) $(DSOFLAGS) -o $@ $(IMAGEOBJS) $(DSOLIBS) \
 		-L../cups $(LINKCUPS) -lm
-	$(RM) `basename $@ .2`
-	$(LN) $@ `basename $@ .2`
+	$(RM) `basename $@ .${LIBcupsimage_VERSION}`
+	$(LN) $@ `basename $@ .${LIBcupsimage_VERSION}`
 
 
 #
-# 32bit/libcupsimage.so.2
+# 32bit/libcupsimage.so.${LIBcupsimage_VERSION}
 #
 
-32bit/libcupsimage.so.2:	$(IMAGE32OBJS)
+32bit/libcupsimage.so.${LIBcupsimage_VERSION}:	$(IMAGE32OBJS)
 	echo Linking 32-bit $@...
 	-mkdir 32bit
 	$(DSO) $(ARCH32FLAGS) $(DSO32FLAGS) -o $@ $(IMAGE32OBJS) $(DSOLIBS) \
@@ -222,10 +222,10 @@ libcupsimage.so.2 libcupsimage.sl.2:	$(IMAGEOBJS)
 
 
 #
-# 64bit/libcupsimage.so.2
+# 64bit/libcupsimage.so.${LIBcupsimage_VERSION}
 #
 
-64bit/libcupsimage.so.2:	$(IMAGE64OBJS)
+64bit/libcupsimage.so.${LIBcupsimage_VERSION}:	$(IMAGE64OBJS)
 	echo Linking 64-bit $@...
 	-mkdir 64bit
 	$(DSO) $(ARCH64FLAGS) $(DSO64FLAGS) -o $@ $(IMAGE64OBJS) $(DSOLIBS) \

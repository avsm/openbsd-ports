--- ./sbr/m_scratch.c.orig	Sat Mar 20 15:33:22 1999
+++ ./sbr/m_scratch.c	Sat Mar 20 16:17:33 1999
@@ -13,9 +13,14 @@
 {
     char *cp;
     static char buffer[BUFSIZ], tmpfil[BUFSIZ];
+    int fd;
 
     snprintf (tmpfil, sizeof(tmpfil), "%sXXXXXX", template);
-    mktemp (tmpfil);
+    fd = mkstemp (tmpfil);
+    if (fd == -1)
+	return 0;
+    close (fd);
+    unlink (tmpfil);
     if ((cp = r1bindex (file, '/')) == file)
 	strncpy (buffer, tmpfil, sizeof(buffer));
     else

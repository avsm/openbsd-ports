$OpenBSD: patch-src_demuxers_demux_asf_c,v 1.2 2008/01/15 00:36:46 jakemsr Exp $
--- src/demuxers/demux_asf.c.orig	Tue Jan  1 08:30:08 2008
+++ src/demuxers/demux_asf.c	Sat Jan 12 21:11:35 2008
@@ -425,7 +425,7 @@ static int asf_read_header (demux_asf_t *this) {
 	xine_log(this->stream->xine, XINE_LOG_MSG,
 		 _("demux_asf: warning: The stream id=%d is encrypted.\n"), asf_stream->stream_number);
 	_x_message(this->stream, XINE_MSG_ENCRYPTED_SOURCE,
-		   _("Media stream scrambled/encrypted"), NULL);
+		   _("Media stream scrambled/encrypted"), (char *)NULL);
 	this->mode = ASF_MODE_ENCRYPTED_CONTENT;
       }
     }
@@ -723,6 +723,9 @@ static void asf_send_buffer_nodefrag (demux_asf_t *thi
     buf->size       = bufsize;
     timestamp       = 0;
 
+    if (stream->frag_offset == 0)
+      buf->decoder_flags |= BUF_FLAG_FRAME_START;
+
     stream->frag_offset += bufsize;
     frag_len -= bufsize;
 
@@ -733,10 +736,6 @@ static void asf_send_buffer_nodefrag (demux_asf_t *thi
     else
       check_newpts (this, buf->pts, PTS_AUDIO, package_done);
 
-      
-    if (frag_offset == 0)
-      buf->decoder_flags |= BUF_FLAG_FRAME_START;
-      
     /* test if whole packet read */
     if (package_done) {
       buf->decoder_flags |= BUF_FLAG_FRAME_END;

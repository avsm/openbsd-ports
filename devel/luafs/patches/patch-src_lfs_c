$OpenBSD: patch-src_lfs_c,v 1.2 2006/03/26 04:56:02 pedro Exp $
--- src/lfs.c.orig	Tue Mar 14 13:18:30 2006
+++ src/lfs.c	Sun Mar 26 00:15:08 2006
@@ -32,14 +32,13 @@
 #include <unistd.h>
 #include <dirent.h>
 #include <fcntl.h>
-#include <sys/types.h>
+#include <sys/param.h>
 #include <utime.h>
 #endif
 
 #include "lua.h"
 #include "lauxlib.h"
 #include "lualib.h"
-#include "compat-5.1.h"
 
 #include "lfs.h"
 
@@ -91,8 +90,8 @@ static int change_dir (lua_State *L) {
 **  and a string describing the error
 */
 static int get_dir (lua_State *L) {
-	char path[255+2];
-	if (getcwd(path, 255) == NULL) {
+	char path[MAXPATHLEN];
+	if (getcwd(path, sizeof(path)) == NULL) {
 		lua_pushnil(L);
 		lua_pushstring(L, getcwd_error);
 		return 2;
@@ -580,7 +579,7 @@ static const struct luaL_reg fslib[] = {
 	{NULL, NULL},
 };
 
-int luaopen_lfs (lua_State *L) {
+int luaopen_fs_core (lua_State *L) {
 	dir_create_meta (L);
 	luaL_openlib (L, "lfs", fslib, 0);
 	set_info (L);

$OpenBSD: patch-libavcodec_Makefile,v 1.6 2007/11/12 07:08:24 ajacoutot Exp $
--- libavcodec/Makefile.orig	Sun Nov 11 11:15:01 2007
+++ libavcodec/Makefile	Sun Nov 11 11:18:26 2007
@@ -5,7 +5,8 @@
 include ../config.mak
 
 # NOTE: -I.. is needed to include config.h
-CFLAGS=$(OPTFLAGS) -DHAVE_AV_CONFIG_H -I.. -I$(SRC_PATH)/libavutil -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_GNU_SOURCE $(AMR_CFLAGS)
+# XXX add "-O -fomit-frame-pointer" to prevent random crashes from mencoder
+CFLAGS=$(OPTFLAGS) -O -fomit-frame-pointer -DHAVE_AV_CONFIG_H -I.. -I$(SRC_PATH)/libavutil -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_GNU_SOURCE $(AMR_CFLAGS)
 
 OBJS= bitstream.o utils.o mem.o allcodecs.o \
       mpegvideo.o jrevdct.o jfdctfst.o jfdctint.o\

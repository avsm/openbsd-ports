--- lib/Makefile.in.orig	Thu Jan 27 14:36:20 2000
+++ lib/Makefile.in	Tue Mar 28 00:59:58 2000
@@ -69,7 +69,7 @@
 CFLAGS = ${TK_DEFS} ${EXTRA_CFLAGS} -I${C_CLIENT} ${FIX_INCLUDE} ${INCLUDES} \
 	 ${SHLIB_CFLAGS} -DVERSION=\"${VERSION}\"
 C_CLIENT_LIB = ${C_CLIENT}/c-client.a
-RATLIB = ratatosk${RATLIB_SUFFIX}
+RATLIB = ratatosk${SHLIB_SUFFIX}.${VERSION}
 DUMMYLIB = ratDummy${SHLIB_SUFFIX}
 
 SRC = ratAppInit.c ratFolder.c ratStdFolder.c ratMessage.c ratCode.c \
@@ -79,7 +79,7 @@
       ratDisFolder.c ratPrint.c
 OBJ = ${SRC:.c=.o}
 
-all: ${RATLIB} pkgIndex.tcl
+all: ${RATLIB} 
 
 clean:
 	rm -f ${OBJ} ${RATLIB} ratDummy.o ${DUMMYLIB} core pkgIndex.tcl
@@ -90,22 +90,18 @@
 ${DUMMYLIB}: ratDummy.o
 	${SHLIB_LD} -o ${DUMMYLIB} ratDummy.o $(EXTRA_LIBS) ${SHLIB_LD_LIBS}
 
-pkgIndex.tcl: ${RATLIB} ${DUMMYLIB}
-	echo "if [catch {load ./${DUMMYLIB}; \
-			 load ./${RATLIB}; \
-			 pkg_mkIndex -verbose . ${RATLIB}} error] \
-		  {puts \$$error; exit 1}" | ${TCLSH}
-
 install: ${RATLIB}
 	if test ! -d ${INSTALL_PREFIX}${LIB_DIR} ; then\
 	    ${INSTALL} -d ${INSTALL_PREFIX}${LIB_DIR} ;\
 	fi
 	${INSTALL} ${RATLIB} ${INSTALL_PREFIX}${LIB_DIR}/${RATLIB}
-	${INSTALL} ${DUMMYLIB} ${INSTALL_PREFIX}${LIB_DIR}/${DUMMYLIB}
+	if test -f ${DUMMYLIB} ; then\
+	${INSTALL} ${DUMMYLIB} ${INSTALL_PREFIX}${LIB_DIR}/${DUMMYLIB}\
 	cd ${INSTALL_PREFIX}${LIB_DIR}; \
-	    echo "load ./${DUMMYLIB}; pkg_mkIndex . ratatosk*${SHLIB_SUFFIX}" |\
-	    ${TCLSH}
-	rm -f ${INSTALL_PREFIX}${LIB_DIR}/${DUMMYLIB}
+	    echo "load ./${DUMMYLIB}; pkg_mkIndex . ratatosk${RATLIB_SUFFIX}" |\
+	    ${TCLSH} \
+	rm -f ${INSTALL_PREFIX}${LIB_DIR}/${DUMMYLIB} ;\
+	fi
 
 ratAddress.o: ratAddress.c rat.h ../config.h
 ratAppInit.o: Makefile ratAppInit.c ratFolder.h rat.h ../config.h ratPGP.h

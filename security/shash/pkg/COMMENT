generates or checks digests or mac

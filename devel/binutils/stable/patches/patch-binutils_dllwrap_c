$OpenBSD: patch-binutils_dllwrap_c,v 1.1 2002/05/08 11:02:40 fgsch Exp $
--- binutils/dllwrap.c.orig	Wed May  8 04:03:55 2002
+++ binutils/dllwrap.c	Wed May  8 04:06:02 2002
@@ -392,7 +392,11 @@ run (what, args)
   int i;
   const char **argv;
   char *errmsg_fmt, *errmsg_arg;
-  char *temp_base = choose_temp_base ();
+#if defined(__MSDOS__) && !defined(__GO32__)
+  char *temp_base = choose_temp_base ();
+#else
+  char *temp_base = NULL;
+#endif
   int in_quote;
   char sep;
 
@@ -834,12 +838,9 @@ main (argc, argv)
 
   if (! def_file_seen)
     {
-      char *fileprefix = choose_temp_base ();
-      def_file_name = (char *) xmalloc (strlen (fileprefix) + 5);
-      sprintf (def_file_name, "%s.def", 
-               (dontdeltemps) ? mybasename (fileprefix) : fileprefix);
-      delete_def_file = 1;
-      free (fileprefix);
+      def_file_name = make_temp_file (".def");
+      if (dontdeltemps)
+        def_file_name = mybasename (def_file_name);
       delete_def_file = 1;
       warn (_("no export definition file provided"));
       warn (_("creating one, but that may not be what you want"));
@@ -1022,12 +1023,10 @@ main (argc, argv)
   
   if (! base_file_name)
     {
-      char *fileprefix = choose_temp_base ();
-      base_file_name = (char *) xmalloc (strlen (fileprefix) + 6);
-      sprintf (base_file_name, "%s.base", 
-               (dontdeltemps) ? mybasename (fileprefix) : fileprefix);
+      base_file_name = make_temp_file (".base");
+      if (dontdeltemps)
+        base_file_name = mybasename (base_file_name);
       delete_base_file = 1;
-      free (fileprefix);
     }
   
   {

$OpenBSD: patch-src_client_side_c,v 1.5 2006/04/13 23:46:56 brad Exp $
--- src/client_side.c.orig	Fri Mar 10 17:58:35 2006
+++ src/client_side.c	Thu Apr 13 19:21:21 2006
@@ -2832,7 +2832,7 @@ parseHttpRequest(ConnStateData * conn, m
 #elif PF_TRANSPARENT
 	    static time_t last_reported = 0;
 	    if (pffd < 0)
-		pffd = open("/dev/pf", O_RDWR);
+		pffd = open("/dev/pf", O_RDONLY);
 	    if (pffd < 0) {
 		if (squid_curtime - last_reported > 60) {
 		    debug(50, 1) ("parseHttpRequest: PF open failed: %s\n", xstrerror());

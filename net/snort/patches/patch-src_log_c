$OpenBSD: patch-src_log_c,v 1.2 2009/02/12 22:12:08 rui Exp $
--- src/log.c.orig	Mon Jun 16 20:33:54 2008
+++ src/log.c	Fri Sep  5 22:54:34 2008
@@ -358,7 +358,7 @@ void PrintIPPkt(FILE * fp, int type, Packet * p)
     DEBUG_WRAP(DebugMessage(DEBUG_LOG, "PrintIPPkt type = %d\n", type););
 
     bzero((char *) timestamp, TIMEBUF_SIZE);
-    ts_print((struct timeval *) & p->pkth->ts, timestamp);
+    ts_print((struct timeval32 *) & p->pkth->ts, timestamp);
 
     /* dump the timestamp */
     fwrite(timestamp, strlen(timestamp), 1, fp);
@@ -851,7 +851,7 @@ void PrintArpHeader(FILE * fp, Packet * p)
 
     bzero((struct in_addr *) &ip_addr, sizeof(struct in_addr));
     bzero((char *) timestamp, TIMEBUF_SIZE);
-    ts_print((struct timeval *) & p->pkth->ts, timestamp);
+    ts_print((struct timeval32 *) & p->pkth->ts, timestamp);
 
     /* determine what to use as MAC src and dst */
     if (p->eh != NULL) 
@@ -1929,7 +1929,7 @@ void PrintEapolPkt(FILE * fp, Packet * p)
   
 
     bzero((char *) timestamp, TIMEBUF_SIZE);
-    ts_print((struct timeval *) & p->pkth->ts, timestamp);
+    ts_print((struct timeval32 *) & p->pkth->ts, timestamp);
 
     /* dump the timestamp */
     fwrite(timestamp, strlen(timestamp), 1, fp);
@@ -2103,7 +2103,7 @@ void PrintWifiPkt(FILE * fp, Packet * p)
 
 
     bzero((char *) timestamp, TIMEBUF_SIZE);
-    ts_print((struct timeval *) & p->pkth->ts, timestamp);
+    ts_print((struct timeval32 *) & p->pkth->ts, timestamp);
 
     /* dump the timestamp */
     fwrite(timestamp, strlen(timestamp), 1, fp);

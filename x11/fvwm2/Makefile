# $OpenBSD: Makefile,v 1.43 2007/09/15 20:04:20 merdely Exp $

COMMENT-main=	multiple virtual desktop window manager, with icons
COMMENT-fvicons=multiple virtual desktop window manager icons
COMMENT-fvwm2=	multiple virtual desktop window manager, without icons

VERSION=	2.4.19
DISTNAME=	fvwm-${VERSION}
PKGNAME-main=	fvwm2+fvicons-${VERSION}p0
FULLPKGNAME-fvicons=fvicons-${VERSION}p0
PKGNAME-fvwm2=	fvwm2-${VERSION}
CATEGORIES=     x11

DISTFILES=	${DISTNAME}${EXTRACT_SUFX} fvwm_icons.tgz:0

HOMEPAGE=	http://www.fvwm.org/

MAINTAINER=	Peter Valchev <pvalchev@openbsd.org>

# GPL/BSD-like (badly worded)
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes 
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes 
WANTLIB=		ICE SM X11 Xext Xi Xinerama Xpm c gdk glib gmodule \
			iconv intl jpeg m png readline termcap tiff ungif z

MASTER_SITES=	ftp://ftp.fvwm.org/pub/fvwm/version-2/
MASTER_SITES0=	http://www.fvwm.org/generated/icon_download/

LIB_DEPENDS=	gtk.>=1.2:gtk+-*:x11/gtk+ \
		gdk_imlib.>=19.:imlib-*:graphics/imlib

MULTI_PACKAGES=	-main -fvwm2 -fvicons

FLAVORS=	rplay debug i18n
FLAVOR?=

.if ${FLAVOR:L:Mrplay}
LIB_DEPENDS+=	rplay::audio/rplay
CONFIGURE_ARGS+= --with-rplay-includes="${LOCALBASE}/include" \
		 --with-rplay-library="${LOCALBASE}/lib"
.else
CONFIGURE_ARGS+= --without-rplay
.endif

.if ${FLAVOR:L:Mdebug}
CONFIGURE_ARGS+= --enable-debug-msgs
.endif

.if ${FLAVOR:L:Mi18n}
# the multibyte character support is experimental
CONFIGURE_ARGS+= --enable-multibyte
.else
CONFIGURE_ARGS+= --disable-multibyte
.endif

PKG_ARCH-fvicons=	*
LIB_DEPENDS-fvicons=
WANTLIB-fvicons=
FULLPKGPATH-fvicons=	${PKGPATH},-fvicons

SUBST_VARS=	VERSION

USE_X11=	Yes

SEPARATE_BUILD= concurrent
CONFIGURE_STYLE= gnu
CONFIGURE_ARGS+= --enable-extras \
		 --without-gnome

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/pixmaps/fvwm
	${INSTALL_DATA} ${WRKDIR}/fvwm_icons/*.xpm ${PREFIX}/share/pixmaps/fvwm/
	${INSTALL_DATA} ${WRKSRC}/sample.fvwmrc/system.fvwm2rc ${PREFIX}/share/fvwm
	
.include <bsd.port.mk>

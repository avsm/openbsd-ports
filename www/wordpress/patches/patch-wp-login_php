$OpenBSD: patch-wp-login_php,v 1.1 2009/08/11 23:43:17 martynas Exp $
--- wp-login.php.orig	Thu Jun  4 01:15:22 2009
+++ wp-login.php	Tue Aug 11 14:20:43 2009
@@ -187,7 +187,7 @@ function reset_password($key) {
 
 	$key = preg_replace('/[^a-z0-9]/i', '', $key);
 
-	if ( empty( $key ) )
+	if ( empty( $key ) || is_array( $key ) )
 		return new WP_Error('invalid_key', __('Invalid key'));
 
 	$user = $wpdb->get_row($wpdb->prepare("SELECT * FROM $wpdb->users WHERE user_activation_key = %s", $key));

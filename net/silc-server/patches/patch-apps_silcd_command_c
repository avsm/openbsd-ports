$OpenBSD: patch-apps_silcd_command_c,v 1.1 2005/09/09 17:03:35 brad Exp $
--- apps/silcd/command.c.orig	Tue May 10 12:59:01 2005
+++ apps/silcd/command.c	Mon Sep  5 19:39:15 2005
@@ -2964,6 +2964,10 @@ SILC_SERVER_CMD_FUNC(cmode)
 	 new channel key. Clients are not using private channel keys
 	 anymore after this. */
 
+      /* if we don't remove the flag from the mode
+       * silc_server_create_channel_key won't create a new key */
+      channel->mode &= ~SILC_CHANNEL_MODE_PRIVKEY;
+
       /* Re-generate channel key */
       if (!silc_server_create_channel_key(server, channel, 0))
 	goto out;

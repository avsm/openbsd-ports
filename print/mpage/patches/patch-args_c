$OpenBSD: patch-args_c,v 1.4 2010/05/19 14:55:00 espie Exp $
--- args.c.orig	Wed Oct 16 23:22:48 2002
+++ args.c	Wed May 19 14:52:00 2010
@@ -35,6 +35,7 @@ do_args(int argc, char **argv, int envflag)
     int consumed;
     int currarg;
     int opterrors;
+    size_t len;
 
     int i;
 
@@ -142,18 +143,17 @@ do_args(int argc, char **argv, int envflag)
                         break;
                 case 'C':    /* select character definitions */
                         consumed = 1;
+                        len = (strlen(libdir) + strlen(optstr) + 2);
                         if (*++optstr) { /* did we get a encoding name ? */
-                            if ((charvec_file = (char *) malloc(strlen(libdir) +
-                                                                strlen(optstr) +
-                                                                2)) == NULL) {
+                            if ((charvec_file = (char *) malloc(len)) == NULL) {
                                 perror(optstr);
                                 fprintf(stderr,
                                     "ignoring character encoding definition\n");
                             }
                             else {
-                                (void) strcpy(charvec_file, libdir);
-                                (void) strcat(charvec_file, "/");
-                                (void) strcat(charvec_file, optstr);
+                                (void) strlcpy(charvec_file, libdir, len);
+                                (void) strlcat(charvec_file, "/", len);
+                                (void) strlcat(charvec_file, optstr, len);
                                 opt_encoding = 1;
                             }
                         }

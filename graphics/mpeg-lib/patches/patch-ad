--- configure.orig	Sun Aug  8 20:36:05 1999
+++ configure	Sun Jan  2 00:37:29 2000
@@ -1101,6 +1101,7 @@
 if test $dither = yes; then
   libsrc='$(DECODER_SRC) $(DITHER_SRC)'
   libobj='$(DECODER_SRC:.c=.o) $(DITHER_SRC:.c=.o)'
+  shlibobj='$(DECODER_SRC:.c=.so) $(DITHER_SRC:.c=.so)'
   cat >> confdefs.h <<\EOF
 #define ENABLE_DITHER 1
 EOF
@@ -1109,6 +1110,7 @@
 else
   libsrc='$(DECODER_SRC)'
   libobj='$(DECODER_SRC:.c=.o)'
+  shlibobj='$(DECODER_SRC:.c=.so)'
   cat >> confdefs.h <<\EOF
 #define ENABLE_DITHER 0
 EOF
@@ -1285,7 +1287,7 @@
 
 fi
 
-for ac_hdr in sys/time.h unistd.h netinet/in.h
+for ac_hdr in sys/time.h unistd.h netinet/in.h malloc.h
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
@@ -1818,6 +1820,7 @@
 s%@AR@%$AR%g
 s%@libsrc@%$libsrc%g
 s%@libobj@%$libobj%g
+s%@shlibobj@%$shlibobj%g
 s%@CPP@%$CPP%g
 
 CEOF

$OpenBSD: patch-src_backends_alc_backend_bsd_c,v 1.1 2006/10/30 23:31:37 steven Exp $
--- src/backends/alc_backend_bsd.c.orig	Thu Jan  5 16:11:20 2006
+++ src/backends/alc_backend_bsd.c	Thu Oct 26 21:51:24 2006
@@ -10,14 +10,16 @@
 #include "al_siteconfig.h"
 
 #include <AL/al.h>
+#include <AL/alext.h>
 #include <assert.h>
 #include <fcntl.h>
-#include <sys/soundcard.h>
+#include <soundcard.h>
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
 #include <sys/ioctl.h>
 #include <sys/mman.h>
+#include <sys/select.h>
 #include <sys/stat.h>
 #include <sys/time.h>
 #include <sys/types.h>
@@ -112,7 +114,7 @@ static int AL2BSDFMT(int fmt)
  *
  */
 static void *grab_write_native(void) {
-	const char *dsppath = "/dev/dsp";
+	const char *dsppath = "/dev/audio";
 	int divisor = _alSpot(_AL_DEF_BUFSIZ) | (2<<16);
 
 	dsp_fd = open(dsppath, O_WRONLY | O_NONBLOCK);
@@ -146,9 +148,11 @@ int grab_mixerfd(void) {
 	mixer_fd = open("/dev/mixer", O_WRONLY | O_NONBLOCK);
 
 	if(mixer_fd > 0) {
+#if 0
 		if(fcntl(mixer_fd, F_SETFL, ~O_NONBLOCK) == -1) {
 			perror("fcntl");
 		}
+#endif
 
 		return mixer_fd;
 	} else {
@@ -210,7 +214,7 @@ void release_native(void *handle) {
 
 	handle_fd = *(int *) handle;
 
-	if(ioctl(handle_fd, SNDCTL_DSP_RESET) < 0) {
+	if(ioctl(handle_fd, SNDCTL_DSP_RESET, NULL) < 0) {
 #ifdef DEBUG_MAXIMUS
 		fprintf(stderr, "Couldn't reset dsp\n");
 #endif

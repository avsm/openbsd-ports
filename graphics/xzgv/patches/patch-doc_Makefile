$OpenBSD: patch-doc_Makefile,v 1.1.1.1 2005/05/22 11:32:11 alek Exp $
--- doc/Makefile.orig	Thu Dec 21 04:45:20 2000
+++ doc/Makefile	Thu May 12 15:56:37 2005
@@ -10,7 +10,7 @@ include ../config.mk
 
 all: info man
 
-info: xzgv.gz
+info: xzgv.info
 dvi: xzgv.dvi
 
 xzgv.gz: xzgv.texi
@@ -23,6 +23,9 @@ xzgv.dvi: xzgv.texi
 	@echo "=== NB: If you don't want A4 paper, edit config.mk! ==="
 	texi2dvi -c $(USE_A4_DEF) xzgv.texi
 
+xzgv.info: xzgv.texi
+	makeinfo --no-split xzgv.texi -o xzgv.info
+
 # This explicitly mentions `gawk' because makeman requires it
 # (and can't easily be made not to, since it really does need gensub).
 # To avoid problems on gawkless systems, a prebuilt xzgv.1 is included
@@ -36,25 +39,10 @@ xzgv.1: xzgv.texi makeman.awk
 installdirs:
 	/bin/sh ../mkinstalldirs $(INFODIR) $(MANDIR)
 
-install: ../src/install-info installdirs
-	install xzgv.1 $(MANDIR)
-	install xzgv.gz xzgv-?.gz $(INFODIR)
-	chmod 644 $(MANDIR)/xzgv.1 $(INFODIR)/xzgv*
-# Update info `dir' file.
-# Info always uses a dir file in preference to a dir.gz, so we don't use
-# dir.gz unless it's the only game in town.
-	if [ "$(INFO_DIR_UPDATE)" != no ]; then \
-	  gzip -d xzgv.gz; \
-	  if [ -f $(INFODIR)/dir.gz -a ! -f $(INFODIR)/dir ]; then \
-	    gzip -d $(INFODIR)/dir.gz; \
-	    ../src/install-info xzgv $(INFODIR)/dir; \
-	    gzip $(INFODIR)/dir; \
-	  else \
-	    ../src/install-info xzgv $(INFODIR)/dir; \
-	  fi; \
-	  chmod a+r $(INFODIR)/dir; \
-	  gzip xzgv; \
-	fi
+install:
+	${BSD_INSTALL_MAN} xzgv.1 ${MANDIR}
+	${BSD_INSTALL_DATA} xzgv.info ${INFODIR}
+	install-info ${INFODIR}/xzgv.info ${INFODIR}/dir
 
 ../src/install-info: ../src/install-info.c
 	cd ../src && $(MAKE) install-info

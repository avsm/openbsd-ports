$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.2 2006/10/08 21:43:50 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Fri Sep 29 16:44:58 2006
+++ src/corelib/io/qfsfileengine_unix.cpp	Sat Oct  7 13:10:23 2006
@@ -575,13 +575,13 @@ uint QFSFileEngine::ownerId(FileOwner ow
 
 QString QFSFileEngine::owner(FileOwner own) const
 {
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
     QVarLengthArray<char, 1024> buf(sysconf(_SC_GETPW_R_SIZE_MAX));
 #endif
 
     if(own == OwnerUser) {
         struct passwd *pw = 0;
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
         struct passwd entry;
         getpwuid_r(ownerId(own), &entry, buf.data(), buf.size(), &pw);
 #else
@@ -591,7 +591,7 @@ QString QFSFileEngine::owner(FileOwner o
             return QFile::decodeName(QByteArray(pw->pw_name));
     } else if(own == OwnerGroup) {
         struct group *gr = 0;
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
         buf.resize(sysconf(_SC_GETGR_R_SIZE_MAX));
         struct group entry;
         getgrgid_r(ownerId(own), &entry, buf.data(), buf.size(), &gr);

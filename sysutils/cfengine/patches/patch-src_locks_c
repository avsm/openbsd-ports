$OpenBSD: patch-src_locks_c,v 1.4 2005/10/27 21:47:28 sturm Exp $
--- src/locks.c.orig	Fri Jul 15 11:17:23 2005
+++ src/locks.c	Fri Oct 21 16:35:56 2005
@@ -74,7 +74,7 @@ DB *DBP;
 void PreLockState()
 
 {
- strcpy(CFLOCK,"pre-lock-state");
+ (void)strlcpy(CFLOCK,"pre-lock-state",CF_BUFSIZE);
 }
 
 /********************************************************************/
@@ -82,7 +82,7 @@ void PreLockState()
 void SaveExecLock()
 
 {
-strcpy(SAVELOCK,CFLOCK);
+(void)strlcpy(SAVELOCK,CFLOCK,CF_BUFSIZE);
 }
 
 
@@ -91,7 +91,7 @@ strcpy(SAVELOCK,CFLOCK);
 void RestoreExecLock()
 
 {
-strcpy(CFLOCK,SAVELOCK);
+(void)strlcpy(CFLOCK,SAVELOCK,CF_BUFSIZE);
 }
 
 /********************************************************************/
@@ -364,7 +364,7 @@ if (PutLock(CFLAST) == -1)
 
  
 LockLog(getpid(),"Lock removed normally ",CFLOCK,"");
-strcpy(CFLOCK,"no_active_lock");
+(void)strlcpy(CFLOCK,"no_active_lock",CF_BUFSIZE);
 }
 
 
@@ -721,7 +721,7 @@ if ((tim = time((time_t *)NULL)) == -1)
    Debug("Cfengine: couldn't read system clock\n");
    }
 
-sprintf(buffer,"%s",ctime(&tim));
+(void)snprintf(buffer,sizeof(buffer),"%s",ctime(&tim));
 
 Chop(buffer);
 

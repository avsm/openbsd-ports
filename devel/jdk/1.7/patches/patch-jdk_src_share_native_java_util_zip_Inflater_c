$OpenBSD: patch-jdk_src_share_native_java_util_zip_Inflater_c,v 1.2 2009/10/07 01:53:54 kurt Exp $
--- jdk/src/share/native/java/util/zip/Inflater.c.orig	Thu Sep 17 03:52:26 2009
+++ jdk/src/share/native/java/util/zip/Inflater.c	Sat Sep 26 10:00:48 2009
@@ -67,6 +67,10 @@ Java_java_util_zip_Inflater_init(JNIEnv *env, jclass c
         return jlong_zero;
     } else {
         char *msg;
+// BSDXXX needed for FreeBSD 5.4 and below with system zlib
+#if defined(__FreeBSD__) && __FreeBSD__ < 6
+	strm->adler = 1;
+#endif
         switch (inflateInit2(strm, nowrap ? -MAX_WBITS : MAX_WBITS)) {
           case Z_OK:
             return ptr_to_jlong(strm);
@@ -204,6 +208,10 @@ Java_java_util_zip_Inflater_reset(JNIEnv *env, jclass 
     if (inflateReset(jlong_to_ptr(strm)) != Z_OK) {
         JNU_ThrowInternalError(env, 0);
     }
+// BSDXXX needed for FreeBSD 5.4 and below with system zlib
+#if defined(__FreeBSD__) && __FreeBSD__ < 6
+    ((z_stream *)jlong_to_ptr(strm))->adler = 1;
+#endif
 }
 
 JNIEXPORT void JNICALL

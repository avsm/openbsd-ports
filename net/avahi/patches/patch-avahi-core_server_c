$OpenBSD: patch-avahi-core_server_c,v 1.3 2010/07/17 14:12:38 ajacoutot Exp $
--- avahi-core/server.c.orig	Tue Jun 29 02:12:38 2010
+++ avahi-core/server.c	Mon Jul  5 12:02:37 2010
@@ -903,6 +903,11 @@ static void dispatch_packet(AvahiServer *s, AvahiDnsPa
         return;
     }
 
+    if (port <= 0) {
+        avahi_log_warn("Received packet from invalid source port.");
+        return;
+    }
+
     if (avahi_address_is_ipv4_in_ipv6(src_address))
         /* This is an IPv4 address encapsulated in IPv6, so let's ignore it. */
         return;

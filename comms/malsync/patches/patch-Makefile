$OpenBSD: patch-Makefile,v 1.4 2006/10/20 11:51:58 ajacoutot Exp $
--- Makefile.orig	Tue Sep 19 16:46:31 2006
+++ Makefile	Tue Sep 19 16:48:06 2006
@@ -1,5 +1,7 @@
 TARGET = malsync
 
+all: ${TARGET}
+
 PLAT := $(shell uname)
 	
 ifeq ($(PLAT),SunOS)
@@ -15,9 +17,9 @@ LINKLIBS = -lm
 endif
 
 TREETOP = .
-PILOT_LINK_DIR = $(TREETOP)/pilot-link-0.11.7
+PILOT_LINK_DIR = $(PREFIX)
 
-CFLAGS = -Wall -g -DMALSYNC -I$(TREETOP)/mal/common \
+CFLAGS += -DMALSYNC -I$(TREETOP)/mal/common \
   -I$(TREETOP)/mal/client/common -I$(PILOT_LINK_DIR)/include \
   -I$(TREETOP)/mal/client/unix
 
@@ -72,8 +74,8 @@ DYNLINK = -rdynamic
 endif
 
 $(TARGET): $(OBJS)
-	$(CC) $(DYNLINK) $(CFLAGS) -o $@ $(OBJS) \
-          ${PILOT_LINK_DIR}/libpisock/.libs/libpisock.a $(LINKLIBS)
+	$(CC) $(DYNLINK) $(CFLAGS) $(LDFLAGS) -o $@ $(OBJS) \
+          -L${PILOT_LINK_DIR}/lib -lpisock $(LINKLIBS)
 clean:
 	rm -f $(OBJS) $(TARGET)
 

$OpenBSD: patch-system-config-printer_py,v 1.10 2009/09/01 08:13:32 ajacoutot Exp $
--- system-config-printer.py.orig	Fri Mar 13 18:08:53 2009
+++ system-config-printer.py	Tue Sep  1 10:09:24 2009
@@ -101,10 +101,6 @@ busy_cursor = gtk.gdk.Cursor(gtk.gdk.WATCH)
 ready_cursor = gtk.gdk.Cursor(gtk.gdk.LEFT_PTR)
 ellipsis = unichr(0x2026)
 
-TEXT_start_firewall_tool = _("To do this, select "
-                             "System->Administration->Firewall "
-                             "from the main menu.")
-
 try:
     try_CUPS_SERVER_REMOTE_ANY = cups.CUPS_SERVER_REMOTE_ANY
 except AttributeError:
@@ -2518,25 +2514,6 @@ class GUI(GtkGUI, monitor.Watcher):
         self.changed = set()
         self.setDataButtonState()
 
-        old_setting = self.server_settings.get (cups.CUPS_SERVER_SHARE_PRINTERS,
-                                                '0')
-        new_setting = setting_dict.get (cups.CUPS_SERVER_SHARE_PRINTERS, '0')
-        if (old_setting == '0' and new_setting != '0'):
-            # We have just enabled print queue sharing.
-            # Ideally, this is the time we would check the firewall
-            # settings on this machine and request that the IPP TCP port
-            # be unblocked.  Unfortunately, this is not yet possible
-            # (bug #440469).  However, we can display a dialog to suggest
-            # that now might be a good time to review the firewall settings.
-            show_info_dialog (_("Review Firewall"),
-                              _("You may need to adjust the firewall "
-                                "to allow network printing to this "
-                                "computer.") + '\n\n' +
-                              TEXT_start_firewall_tool,
-                              parent=self.ServerSettingsDialog)
-
-        time.sleep(1) # give the server a chance to process our request
-
         # Now reconnect, in case the server needed to reload.
         self.reconnect ()
 
@@ -3705,7 +3682,7 @@ class NewPrinterGUI(GtkGUI):
         # Try to get make and model via SNMP
         if host:
             os.environ["HOST"] = host
-            cmd = '/usr/lib/cups/backend/snmp "${HOST}"'
+            cmd = '${LOCALBASE}/libexec/cups/backend/snmp "${HOST}"'
             debugprint (host + ": " + cmd)
             stdout = None
             try:
@@ -5208,7 +5185,7 @@ class NewPrinterGUI(GtkGUI):
                 try:
                     # We want this to be in the current natural language,
                     # so we intentionally don't set LC_ALL=C here.
-                    p = subprocess.Popen (['/usr/bin/cupstestppd',
+                    p = subprocess.Popen (['${LOCALBASE}/bin/cupstestppd',
                                            '-rvv', filename],
                                           stdin=file("/dev/null"),
                                           stdout=subprocess.PIPE,

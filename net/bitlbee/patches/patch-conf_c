$OpenBSD: patch-conf_c,v 1.4 2007/11/19 11:44:33 martynas Exp $
--- conf.c.orig	Mon Aug 20 16:27:13 2007
+++ conf.c	Mon Nov 19 13:39:01 2007
@@ -129,9 +129,10 @@ conf_t *conf_load( int argc, char *argv[] )
 	
 	if( conf->configdir[strlen(conf->configdir)-1] != '/' )
 	{
-		char *s = g_new( char, strlen( conf->configdir ) + 2 );
+		size_t s_len = strlen( conf->configdir ) + 2;
+		char *s = g_new( char, s_len);
 		
-		sprintf( s, "%s/", conf->configdir );
+		g_snprintf( s, s_len, "%s/", conf->configdir );
 		g_free( conf->configdir );
 		conf->configdir = s;
 	}
@@ -226,9 +227,9 @@ static int conf_loadini( conf_t *conf, char *file )
 					return( 0 );
 				}
 				
-				strncpy( proxyhost, url->host, sizeof( proxyhost ) );
-				strncpy( proxyuser, url->user, sizeof( proxyuser ) );
-				strncpy( proxypass, url->pass, sizeof( proxypass ) );
+				strlcpy( proxyhost, url->host, sizeof( proxyhost ) );
+				strlcpy( proxyuser, url->user, sizeof( proxyuser ) );
+				strlcpy( proxypass, url->pass, sizeof( proxypass ) );
 				proxyport = url->port;
 				if( url->proto == PROTO_HTTP )
 					proxytype = PROXY_HTTP;

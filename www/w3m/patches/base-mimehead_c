$OpenBSD: base-mimehead_c,v 1.1 2001/07/31 15:27:08 naddy Exp $
--- mimehead.c.orig	Fri Jun 22 02:51:21 2001
+++ mimehead.c	Fri Jun 22 02:51:45 2001
@@ -174,7 +174,7 @@ decodeWord(char **ow)
     if (*w != '=' || *(w + 1) != '?')
 	goto convert_fail;
     w += 2;
-    for (p = charset; *w != '?'; w++) {
+    for (p = charset; p - charset < 31 && *w != '?'; w++) {
 	if (*w == '\0')
 	    goto convert_fail;
 	*(p++) = *w;

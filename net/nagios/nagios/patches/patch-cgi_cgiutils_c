$OpenBSD: patch-cgi_cgiutils_c,v 1.4 2008/10/26 15:03:11 sthen Exp $
--- cgi/cgiutils.c.orig	Wed Oct 15 22:40:07 2008
+++ cgi/cgiutils.c	Wed Oct 22 20:03:01 2008
@@ -1289,7 +1289,7 @@ char *mmap_fgets_multiline(mmapfile *temp_mmapfile){
 			}
 
 		/* one backslash found, so we should continue reading the next line */
-		else if(buf[end]=='\\')
+		else if(end>=0 && buf[end]=='\\')
 			buf[end]='\x0';
 
 		/* else no continuation marker was found, so break */

--- configure.orig	Tue Dec 14 23:00:19 1999
+++ configure	Sat Jan 29 20:27:53 2000
@@ -1787,16 +1787,21 @@
 fi
 if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
   echo "$ac_t""yes" 1>&6
-  
-		SHLIB_CFLAGS="-fpic"
-		SHLIB_LD="ld -Bshareable -x"
+
+		case `machine` in
+		sparc)
+		    SHLIB_CFLAGS="-fPIC";;
+		*)
+		    SHLIB_CFLAGS="-fpic";;
+		esac
+		SHLIB_LD="ld -Bshareable -Bforcearchive -x"
 		SHLIB_LD_LIBS=""
 		SHLIB_SUFFIX=".so"
 		DL_OBJS="tclLoadDl.o"
 		DL_LIBS=""
 		LDFLAGS=""
 		LD_SEARCH_FLAGS=""
-		SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so.1.0'
+		SHARED_LIB_SUFFIX='${TCL_TRIM_DOTS}\$\{DBGX\}.so.1.3'
 	    
 else
   echo "$ac_t""no" 1>&6
@@ -2267,6 +2272,7 @@
 	echo "$ac_t""no" 1>&6
     fi
 
+TCL_SRC_DIR=${prefix}/include/tcl${TCL_VERSION}
 
 LIB_RUNTIME_DIR='${LIB_RUNTIME_DIR}'
 
@@ -3969,14 +3975,13 @@
     TK_SHLIB_CFLAGS="${SHLIB_CFLAGS}"
     TK_LIB_FILE=libtk${TK_SHARED_LIB_SUFFIX}
     MAKE_LIB="\${SHLIB_LD} -o \${TK_LIB_FILE} \${OBJS} \$(TK_LD_SEARCH_FLAGS) ${TCL_STUB_LIB_SPEC} \${LIBS}"
-    RANLIB=":"
 
 #    TCL_STUB_FLAGS="-DUSE_TCL_STUBS"
     TCL_STUB_FLAGS=""
 else
     TK_SHLIB_CFLAGS=""
     TK_LIB_FILE=libtk${TK_UNSHARED_LIB_SUFFIX}
-    MAKE_LIB="ar cr \${TK_LIB_FILE} \${OBJS}"
+    MAKE_LIB="ar cr \${TK_LIB_FILE} \${OBJS}; \${RANLIB} \${TK_LIB_FILE}"
 
     TCL_STUB_FLAGS=""
 fi
@@ -4018,7 +4023,7 @@
 # Replace ${VERSION} with contents of ${TK_VERSION}
 eval "STUB_LIB_FILE=libtkstub${TK_UNSHARED_LIB_SUFFIX}"
 
-MAKE_STUB_LIB="ar cr \${STUB_LIB_FILE} \${STUB_LIB_OBJS}"
+MAKE_STUB_LIB="ar cr \${STUB_LIB_FILE} \${STUB_LIB_OBJS}; \${RANLIB} \${STUB_LIB_FILE}"
 
 TK_STUB_LIB_FILE=${STUB_LIB_FILE}
 

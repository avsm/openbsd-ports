$OpenBSD: patch-daemon_gvfsbackenddav_c,v 1.3 2011/04/05 14:43:25 ajacoutot Exp $

Fix unmounting webdav share:
    http://bugzilla.gnome.org/show_bug.cgi?id=567664

--- daemon/gvfsbackenddav.c.orig	Mon Apr  4 16:49:12 2011
+++ daemon/gvfsbackenddav.c	Mon Apr  4 19:37:54 2011
@@ -2302,13 +2302,13 @@ do_set_display_name (GVfsBackend           *backend,
   soup_uri_free (source);
 }
 
-static gboolean
-try_unmount (GVfsBackend    *backend,
+static void
+do_unmount (GVfsBackend    *backend,
              GVfsJobUnmount *job,
              GMountUnmountFlags flags,
              GMountSource *mount_source)
 {
-  _exit (0);
+  g_vfs_job_succeeded (G_VFS_JOB (job));
 }
 
 /* ************************************************************************* */
@@ -2336,5 +2336,5 @@ g_vfs_backend_dav_class_init (GVfsBackendDavClass *kla
   backend_class->make_directory    = do_make_directory;
   backend_class->delete            = do_delete;
   backend_class->set_display_name  = do_set_display_name;
-  backend_class->try_unmount       = try_unmount;
+  backend_class->unmount           = do_unmount;
 }

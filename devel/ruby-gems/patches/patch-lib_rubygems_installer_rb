$OpenBSD: patch-lib_rubygems_installer_rb,v 1.9 2010/10/06 18:12:19 jeremy Exp $

This is for GEM_SKIPDEPENDS in ruby.port.mk.

--- lib/rubygems/installer.rb.orig	Mon Apr 19 23:47:36 2010
+++ lib/rubygems/installer.rb	Wed Oct  6 10:26:54 2010
@@ -113,6 +113,7 @@ class Gem::Installer
     @bin_dir             = options[:bin_dir]
     @development         = options[:development]
     @source_index        = options[:source_index]
+    @skip_dependencies   = options[:skip_dependencies]
 
     begin
       @format = Gem::Format.from_file_by_path @gem, @security_policy
@@ -178,7 +179,12 @@ class Gem::Installer
         deps |= @spec.development_dependencies if @development
 
         deps.each do |dep_gem|
-          ensure_dependency @spec, dep_gem
+          if @skip_dependencies && @skip_dependencies.include?(dep_gem.name)
+            say "Skipping '#{dep_gem.name}' dependency."
+            @spec.dependencies.delete(dep_gem)
+          else
+            ensure_dependency @spec, dep_gem
+          end
         end
       end
     end

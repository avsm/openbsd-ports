$OpenBSD: patch-cups_Makefile,v 1.3 2006/10/01 10:43:38 mbalmer Exp $
--- cups/Makefile.orig	Thu Aug  3 04:20:57 2006
+++ cups/Makefile	Wed Sep 20 11:03:14 2006
@@ -138,7 +138,7 @@ all:	$(TARGETS)
 
 clean:
 	$(RM) $(OBJS) $(TARGETS)
-	$(RM) libcups.so libcups.sl libcups.dylib
+	$(RM) libcups.so libcups.so.${LIBcups_VERSION} libcups.sl libcups.dylib
 	$(RM) -r 32bit 64bit
 
 
@@ -163,9 +163,9 @@ depend:
 install:	all installhdrs $(INSTALLSTATIC) $(INSTALL32) $(INSTALL64)
 	$(INSTALL_DIR) -m 755 $(LIBDIR)
 	$(INSTALL_LIB) $(LIBCUPS) $(LIBDIR)
-	if test $(LIBCUPS) = "libcups.so.2" -o $(LIBCUPS) = "libcups.sl.2"; then \
-		$(RM) $(LIBDIR)/`basename $(LIBCUPS) .2`; \
-		$(LN) $(LIBCUPS) $(LIBDIR)/`basename $(LIBCUPS) .2`; \
+	if test $(LIBCUPS) = "libcups.so.${LIBcups_VERSION}" -o $(LIBCUPS) = "libcups.sl.${LIBcups_VERSION}"; then \
+		$(RM) $(LIBDIR)/`basename $(LIBCUPS) .${LIBcups_VERSION}`; \
+		$(LN) $(LIBCUPS) $(LIBDIR)/`basename $(LIBCUPS) .${LIBcups_VERSION}`; \
 	fi
 	if test $(LIBCUPS) = "libcups.2.dylib"; then \
 		$(STRIP) -x $(LIBDIR)/$(LIBCUPS); \
@@ -186,13 +186,13 @@ installhdrs:
 
 install32bit:
 	$(INSTALL_DIR) -m 755 $(LIB32DIR)
-	$(INSTALL_LIB) 32bit/libcups.so.2 $(LIB32DIR)/libcups.so.2
-	$(LN) libcups.so.2 $(LIB32DIR)/libcups.so
+	$(INSTALL_LIB) 32bit/libcups.so.${LIBcups_VERSION} $(LIB32DIR)/libcups.so.${LIBcups_VERSION}
+	$(LN) libcups.so.${LIBcups_VERSION} $(LIB32DIR)/libcups.so
 
 install64bit:
 	$(INSTALL_DIR) -m 755 $(LIB64DIR)
-	$(INSTALL_LIB) 64bit/libcups.so.2 $(LIB64DIR)/libcups.so.2
-	$(LN) libcups.so.2 $(LIB64DIR)/libcups.so
+	$(INSTALL_LIB) 64bit/libcups.so.${LIBcups_VERSION} $(LIB64DIR)/libcups.so.${LIBcups_VERSION}
+	$(LN) libcups.so.${LIBcups_VERSION} $(LIB64DIR)/libcups.so
 
 
 #
@@ -207,7 +207,7 @@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
 	$(RM) $(LIBDIR)/libcups.sl
 	$(RM) $(LIBDIR)/libcups.sl.2
 	$(RM) $(LIBDIR)/libcups.so
-	$(RM) $(LIBDIR)/libcups.so.2
+	$(RM) $(LIBDIR)/libcups.so.${LIBcups_VERSION}
 	-$(RMDIR) $(LIBDIR)
 	for file in $(HEADERS); do \
 		$(RM) $(INCLUDEDIR)/cups/$$file; \
@@ -216,48 +216,48 @@ uninstall: $(UNINSTALL32) $(UNINSTALL64)
 
 uninstall32bit:
 	$(RM) $(LIB32DIR)/libcups.so
-	$(RM) $(LIB32DIR)/libcups.so.2
+	$(RM) $(LIB32DIR)/libcups.so.${LIBcups_VERSION}
 	-$(RMDIR) $(LIB32DIR)
 
 uninstall64bit:
 	$(RM) $(LIB64DIR)/libcups.so
-	$(RM) $(LIB64DIR)/libcups.so.2
+	$(RM) $(LIB64DIR)/libcups.so.${LIBcups_VERSION}
 	-$(RMDIR) $(LIB64DIR)
 
 
 #
-# libcups.so.2, libcups.sl.2
+# libcups.so.${LIBcups_VERSION}, libcups.sl.2
 #
 
-libcups.so.2 libcups.sl.2:	$(LIBOBJS)
+libcups.so.${LIBcups_VERSION} libcups.sl.2:	$(LIBOBJS)
 	echo Linking $@...
 	$(DSO) $(ARCHFLAGS) $(DSOFLAGS) -o $@ $(LIBOBJS) $(SSLLIBS) $(COMMONLIBS) $(LIBZ)
-	$(RM) `basename $@ .2`
-	$(LN) $@ `basename $@ .2`
+	$(RM) `basename $@ .${LIBcups_VERSION}`
+	$(LN) $@ `basename $@ .${LIBcups_VERSION}`
 
 
 #
-# 32bit/libcups.so.2
+# 32bit/libcups.so.${LIBcups_VERSION}
 #
 
-32bit/libcups.so.2:	$(LIB32OBJS)
+32bit/libcups.so.${LIBcups_VERSION}:	$(LIB32OBJS)
 	echo Linking 32-bit $@...
 	-mkdir 32bit
 	$(DSO) $(ARCH32FLAGS) $(DSO32FLAGS) -o $@ $(LIB32OBJS) $(SSLLIBS) $(COMMONLIBS) $(LIBZ)
 	$(RM) 32bit/libcups.so
-	$(LN) libcups.so.2 32bit/libcups.so
+	$(LN) libcups.so.${LIBcups_VERSION} 32bit/libcups.so
 
 
 #
-# 64bit/libcups.so.2
+# 64bit/libcups.so.${LIBcups_VERSION}
 #
 
-64bit/libcups.so.2:	$(LIB64OBJS)
+64bit/libcups.so.${LIBcups_VERSION}:	$(LIB64OBJS)
 	echo Linking 64-bit $@...
 	-mkdir 64bit
 	$(DSO) $(ARCH64FLAGS) $(DSO64FLAGS) -o $@ $(LIB64OBJS) $(SSLLIBS) $(COMMONLIBS) $(LIBZ)
 	$(RM) 64bit/libcups.so
-	$(LN) libcups.so.2 64bit/libcups.so
+	$(LN) libcups.so.${LIBcups_VERSION} 64bit/libcups.so
 
 
 #

$OpenBSD: patch-kdesu_process_cpp,v 1.2 2003/01/06 22:46:02 espie Exp $
--- kdesu/process.cpp.orig	Mon Mar  4 01:59:15 2002
+++ kdesu/process.cpp	Mon Jan  6 23:41:20 2003
@@ -38,6 +38,9 @@
 #include <stropts.h>
 #include <sys/stream.h>
 #endif
+#ifdef __OpenBSD__
+#include <sys/ioctl.h>
+#endif
 
 #ifdef HAVE_SYS_SELECT_H
 #include <sys/select.h>                // Needed on some systems.
@@ -360,8 +363,13 @@ int PtyProcess::waitForChild()
     while (1) 
     {
         tv.tv_sec = 1; tv.tv_usec = 0;
-        FD_SET(m_Fd, &fds);
-        ret = select(m_Fd+1, &fds, 0L, 0L, &tv);
+	if (m_Fd != -1)
+	{
+	    FD_SET(m_Fd, &fds);
+	    ret = select(m_Fd+1, &fds, 0L, 0L, &tv);
+	}
+	else
+	    ret = 0;
         if (ret == -1) 
         {
             if (errno == EINTR) continue;
@@ -448,6 +456,9 @@ int PtyProcess::SetupTTY(int fd)
     ioctl(slave, I_PUSH, "ptem");
     ioctl(slave, I_PUSH, "ldterm");
 
+#endif
+#ifdef __OpenBSD__
+    ioctl(slave, TIOCSCTTY, (char *)NULL);
 #endif
 
     // Connect stdin, stdout and stderr

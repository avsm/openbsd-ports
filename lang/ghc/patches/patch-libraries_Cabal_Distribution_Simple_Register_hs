$OpenBSD: patch-libraries_Cabal_Distribution_Simple_Register_hs,v 1.5 2010/11/05 21:23:46 kili Exp $
--- libraries/Cabal/Distribution/Simple/Register.hs.orig	Wed Jun  9 20:10:19 2010
+++ libraries/Cabal/Distribution/Simple/Register.hs	Fri Nov  5 19:25:46 2010
@@ -130,13 +130,14 @@ register pkg@PackageDescription { library       = Just
 
     installedPkgInfo <- generateRegistrationInfo
                            verbosity pkg lib lbi clbi inplace distPref
+    let installedPkgInfo' = installedPkgInfo { IPI.pkgpath = pkgPath }
 
      -- Three different modes:
     case () of
-     _ | modeGenerateRegFile   -> writeRegistrationFile installedPkgInfo
-       | modeGenerateRegScript -> writeRegisterScript   installedPkgInfo
+     _ | modeGenerateRegFile   -> writeRegistrationFile installedPkgInfo'
+       | modeGenerateRegScript -> writeRegisterScript   installedPkgInfo'
        | otherwise             -> registerPackage' verbosity
-                                    installedPkgInfo pkg lbi inplace packageDbs
+                                    installedPkgInfo' pkg lbi inplace packageDbs
 
   where
     modeGenerateRegFile = isJust (flagToMaybe (regGenPkgConf regFlags))
@@ -152,6 +153,7 @@ register pkg@PackageDescription { library       = Just
     packageDbs = nub $ withPackageDB lbi
                     ++ maybeToList (flagToMaybe  (regPackageDB regFlags))
     distPref  = fromFlag (regDistPref regFlags)
+    pkgPath = fromFlag (regPkgPath regFlags)
     verbosity = fromFlag (regVerbosity regFlags)
 
     writeRegistrationFile installedPkgInfo = do
@@ -311,6 +313,7 @@ generalInstalledPackageInfo adjustRelIncDirs pkg lib c
     IPI.pkgUrl             = pkgUrl      pkg,
     IPI.description        = description pkg,
     IPI.category           = category    pkg,
+    IPI.pkgpath            = "",
     IPI.exposed            = libExposed  lib,
     IPI.exposedModules     = exposedModules lib,
     IPI.hiddenModules      = otherModules bi,

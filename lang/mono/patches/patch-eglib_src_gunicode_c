$OpenBSD: patch-eglib_src_gunicode_c,v 1.1 2010/10/15 16:21:07 robert Exp $
--- eglib/src/gunicode.c.orig	Thu Oct 14 21:42:12 2010
+++ eglib/src/gunicode.c	Thu Oct 14 21:43:17 2010
@@ -53,6 +53,9 @@
 #    ifdef HAVE_ICONV_H
 #       include <iconv.h>
 #    endif
+#    ifdef HAVE_LOCALCHARSET_H
+#       include <localcharset.h>
+#    endif
 #endif
 
 static char *my_charset;
@@ -303,8 +306,8 @@ g_get_charset (G_CONST_RETURN char **charset)
 #else
 	if (my_charset == NULL){
 		/* These shouldn't be heap allocated */
-#if HAVE_LANGINFO_H
-		my_charset = nl_langinfo (CODESET);
+#if HAVE_LOCALCHARSET_H
+		my_charset = locale_charset ();
 #else
 		my_charset = "UTF-8";
 #endif

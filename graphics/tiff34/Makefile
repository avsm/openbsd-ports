# OpenBSD makefile for:	tiff34
# Version required:	3.4beta35
# Date created:	 	December 18, 1997	
# Whom:			Don Schmidt
#
# $OpenBSD: Makefile,v 1.2 1998/02/10 13:59:44 niklas Exp $
#

# NOTE:
# To get rid of rumored incompatibility between libtiff3.3 and 3.4
# (can somebody confirm it?) installation will be done as libtiff34.a,
# not libtiff.a.  The port is made so that there's no overwrite
# for headers, libraries, and documents.  (there may be overwrite of manuals)

DISTNAME=	tiff-v3.4
PKGNAME=	tiff-3.4
CATEGORIES=	graphics
MASTER_SITES=   ftp://ftp.sgi.com/graphics/tiff/ \
		ftp://ftp.isri.unlv.edu/pub/mirror/tiff/
EXTRACT_SUFX=	-tar.gz

MAINTAINER=	don@OpenBSD.ORG
.if ${MACHINE_ARCH} == "alpha"
BROKEN=		yes
.endif

LIB_DEPENDS=    jpeg\\.7\\.:${PORTSDIR}/graphics/jpeg

WRKSRC=		${WRKDIR}/tiff-v3.4
HAS_CONFIGURE=	yes
CONFIGURE_ARGS=	--with-ZIP --with-JPEG --with-DIR_BIN=${PREFIX}/bin \
		--with-DIR_LIB=${PREFIX}/lib --with-DIR_INC=${PREFIX}/include \
		--with-CC="${CC}" --with-GCOPTS="${CFLAGS}" \
		--with-DIRS_LIBINC=${PREFIX}/include \
		--with-DIR_GZLIB=/usr/lib \
		--with-DIR_JPEGLIB=${PREFIX}/lib \
		--with-LIBGL=no --with-LIBIMAGE=no \
		--with-INSTALL="/bin/sh ${WRKSRC}/port/install.sh" \
		--noninteractive
MAN1=	fax2ps.1 fax2tiff.1 gif2tiff.1 pal2rgb.1 ppm2tiff.1 ras2tiff.1 \
	rgb2ycbcr.1 sgi2tiff.1 thumbnail.1 tiff2bw.1 tiff2ps.1 tiffcmp.1 \
	tiffcp.1 tiffdither.1 tiffdump.1 tiffgt.1 tiffinfo.1 tiffmedian.1 \
	tiffsplit.1 tiffsv.1
MAN3=	TIFFCheckTile.3t TIFFClose.3t TIFFComputeStrip.3t TIFFComputeTile.3t \
	TIFFCurrentDirectory.3t TIFFCurrentRow.3t TIFFCurrentStrip.3t \
	TIFFCurrentTile.3t TIFFDefaultStripSize.3t TIFFDefaultTileSize.3t \
	TIFFError.3t TIFFFdOpen.3t TIFFFileName.3t TIFFFileno.3t \
	TIFFFindCODEC.3t TIFFFlush.3t TIFFFlushData.3t TIFFGetField.3t \
	TIFFGetMode.3t TIFFIsByteSwapped.3t TIFFIsMSB2LSB.3t TIFFIsTiled.3t \
	TIFFIsUpSampled.3t TIFFLastDirectory.3t TIFFNumberOfStrips.3t \
	TIFFNumberOfTiles.3t TIFFOpen.3t TIFFPrintDirectory.3t \
	TIFFRGBAImage.3t TIFFRGBAImageBegin.3t TIFFRGBAImageEnd.3t \
	TIFFRGBAImageGet.3t TIFFRGBAImageOK.3t TIFFReadBufferSetup.3t \
	TIFFReadDirectory.3t TIFFReadEncodedStrip.3t TIFFReadEncodedTile.3t \
	TIFFReadRGBAImage.3t TIFFReadRawStrip.3t TIFFReadRawTile.3t \
	TIFFReadScanline.3t TIFFReadTile.3t TIFFRegisterCODEC.3t \
	TIFFReverseBits.3t TIFFScanlineSize.3t TIFFSetDirectory.3t \
	TIFFSetErrorHandler.3t TIFFSetField.3t TIFFSetSubDirectory.3t \
	TIFFSetWarningHandler.3t TIFFStripSize.3t TIFFSwabArrayOfLong.3t \
	TIFFSwabArrayOfShort.3t TIFFSwabLong.3t TIFFSwabShort.3t \
	TIFFTileRowSize.3t TIFFTileSize.3t TIFFUnRegisterCODEC.3t \
	TIFFVGetField.3t TIFFVSetField.3t TIFFVStripSize.3t TIFFVTileSize.3t \
	TIFFWarning.3t TIFFWriteBufferSetup.3t TIFFWriteDirectory.3t \
	TIFFWriteEncodedStrip.3t TIFFWriteEncodedTile.3t TIFFWriteRawStrip.3t \
	TIFFWriteRawTile.3t TIFFWriteScanline.3t TIFFbuffer.3t TIFFcodec.3t \
	TIFFfree.3t TIFFmalloc.3t TIFFmemcmp.3t TIFFmemcpy.3t TIFFmemory.3t \
	TIFFmemset.3t TIFFquery.3t TIFFrealloc.3t TIFFsize.3t TIFFstrip.3t \
	TIFFswab.3t TIFFtile.3t libtiff.3t

DOCDIR=	${PREFIX}/share/doc/tiff34

post-install:
.if !defined(NOPORTDOCS)
	@${MKDIR} ${DOCDIR}/images
	${INSTALL_DATA} ${WRKSRC}/html/*.html ${DOCDIR}
	${INSTALL_DATA} ${WRKSRC}/html/images/* ${DOCDIR}/images
.endif
	perl -pi -e 's/\"tiff.h\"/\"tiff34\.h\"/g;' ${PREFIX}/include/tiffio34.h
	${LDCONFIG} -m ${PREFIX}/lib

.include <bsd.port.mk>

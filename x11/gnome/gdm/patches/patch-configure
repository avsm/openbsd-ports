$OpenBSD: patch-configure,v 1.15 2009/01/31 12:09:49 ajacoutot Exp $
--- configure.orig	Wed Dec 10 23:26:30 2008
+++ configure	Sat Jan 31 10:48:03 2009
@@ -31009,7 +31009,6 @@ fi
 if test x$with_tcp_wrappers = xno ; then
 	echo "TCP wrappers disabled"
 else
-  LIBWRAP_PATH=""
   case "$host" in
     *-*-solaris*)
 	if test -f /usr/lib/libwrap.so; then
@@ -31064,6 +31063,8 @@ cat >>conftest.$ac_ext <<_ACEOF
 #ifdef __cplusplus
 extern "C"
 #endif
+int allow_severity = 1;
+int deny_severity = 1;
 char hosts_ctl ();
 int
 main ()
@@ -31219,7 +31220,6 @@ else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-	LIBWRAP_PATH=""
 fi
 
 rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
@@ -32999,7 +32999,7 @@ fi
 #
 # Define some variables to represent the directories we use.
 #
-authdir=${localstatedir}/gdm
+authdir=${localstatedir}/db/gdm
 
 gdmlocaledir=${gdmconfdir}
 
@@ -33715,9 +33715,9 @@ case "$host" in
 	;;
 *openbsd*)
 	HOST_GDM_USER_PATH="/bin:/usr/bin"
-	HOST_HALT_COMMAND="/sbin/halt -p;/usr/bin/poweroff;/sbin/poweroff;/sbin/shutdown -h now;/usr/sbin/shutdown -h now"
-	HOST_REBOOT_COMMAND="/usr/bin/reboot;/sbin/reboot;/sbin/shutdown -r now;/usr/sbin/shutdown -r now"
-	HOST_SUSPEND_COMMAND="/usr/bin/zzz"
+	HOST_HALT_COMMAND="/sbin/halt -p;/sbin/shutdown -hp now"
+	HOST_REBOOT_COMMAND="/sbin/reboot;/sbin/shutdown -r now"
+	HOST_SUSPEND_COMMAND="/usr/sbin/zzz"
 	HOST_XSESSION_SHELL=/bin/sh
 	HOST_SOUND_PROGRAM="$real_gdm_prefix/bin/play"
 	HOST_GDMGNOMESESSIONCMD=gnome-session
@@ -33834,6 +33834,12 @@ else
    GDM_USER_PATH="$GDM_USER_PATH:/usr/bin/X11:/usr/X11R6/bin:/usr/local/bin:/opt/X11R6/bin"
    X_CONFIG_OPTIONS="-audit 0"
 fi
+
+case $host in
+    i386-*-openbsd*|amd64-*-openbsd*)
+        X_CONFIG_OPTIONS="$X_CONFIG_OPTIONS vt5"
+        ;;
+esac
 
 # Use Xephyr if it is available.  It works better than Xnest since Xephyr
 # supports the Xserver extensions, even if on a remote machine.

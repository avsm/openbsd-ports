$OpenBSD: patch-libavcodec_Makefile,v 1.11 2005/12/31 08:45:56 steven Exp $
--- libavcodec/Makefile.orig	Sun Apr  3 07:02:08 2005
+++ libavcodec/Makefile	Thu Dec 29 08:49:19 2005
@@ -73,11 +73,11 @@ ifeq ($(CONFIG_AC3),yes)
 OBJS+= a52dec.o
 
 # using builtin liba52 or runtime linked liba52.so.0
-ifneq ($(CONFIG_A52BIN),yes)
-OBJS+= liba52/bit_allocate.o liba52/bitstream.o liba52/downmix.o \
-	liba52/imdct.o  liba52/parse.o liba52/crc.o liba52/resample.o
+#ifneq ($(CONFIG_A52BIN),yes)
+#OBJS+= liba52/bit_allocate.o liba52/bitstream.o liba52/downmix.o \
+#	liba52/imdct.o  liba52/parse.o liba52/crc.o liba52/resample.o
+#endif
 endif
-endif
 
 # currently using libdts for dts decoding
 ifeq ($(CONFIG_DTS),yes)
@@ -207,7 +207,8 @@ OBJS := $(OBJS) $(ASM_OBJS)
 
 LIB= $(LIBPREF)avcodec$(LIBSUF)
 ifeq ($(BUILD_SHARED),yes)
-SLIB= $(SLIBPREF)avcodec$(SLIBSUF)
+SLIB= $(SLIBPREF)avcodec$(SLIBSUF).$(LIBavcodec_VERSION)
+CFLAGS += ${PIC} -DPIC
 endif
 TESTS= imgresample-test dct-test motion-test fft-test
 
@@ -231,7 +232,7 @@ ifeq ($(CONFIG_WIN32),yes)
 	$(CC) $(SHFLAGS) -Wl,--output-def,$(@:.dll=.def) -o $@ $(OBJS) $(EXTRALIBS) $(AMREXTRALIBS)
 	-lib /machine:i386 /def:$(@:.dll=.def)
 else
-	$(CC) $(SHFLAGS) -o $@ $(OBJS) $(EXTRALIBS) $(AMREXTRALIBS) $(LDFLAGS)
+	$(CC) $(SHFLAGS) -o $@ $(OBJS) $(AMREXTRALIBS) $(LDFLAGS)
 endif
 
 dsputil.o: dsputil.c dsputil.h

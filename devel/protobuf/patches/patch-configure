$OpenBSD: patch-configure,v 1.2 2011/07/08 07:22:32 dcoppa Exp $
--- configure.orig	Fri Jan  8 20:26:18 2010
+++ configure	Thu Jul  7 15:44:35 2011
@@ -906,7 +906,6 @@ CXX
 CXXFLAGS
 CCC
 CXXCPP'
-ac_subdirs_all='gtest'
 
 # Initialize some variables set by options.
 ac_init_help=
@@ -16887,7 +16886,7 @@ test -n "$PTHREAD_CC" || PTHREAD_CC="${CC}"
 	# FIXME: -fPIC is required for -shared on many architectures,
 	# so we specify it here, but the right way would probably be to
 	# properly detect whether it is actually required.
-	CFLAGS="-shared -fPIC -Wl,-z,defs $CFLAGS $PTHREAD_CFLAGS"
+	CFLAGS="-shared -fPIC $CFLAGS $PTHREAD_CFLAGS"
 	LIBS="$PTHREAD_LIBS $LIBS"
 	CC="$PTHREAD_CC"
 
@@ -17019,7 +17018,7 @@ echo "${ECHO_T}no" >&6; }
 	if test x"$done" = xno; then
 	   { echo "$as_me:$LINENO: checking whether -lpthread fixes that" >&5
 echo $ECHO_N "checking whether -lpthread fixes that... $ECHO_C" >&6; }
-	   LIBS="-lpthread $PTHREAD_LIBS $save_LIBS"
+	   LIBS="-pthread $PTHREAD_LIBS $save_LIBS"
 	   cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -17069,7 +17068,7 @@ rm -f core conftest.err conftest.$ac_objext conftest_i
 	   if test "x$done" = xyes; then
 	      { echo "$as_me:$LINENO: result: yes" >&5
 echo "${ECHO_T}yes" >&6; }
-	      PTHREAD_LIBS="-lpthread $PTHREAD_LIBS"
+	      PTHREAD_LIBS="-pthread $PTHREAD_LIBS"
 	   else
 	      { echo "$as_me:$LINENO: result: no" >&5
 echo "${ECHO_T}no" >&6; }
@@ -17294,12 +17293,6 @@ echo "$as_me: WARNING: could not find an STL hash_map"
    fi
 
 
-# HACK:  Make gtest's configure script pick up our copy of CFLAGS and CXXFLAGS,
-#   since the flags added by ACX_CHECK_SUNCC must be used when compiling gtest
-#   too.
-export CFLAGS
-export CXXFLAGS
-subdirs="$subdirs gtest"
 
 
 ac_config_files="$ac_config_files Makefile src/Makefile protobuf.pc protobuf-lite.pc"

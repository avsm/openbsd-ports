$OpenBSD: patch-plugins_org_eclipse_swt_Eclipse_SWT_Mozilla_common_library_xpcom_cpp,v 1.4 2007/04/06 02:16:21 kurt Exp $
--- plugins/org.eclipse.swt/Eclipse SWT Mozilla/common/library/xpcom.cpp.orig	Thu Sep 21 10:57:23 2006
+++ plugins/org.eclipse.swt/Eclipse SWT Mozilla/common/library/xpcom.cpp	Thu Apr  5 08:12:50 2007
@@ -85,14 +85,15 @@ fail:
 }
 #endif
 
-#ifndef NO_NS_1InitEmbedding
-JNIEXPORT jint JNICALL XPCOM_NATIVE(NS_1InitEmbedding)
-	(JNIEnv *env, jclass that, jint arg0, jint arg1)
+#ifndef NO_NS_1InitXPCOM2
+JNIEXPORT jint JNICALL XPCOM_NATIVE(NS_1InitXPCOM2)
+	(JNIEnv *env, jclass that, jint arg0, jint arg1, jint arg2)
 {
 	jint rc = 0;
-	XPCOM_NATIVE_ENTER(env, that, NS_1InitEmbedding_FUNC);
-	rc = (jint)NS_InitEmbedding((nsILocalFile *)arg0, (nsIDirectoryServiceProvider *)arg1);
-	XPCOM_NATIVE_EXIT(env, that, NS_1InitEmbedding_FUNC);
+	XPCOM_NATIVE_ENTER(env, that,  NS_1GetComponentRegistrar_FUNC);
+	rc = (jint)NS_InitXPCOM2((nsIServiceManager **)arg0, (nsIFile *)arg1,
+		(nsIDirectoryServiceProvider *)arg2);
+	XPCOM_NATIVE_EXIT(env, that, NS_1GetComponentRegistrar_FUNC);
 	return rc;
 }
 #endif
@@ -109,18 +110,6 @@ JNIEXPORT jint JNICALL XPCOM_NATIVE(NS_1NewLocalFile)
 fail:
 	if (arg2 && lparg2) env->ReleaseIntArrayElements(arg2, lparg2, 0);
 	XPCOM_NATIVE_EXIT(env, that, NS_1NewLocalFile_FUNC);
-	return rc;
-}
-#endif
-
-#ifndef NO_NS_1TermEmbedding
-JNIEXPORT jint JNICALL XPCOM_NATIVE(NS_1TermEmbedding)
-	(JNIEnv *env, jclass that)
-{
-	jint rc = 0;
-	XPCOM_NATIVE_ENTER(env, that, NS_1TermEmbedding_FUNC);
-	rc = (jint)NS_TermEmbedding();
-	XPCOM_NATIVE_EXIT(env, that, NS_1TermEmbedding_FUNC);
 	return rc;
 }
 #endif

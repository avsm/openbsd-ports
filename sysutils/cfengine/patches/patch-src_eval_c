$OpenBSD: patch-src_eval_c,v 1.2 2004/08/08 14:02:11 sturm Exp $
--- src/eval.c.orig	Tue Jun  8 04:40:45 2004
+++ src/eval.c	Mon Aug  2 13:30:34 2004
@@ -212,7 +212,7 @@ sscanf(str,"%*s %s %s %s %s",buf2,buf3,b
 /* Hours */
 
 sscanf(buf4,"%[^:]",buf);
-sprintf(out,"Hr%s",buf);
+(void)snprintf(out,sizeof(out),"Hr%s",buf);
 AddClassToHeap(out);
 memset(VHR,0,3);
 strncpy(VHR,buf,2); 
@@ -220,7 +220,7 @@ strncpy(VHR,buf,2); 
 /* Minutes */
 
 sscanf(buf4,"%*[^:]:%[^:]",buf);
-sprintf(out,"Min%s",buf);
+(void)snprintf(out,sizeof(out),"Min%s",buf);
 AddClassToHeap(out);
 memset(VMINUTE,0,3);
 strncpy(VMINUTE,buf,2); 
@@ -260,19 +260,19 @@ switch ((i / 5))
 switch ((i / 15))
    {
    case 0: AddClassToHeap("Q1");
-           sprintf(out,"Hr%s_Q1",VHR);
+           (void)snprintf(out,sizeof(out),"Hr%s_Q1",VHR);
     AddClassToHeap(out);
            break;
    case 1: AddClassToHeap("Q2");
-           sprintf(out,"Hr%s_Q2",VHR);
+           (void)snprintf(out,sizeof(out),"Hr%s_Q2",VHR);
     AddClassToHeap(out);
            break;
    case 2: AddClassToHeap("Q3");
-           sprintf(out,"Hr%s_Q3",VHR);
+           (void)snprintf(out,sizeof(out),"Hr%s_Q3",VHR);
     AddClassToHeap(out);
            break;
    case 3: AddClassToHeap("Q4");
-           sprintf(out,"Hr%s_Q4",VHR);
+           (void)snprintf(out,sizeof(out),"Hr%s_Q4",VHR);
     AddClassToHeap(out);
            break;
    }
@@ -280,7 +280,7 @@ switch ((i / 15))
 
 /* Day */
 
-sprintf(out,"Day%s",buf3);
+(void)snprintf(out,sizeof(out),"Day%s",buf3);
 AddClassToHeap(out);
 memset(VDAY,0,3);
 strncpy(VDAY,buf3,2);
@@ -300,9 +300,9 @@ for (i = 0; i < 12; i++)
 
 /* Year */
 
-strcpy(VYEAR,buf5); 
+strncpy(VYEAR,buf5,4); 
 
-sprintf(out,"Yr%s",buf5);
+(void)snprintf(out,sizeof(out),"Yr%s",buf5);
 AddClassToHeap(out);
 }
 
@@ -548,7 +548,7 @@ while(*sp != '\0')
    if (IsHardClass(cbuff))
       { char err[CF_BUFSIZE];
       yyerror("Illegal exception");
-      sprintf (err,"Cannot negate the reserved class [%s]\n",cbuff);
+      (void)snprintf (err,sizeof(err),"Cannot negate the reserved class [%s]\n",cbuff);
       FatalError(err);
       }
 
@@ -858,7 +858,7 @@ for (sp = class; *sp != '\0'; sp++)
 
 if (bracklevel != 0)
    {
-   sprintf(OUTPUT,"Bracket mismatch, in [class=%s], level = %d\n",class,bracklevel);
+   (void)snprintf(OUTPUT,sizeof(OUTPUT),"Bracket mismatch, in [class=%s], level = %d\n",class,bracklevel);
    yyerror(OUTPUT);;
    FatalError("Aborted");
    }

#!/bin/sh
#
# $OpenBSD: INSTALL,v 1.10 2004/10/07 05:15:25 sturm Exp $

SPOOLDIR=/var/spool/news
SPOOL_DIRS='
leaf.node
failed.postings
interesting.groups
out.going
message.id
temp.files
'

set -e
PATH=/bin:/usr/bin:/sbin:/usr/sbin
PREFIX=${PKG_PREFIX:-/usr/local}

do_create_spool_dirs()
{
	if [ -d /var/spool/news ]
	then
		echo " Giving /var/spool/news to _news"
	else
		echo " Creating /var/spool/news"
		mkdir -p /var/spool/news
	fi
	chown _news:news /var/spool/news

	echo -n "Creating spool directories... "
	for d in ${SPOOL_DIRS}; do
		if [ ! -d "${SPOOLDIR}/$d" ]; then
			install -d -o _news -g news ${SPOOLDIR}/$d
		fi
	done

	cd ${SPOOLDIR}/message.id
	for a in 0 1 2 3 4 5 6 7 8 9; do
		for b in 0 1 2 3 4 5 6 7 8 9; do
			for c in 0 1 2 3 4 5 6 7 8 9; do
				install -d -o _news -g news $a$b$c
			done
		done
	done
	echo "ok"
}

# verify proper execution
#
if [ $# -ne 2 ]; then
	echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
	exit 1
fi

# Verify/process the command
#
case $2 in
	PRE-INSTALL)
		;;
	POST-INSTALL)
		do_create_spool_dirs
		;;
	*)
		echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
		exit 1
		;;
esac

exit 0

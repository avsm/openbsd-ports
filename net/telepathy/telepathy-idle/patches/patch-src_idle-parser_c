$OpenBSD: patch-src_idle-parser_c,v 1.3 2010/04/23 12:42:18 jasper Exp $
--- src/idle-parser.c.orig	Mon Sep 14 13:01:53 2009
+++ src/idle-parser.c	Thu Dec 24 13:04:59 2009
@@ -208,7 +208,9 @@ void idle_parser_receive(IdleParser *parser, const gch
 
 	g_assert(msg != NULL);
 
-	len = strnlen(msg, IRC_MSG_MAXLEN + 3);
+	len = strlen(msg);
+	g_assert(len <= IRC_MSG_MAXLEN + 3);
+		
 
 	for (i = 0; i < len; i++) {
 		if ((msg[i] == '\n' || msg[i] == '\r')) {

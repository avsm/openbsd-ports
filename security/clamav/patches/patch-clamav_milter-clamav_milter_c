--- clamav-milter/clamav-milter.c.orig	Thu Oct 16 09:29:55 2008
+++ clamav-milter/clamav-milter.c	Fri Nov  7 02:29:18 2008
@@ -1204,7 +1204,7 @@ main(int argc, char **argv)
 		 * uid == 0 for that
 		 */
 		on = 1;
-		if(setsockopt(broadcastSock, SOL_SOCKET, SO_BROADCAST, (int *)&on, sizeof(on)) < 0) {
+		if(setsockopt(broadcastSock, SOL_SOCKET, 0, (int *)&on, sizeof(on)) < 0) {
 			perror("setsockopt");
 			return EX_UNAVAILABLE;
 		}
@@ -1227,7 +1227,7 @@ main(int argc, char **argv)
 			memset(&ifr, '\0', sizeof(struct ifreq));
 			strncpy(ifr.ifr_name, iface, sizeof(ifr.ifr_name) - 1);
 			ifr.ifr_name[sizeof(ifr.ifr_name)-1]='\0';
-			if(setsockopt(broadcastSock, SOL_SOCKET, SO_BINDTODEVICE, &ifr, sizeof(ifr)) < 0) {
+			if(setsockopt(broadcastSock, SOL_SOCKET, 0, &ifr, sizeof(ifr)) < 0) {
 				perror(iface);
 				return EX_CONFIG;
 			}

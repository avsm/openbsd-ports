$OpenBSD: patch-configure_in,v 1.3 2002/05/11 21:35:13 matt Exp $

        This has been submitted to the Python team as part of patch
        554719.

--- configure.in.orig	Mon Mar 11 05:14:23 2002
+++ configure.in	Fri Apr 19 09:05:16 2002
@@ -802,7 +802,21 @@ then
 	Linux*) LDSHARED="gcc -shared";;
 	dgux*) LDSHARED="ld -G";;
 	BSD/OS*/4*) LDSHARED="gcc -shared";;
-	OpenBSD*|NetBSD*|FreeBSD*)
+	OpenBSD*)
+		if [[ "`$CC -dM -E - </dev/null | grep __ELF__`" != "" ]]
+		then
+			LDSHARED="cc -shared ${LDFLAGS}"
+		else
+			case `uname -r` in
+			[01].* | 2.[[0-7]] | 2.[[0-7]].*)
+			  LDSHARED="ld -Bshareable"
+			  ;;
+			*)
+			  LDSHARED='$(CC) -shared $(CCSHARED)'
+			  ;;
+			esac
+		fi;;
+	NetBSD*|FreeBSD*)
 		if [[ "`$CC -dM -E - </dev/null | grep __ELF__`" != "" ]]
 		then
 			LDSHARED="cc -shared ${LDFLAGS}"
@@ -1016,6 +1030,14 @@ then
     AC_DEFINE(WITH_THREAD)
     posix_threads=yes
     LIBOBJS="$LIBOBJS thread.o"
+elif test "$ac_sys_system" = "OpenBSD"
+then
+    posix_threads=yes
+    LIBS="-pthread $LIBS"
+    LIBOBJS="$LIBOBJS thread.o"
+    AC_DEFINE(WITH_THREAD)
+    AC_DEFINE(_REENTRANT)
+    AC_DEFINE(_POSIX_THREADS)
 else
     if test ! -z "$with_threads" -a -d "$with_threads"
     then LDFLAGS="$LDFLAGS -L$with_threads"

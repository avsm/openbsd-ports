$OpenBSD: patch-xpcom_components_nsComponentManager_cpp,v 1.1 2003/05/17 16:58:35 wilfried Exp $
--- xpcom/components/nsComponentManager.cpp.orig	Sat May 10 21:22:40 2003
+++ xpcom/components/nsComponentManager.cpp	Wed May 14 12:35:49 2003
@@ -2403,9 +2403,12 @@
     }
 
 #ifdef XPCOM_CHECK_PENDING_CIDS  
-    rv = AddPendingCID(entry->cid);
-    if (NS_FAILED(rv))
-        return rv;
+    if (entry && entry != kNonExistentContractID)
+    {
+	rv = AddPendingCID(entry->cid);
+	if (NS_FAILED(rv))
+	    return rv;
+    }
 #endif
     nsCOMPtr<nsISupports> service;
     // We need to not be holding the service manager's monitor while calling 
@@ -2418,7 +2421,8 @@
     mon.Enter();
 
 #ifdef XPCOM_CHECK_PENDING_CIDS 
-    RemovePendingCID(entry->cid);
+    if (entry && entry != kNonExistentContractID)
+	RemovePendingCID(entry->cid);
 #endif
 
     if (NS_FAILED(rv))

$OpenBSD: patch-test_4_4-subscription-ops_test,v 1.1 2009/03/04 19:50:00 jasper Exp $

Security fix for CVE-2008-5183.
Patch adapted from Red Hat's solution.

*** test/4.4-subscription-ops.test.orig	Wed Aug 16 22:05:58 2006
--- test/4.4-subscription-ops.test	Fri Feb 27 11:26:51 2009
***************
*** 117,120 ****
--- 117,147 ----
  	DISPLAY notify-events
  }
+ {
+        # The name of the test...
+        NAME "Check MaxSubscriptions limits"
+ 
+        # The operation to use
+        OPERATION Create-Printer-Subscription
+        RESOURCE /
+ 
+        # The attributes to send
+        GROUP operation
+        ATTR charset attributes-charset utf-8
+        ATTR language attributes-natural-language en
+        ATTR uri printer-uri $method://$hostname:$port/printers/Test1
+ 
+ 	GROUP subscription
+        ATTR uri notify-recipient-uri testnotify://
+        ATTR keyword notify-events printer-state-changed
+        ATTR integer notify-lease-duration 5
+ 
+        # What statuses are OK?
+        STATUS client-error-too-many-subscriptions
+ 
+        # What attributes do we expect?
+        EXPECT attributes-charset
+        EXPECT attributes-natural-language
+ }
+ 
  
  #

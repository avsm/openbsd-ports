$OpenBSD: patch-binutils_dllwrap_c,v 1.4 2003/06/08 03:04:50 brad Exp $
--- binutils/dllwrap.c.orig	Mon Jul 15 22:04:32 2002
+++ binutils/dllwrap.c	Sun Mar 16 15:35:15 2003
@@ -366,7 +366,11 @@ run (what, args)
   int i;
   const char **argv;
   char *errmsg_fmt, *errmsg_arg;
+#if defined(__MSDOS__) && !defined(__GO32__)
   char *temp_base = choose_temp_base ();
+#else
+  char *temp_base = NULL;
+#endif
   int in_quote;
   char sep;
 
@@ -820,12 +824,9 @@ main (argc, argv)
 
   if (! def_file_seen)
     {
-      char *fileprefix = choose_temp_base ();
-      def_file_name = (char *) xmalloc (strlen (fileprefix) + 5);
-      sprintf (def_file_name, "%s.def",
-	       (dontdeltemps) ? mybasename (fileprefix) : fileprefix);
-      delete_def_file = 1;
-      free (fileprefix);
+      def_file_name = make_temp_file (".def");
+      if (dontdeltemps)
+	def_file_name = mybasename (def_file_name);
       delete_def_file = 1;
       warn (_("no export definition file provided.\n\
 Creating one, but that may not be what you want"));
@@ -1008,12 +1009,10 @@ Creating one, but that may not be what y
 
   if (! base_file_name)
     {
-      char *fileprefix = choose_temp_base ();
-      base_file_name = (char *) xmalloc (strlen (fileprefix) + 6);
-      sprintf (base_file_name, "%s.base",
-	       (dontdeltemps) ? mybasename (fileprefix) : fileprefix);
+      base_file_name = make_temp_file (".base");
+      if (dontdeltemps)
+	base_file_name = mybasename (base_file_name);
       delete_base_file = 1;
-      free (fileprefix);
     }
 
   {

$OpenBSD: patch-gas_configure_in,v 1.8 2003/06/12 14:26:20 brad Exp $
--- gas/configure.in.orig	Wed Oct 30 12:07:32 2002
+++ gas/configure.in	Thu Jun 12 10:39:54 2003
@@ -180,7 +180,7 @@ changequote([,])dnl
       alpha*-*-linuxecoff*) fmt=ecoff ;;
       alpha*-*-linux-gnu*)  fmt=elf em=linux ;;
       alpha*-*-netbsd*)     fmt=elf em=nbsd ;;
-      alpha*-*-openbsd*)    fmt=elf em=obsd ;;
+      alpha*-*-openbsd*)    fmt=elf em=nbsd ;;
 
       arc-*-elf*)           fmt=elf bfd_gas=yes ;;
 
@@ -221,8 +221,7 @@ changequote([,])dnl
 			    esac ;;
       hppa-*-*elf*)         fmt=elf em=hppa ;;
       hppa-*-lites*)        fmt=elf em=hppa ;;
-      hppa-*-netbsd*)       fmt=elf em=nbsd ;;
-      hppa-*-openbsd*)      fmt=elf em=hppa ;;
+      hppa-*-netbsd* | hppa-*-openbsd*) fmt=elf em=nbsd ;;
       hppa-*-osf*)          fmt=som em=hppa ;;
       hppa-*-rtems*)        fmt=elf em=hppa ;;
       hppa-*-hpux11*)	    case ${cpu} in
@@ -260,7 +259,16 @@ changequote([,])dnl
 					;;
 			    esac
 			    ;;
-      i386-*-openbsd*)      fmt=aout em=nbsd bfd_gas=yes;;
+changequote(,)dnl
+      i386-*-openbsd*)	    em=nbsd bfd_gas=yes
+			       case ${os} in
+				  openbsd[0-2].* | openbsd3.[0-2])
+				     fmt=aout ;;
+				  *)
+				     fmt=elf ;;
+			       esac
+			    ;;
+changequote([,])dnl
       i386-*-linux*aout* | i386-*-linux*oldld)   fmt=aout em=linux ;;
       i386-*-linux*coff*)   fmt=coff em=linux ;;
       i386-*-linux-gnu*)    fmt=elf em=linux bfd_gas=yes ;;
@@ -458,12 +466,17 @@ changequote([,])dnl
                                 sparc64) fmt=elf ;;
                             esac
                             ;;
-      sparc-*-openbsd*)     em=nbsd
-                            case ${cpu} in
-                               sparc) fmt=aout ;;
-                               sparc64) fmt=elf ;;
-                            esac
-                            ;;
+changequote(,)dnl
+      sparc-*-openbsd*)   em=nbsd bfd_gas=yes
+			     case ${os} in
+			        openbsd[0-2].* | openbsd3.[0-1])
+				   fmt=aout ;;
+			        *)
+				   fmt=elf ;;
+			     esac
+                          ;;
+changequote([,])dnl
+      sparc64-*-openbsd*) em=nbsd bfd_gas=yes fmt=elf ;;
 
       strongarm-*-coff)     fmt=coff ;;
       strongarm-*-elf)      fmt=elf ;;

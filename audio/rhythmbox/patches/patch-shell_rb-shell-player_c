$OpenBSD: patch-shell_rb-shell-player_c,v 1.4 2009/04/28 10:26:36 ajacoutot Exp $
--- shell/rb-shell-player.c.orig	Wed Apr 22 05:47:35 2009
+++ shell/rb-shell-player.c	Tue Apr 28 10:19:34 2009
@@ -765,10 +765,8 @@ rb_shell_player_open_playlist_url (RBShellPlayer *play
 		rb_player_play (player->priv->mmplayer, crossfade, &error);
 
 	if (error) {
-		GDK_THREADS_ENTER ();
 		rb_shell_player_error (player, TRUE, error);
 		g_error_free (error);
-		GDK_THREADS_LEAVE ();
 	}
 	if (player->priv->notify_playing_id == 0) {
 		player->priv->notify_playing_id = g_idle_add ((GSourceFunc) notify_playing_idle,
@@ -844,7 +842,9 @@ rb_shell_player_handle_eos_unlocked (RBShellPlayer *pl
 			/* we're handling an unexpected EOS here, so crossfading isn't
 			 * really possible anyway -> specify FALSE.
 			 */
+			GDK_THREADS_ENTER ();
 			rb_shell_player_open_playlist_url (player, location, entry, FALSE);
+			GDK_THREADS_LEAVE ();
 			g_free (location);
 			break;
 		}
@@ -1546,7 +1546,9 @@ open_location_thread (OpenLocationThreadData *data)
 	} else {
 		/* if we can't parse it as a playlist, just try playing it */
 		rb_debug ("playlist parser failed, playing %s directly", data->location);
+		GDK_THREADS_ENTER ();
 		rb_shell_player_open_playlist_url (data->player, data->location, data->entry, data->play_type);
+		GDK_THREADS_LEAVE ();
 	}
 
 	g_free (data);

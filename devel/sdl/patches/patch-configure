$OpenBSD: patch-configure,v 1.7 2001/06/23 23:35:09 pvalchev Exp $
--- configure.orig	Mon Jun 18 09:21:53 2001
+++ configure	Sat Jun 23 17:28:02 2001
@@ -3318,7 +3318,11 @@ echo "configure:3316: checking for OSS a
 #line 3319 "configure"
 #include "confdefs.h"
 
+          #ifdef __OpenBSD__
+          #include <soundcard.h>
+          #else
           #include <sys/soundcard.h>
+          #endif
         
 int main() {
 
@@ -3326,7 +3330,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:3330: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:3334: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         have_oss=yes
@@ -3361,17 +3365,17 @@ fi
         have_alsa=no
         ac_safe=`echo "sys/asoundlib.h" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for sys/asoundlib.h""... $ac_c" 1>&6
-echo "configure:3365: checking for sys/asoundlib.h" >&5
+echo "configure:3369: checking for sys/asoundlib.h" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3370 "configure"
+#line 3374 "configure"
 #include "confdefs.h"
 #include <sys/asoundlib.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:3375: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:3379: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -3393,7 +3397,7 @@ else
 fi
 
         echo $ac_n "checking for snd_pcm_open in -lasound""... $ac_c" 1>&6
-echo "configure:3397: checking for snd_pcm_open in -lasound" >&5
+echo "configure:3401: checking for snd_pcm_open in -lasound" >&5
 ac_lib_var=`echo asound'_'snd_pcm_open | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -3401,7 +3405,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-lasound  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 3405 "configure"
+#line 3409 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -3412,7 +3416,7 @@ int main() {
 snd_pcm_open()
 ; return 0; }
 EOF
-if { (eval echo configure:3416: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3420: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -3510,7 +3514,7 @@ fi
   # Extract the first word of "esd-config", so it can be a program name with args.
 set dummy esd-config; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:3514: checking for $ac_word" >&5
+echo "configure:3518: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_ESD_CONFIG'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -3545,7 +3549,7 @@ fi
 
   min_esd_version=0.2.8
   echo $ac_n "checking for ESD - version >= $min_esd_version""... $ac_c" 1>&6
-echo "configure:3549: checking for ESD - version >= $min_esd_version" >&5
+echo "configure:3553: checking for ESD - version >= $min_esd_version" >&5
   no_esd=""
   if test "$ESD_CONFIG" = "no" ; then
     no_esd=yes
@@ -3569,7 +3573,7 @@ echo "configure:3549: checking for ESD -
   echo $ac_n "cross compiling; assumed OK... $ac_c"
 else
   cat > conftest.$ac_ext <<EOF
-#line 3573 "configure"
+#line 3577 "configure"
 #include "confdefs.h"
 
 #include <stdio.h>
@@ -3627,7 +3631,7 @@ int main ()
 
 
 EOF
-if { (eval echo configure:3631: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:3635: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   :
 else
@@ -3666,7 +3670,7 @@ fi
           CFLAGS="$CFLAGS $ESD_CFLAGS"
           LIBS="$LIBS $ESD_LIBS"
           cat > conftest.$ac_ext <<EOF
-#line 3670 "configure"
+#line 3674 "configure"
 #include "confdefs.h"
 
 #include <stdio.h>
@@ -3676,7 +3680,7 @@ int main() {
  return 0; 
 ; return 0; }
 EOF
-if { (eval echo configure:3680: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3684: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
    echo "*** The test program compiled, but did not run. This usually means"
           echo "*** that the run-time linker is not finding ESD or finding the wrong"
@@ -3726,7 +3730,7 @@ fi
         # Extract the first word of "artsc-config", so it can be a program name with args.
 set dummy artsc-config; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:3730: checking for $ac_word" >&5
+echo "configure:3734: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_ARTSCCONFIG'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -3764,12 +3768,12 @@ fi
             ARTSC_CFLAGS=`$ARTSCCONFIG --cflags`
             ARTSC_LIBS=`$ARTSCCONFIG --libs`
             echo $ac_n "checking for aRts development environment""... $ac_c" 1>&6
-echo "configure:3768: checking for aRts development environment" >&5
+echo "configure:3772: checking for aRts development environment" >&5
             audio_arts=no
             save_CFLAGS="$CFLAGS"
             CFLAGS="$CFLAGS $ARTSC_CFLAGS"
             cat > conftest.$ac_ext <<EOF
-#line 3773 "configure"
+#line 3777 "configure"
 #include "confdefs.h"
 
              #include <artsc.h>
@@ -3780,7 +3784,7 @@ int main() {
             
 ; return 0; }
 EOF
-if { (eval echo configure:3784: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:3788: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
             audio_arts=yes
@@ -3814,7 +3818,7 @@ fi
 
     if test x$enable_audio = xyes -a x$enable_nas = xyes; then
         echo $ac_n "checking for NAS audio support""... $ac_c" 1>&6
-echo "configure:3818: checking for NAS audio support" >&5
+echo "configure:3822: checking for NAS audio support" >&5
         have_nas=no
         if test -r /usr/X11R6/include/audio/audiolib.h; then
             have_nas=yes
@@ -3870,7 +3874,7 @@ fi
         # Extract the first word of "nasm", so it can be a program name with args.
 set dummy nasm; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:3874: checking for $ac_word" >&5
+echo "configure:3878: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_NASM'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -3999,7 +4003,7 @@ fi
 # Uses ac_ vars as temps to allow command line to override cache and checks.
 # --without-x overrides everything else, but does not touch the cache.
 echo $ac_n "checking for X""... $ac_c" 1>&6
-echo "configure:4003: checking for X" >&5
+echo "configure:4007: checking for X" >&5
 
 # Check whether --with-x or --without-x was given.
 if test "${with_x+set}" = set; then
@@ -4061,12 +4065,12 @@ if test "$ac_x_includes" = NO; then
 
   # First, try using that file with no special directory specified.
 cat > conftest.$ac_ext <<EOF
-#line 4065 "configure"
+#line 4069 "configure"
 #include "confdefs.h"
 #include <$x_direct_test_include>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:4070: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:4074: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -4135,14 +4139,14 @@ if test "$ac_x_libraries" = NO; then
   ac_save_LIBS="$LIBS"
   LIBS="-l$x_direct_test_library $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4139 "configure"
+#line 4143 "configure"
 #include "confdefs.h"
 
 int main() {
 ${x_direct_test_function}()
 ; return 0; }
 EOF
-if { (eval echo configure:4146: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4150: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   LIBS="$ac_save_LIBS"
 # We can link X programs with no special library path.
@@ -4248,17 +4252,17 @@ else
     case "`(uname -sr) 2>/dev/null`" in
     "SunOS 5"*)
       echo $ac_n "checking whether -R must be followed by a space""... $ac_c" 1>&6
-echo "configure:4252: checking whether -R must be followed by a space" >&5
+echo "configure:4256: checking whether -R must be followed by a space" >&5
       ac_xsave_LIBS="$LIBS"; LIBS="$LIBS -R$x_libraries"
       cat > conftest.$ac_ext <<EOF
-#line 4255 "configure"
+#line 4259 "configure"
 #include "confdefs.h"
 
 int main() {
 
 ; return 0; }
 EOF
-if { (eval echo configure:4262: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4266: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   ac_R_nospace=yes
 else
@@ -4274,14 +4278,14 @@ rm -f conftest*
       else
 	LIBS="$ac_xsave_LIBS -R $x_libraries"
 	cat > conftest.$ac_ext <<EOF
-#line 4278 "configure"
+#line 4282 "configure"
 #include "confdefs.h"
 
 int main() {
 
 ; return 0; }
 EOF
-if { (eval echo configure:4285: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4289: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   ac_R_space=yes
 else
@@ -4313,7 +4317,7 @@ rm -f conftest*
     # libraries were built with DECnet support.  And karl@cs.umb.edu says
     # the Alpha needs dnet_stub (dnet does not exist).
     echo $ac_n "checking for dnet_ntoa in -ldnet""... $ac_c" 1>&6
-echo "configure:4317: checking for dnet_ntoa in -ldnet" >&5
+echo "configure:4321: checking for dnet_ntoa in -ldnet" >&5
 ac_lib_var=`echo dnet'_'dnet_ntoa | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4321,7 +4325,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-ldnet  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4325 "configure"
+#line 4329 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4332,7 +4336,7 @@ int main() {
 dnet_ntoa()
 ; return 0; }
 EOF
-if { (eval echo configure:4336: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4340: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4354,7 +4358,7 @@ fi
 
     if test $ac_cv_lib_dnet_dnet_ntoa = no; then
       echo $ac_n "checking for dnet_ntoa in -ldnet_stub""... $ac_c" 1>&6
-echo "configure:4358: checking for dnet_ntoa in -ldnet_stub" >&5
+echo "configure:4362: checking for dnet_ntoa in -ldnet_stub" >&5
 ac_lib_var=`echo dnet_stub'_'dnet_ntoa | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4362,7 +4366,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-ldnet_stub  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4366 "configure"
+#line 4370 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4373,7 +4377,7 @@ int main() {
 dnet_ntoa()
 ; return 0; }
 EOF
-if { (eval echo configure:4377: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4381: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4402,12 +4406,12 @@ fi
     # The nsl library prevents programs from opening the X display
     # on Irix 5.2, according to dickey@clark.net.
     echo $ac_n "checking for gethostbyname""... $ac_c" 1>&6
-echo "configure:4406: checking for gethostbyname" >&5
+echo "configure:4410: checking for gethostbyname" >&5
 if eval "test \"`echo '$''{'ac_cv_func_gethostbyname'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 4411 "configure"
+#line 4415 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char gethostbyname(); below.  */
@@ -4430,7 +4434,7 @@ gethostbyname();
 
 ; return 0; }
 EOF
-if { (eval echo configure:4434: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4438: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_gethostbyname=yes"
 else
@@ -4451,7 +4455,7 @@ fi
 
     if test $ac_cv_func_gethostbyname = no; then
       echo $ac_n "checking for gethostbyname in -lnsl""... $ac_c" 1>&6
-echo "configure:4455: checking for gethostbyname in -lnsl" >&5
+echo "configure:4459: checking for gethostbyname in -lnsl" >&5
 ac_lib_var=`echo nsl'_'gethostbyname | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4459,7 +4463,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-lnsl  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4463 "configure"
+#line 4467 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4470,7 +4474,7 @@ int main() {
 gethostbyname()
 ; return 0; }
 EOF
-if { (eval echo configure:4474: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4478: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4500,12 +4504,12 @@ fi
     # -lsocket must be given before -lnsl if both are needed.
     # We assume that if connect needs -lnsl, so does gethostbyname.
     echo $ac_n "checking for connect""... $ac_c" 1>&6
-echo "configure:4504: checking for connect" >&5
+echo "configure:4508: checking for connect" >&5
 if eval "test \"`echo '$''{'ac_cv_func_connect'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 4509 "configure"
+#line 4513 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char connect(); below.  */
@@ -4528,7 +4532,7 @@ connect();
 
 ; return 0; }
 EOF
-if { (eval echo configure:4532: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4536: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_connect=yes"
 else
@@ -4549,7 +4553,7 @@ fi
 
     if test $ac_cv_func_connect = no; then
       echo $ac_n "checking for connect in -lsocket""... $ac_c" 1>&6
-echo "configure:4553: checking for connect in -lsocket" >&5
+echo "configure:4557: checking for connect in -lsocket" >&5
 ac_lib_var=`echo socket'_'connect | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4557,7 +4561,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-lsocket $X_EXTRA_LIBS $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4561 "configure"
+#line 4565 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4568,7 +4572,7 @@ int main() {
 connect()
 ; return 0; }
 EOF
-if { (eval echo configure:4572: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4576: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4592,12 +4596,12 @@ fi
 
     # gomez@mi.uni-erlangen.de says -lposix is necessary on A/UX.
     echo $ac_n "checking for remove""... $ac_c" 1>&6
-echo "configure:4596: checking for remove" >&5
+echo "configure:4600: checking for remove" >&5
 if eval "test \"`echo '$''{'ac_cv_func_remove'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 4601 "configure"
+#line 4605 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char remove(); below.  */
@@ -4620,7 +4624,7 @@ remove();
 
 ; return 0; }
 EOF
-if { (eval echo configure:4624: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4628: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_remove=yes"
 else
@@ -4641,7 +4645,7 @@ fi
 
     if test $ac_cv_func_remove = no; then
       echo $ac_n "checking for remove in -lposix""... $ac_c" 1>&6
-echo "configure:4645: checking for remove in -lposix" >&5
+echo "configure:4649: checking for remove in -lposix" >&5
 ac_lib_var=`echo posix'_'remove | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4649,7 +4653,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-lposix  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4653 "configure"
+#line 4657 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4660,7 +4664,7 @@ int main() {
 remove()
 ; return 0; }
 EOF
-if { (eval echo configure:4664: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4668: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4684,12 +4688,12 @@ fi
 
     # BSDI BSD/OS 2.1 needs -lipc for XOpenDisplay.
     echo $ac_n "checking for shmat""... $ac_c" 1>&6
-echo "configure:4688: checking for shmat" >&5
+echo "configure:4692: checking for shmat" >&5
 if eval "test \"`echo '$''{'ac_cv_func_shmat'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 4693 "configure"
+#line 4697 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char shmat(); below.  */
@@ -4712,7 +4716,7 @@ shmat();
 
 ; return 0; }
 EOF
-if { (eval echo configure:4716: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4720: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_shmat=yes"
 else
@@ -4733,7 +4737,7 @@ fi
 
     if test $ac_cv_func_shmat = no; then
       echo $ac_n "checking for shmat in -lipc""... $ac_c" 1>&6
-echo "configure:4737: checking for shmat in -lipc" >&5
+echo "configure:4741: checking for shmat in -lipc" >&5
 ac_lib_var=`echo ipc'_'shmat | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4741,7 +4745,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-lipc  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4745 "configure"
+#line 4749 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4752,7 +4756,7 @@ int main() {
 shmat()
 ; return 0; }
 EOF
-if { (eval echo configure:4756: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4760: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4785,7 +4789,7 @@ fi
   # libraries we check for below, so use a different variable.
   #  --interran@uluru.Stanford.EDU, kb@cs.umb.edu.
   echo $ac_n "checking for IceConnectionNumber in -lICE""... $ac_c" 1>&6
-echo "configure:4789: checking for IceConnectionNumber in -lICE" >&5
+echo "configure:4793: checking for IceConnectionNumber in -lICE" >&5
 ac_lib_var=`echo ICE'_'IceConnectionNumber | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4793,7 +4797,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-lICE $X_EXTRA_LIBS $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4797 "configure"
+#line 4801 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4804,7 +4808,7 @@ int main() {
 IceConnectionNumber()
 ; return 0; }
 EOF
-if { (eval echo configure:4808: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4812: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4847,10 +4851,10 @@ fi
 
             if test x$enable_video_x11_vm = xyes; then
                 echo $ac_n "checking for XFree86 VidMode 1.0 support""... $ac_c" 1>&6
-echo "configure:4851: checking for XFree86 VidMode 1.0 support" >&5
+echo "configure:4855: checking for XFree86 VidMode 1.0 support" >&5
                 video_x11_vm=no
                 cat > conftest.$ac_ext <<EOF
-#line 4854 "configure"
+#line 4858 "configure"
 #include "confdefs.h"
 
                  #include <X11/Xlib.h>
@@ -4861,7 +4865,7 @@ int main() {
                 
 ; return 0; }
 EOF
-if { (eval echo configure:4865: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:4869: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
                 video_x11_vm=yes
@@ -4888,7 +4892,7 @@ fi
                         LIBS="$LIBS $X_LIBS -lX11 -lXext"
                         if test x$xfree86_glidehack = x; then
                             echo $ac_n "checking for XF40VidModeQueryExtension in -lXxf86vm""... $ac_c" 1>&6
-echo "configure:4892: checking for XF40VidModeQueryExtension in -lXxf86vm" >&5
+echo "configure:4896: checking for XF40VidModeQueryExtension in -lXxf86vm" >&5
 ac_lib_var=`echo Xxf86vm'_'XF40VidModeQueryExtension | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4896,7 +4900,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-lXxf86vm  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4900 "configure"
+#line 4904 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4907,7 +4911,7 @@ int main() {
 XF40VidModeQueryExtension()
 ; return 0; }
 EOF
-if { (eval echo configure:4911: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4915: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4930,7 +4934,7 @@ fi
                         fi
                         if test x$xfree86_glidehack = x; then
                             echo $ac_n "checking for XF40VidModeQueryExtension in -lXxf86vm40""... $ac_c" 1>&6
-echo "configure:4934: checking for XF40VidModeQueryExtension in -lXxf86vm40" >&5
+echo "configure:4938: checking for XF40VidModeQueryExtension in -lXxf86vm40" >&5
 ac_lib_var=`echo Xxf86vm40'_'XF40VidModeQueryExtension | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -4938,7 +4942,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-lXxf86vm40  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 4942 "configure"
+#line 4946 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -4949,7 +4953,7 @@ int main() {
 XF40VidModeQueryExtension()
 ; return 0; }
 EOF
-if { (eval echo configure:4953: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:4957: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -4979,10 +4983,10 @@ fi
                         SYSTEM_LIBS="$SYSTEM_LIBS -lXxf86vm"
                     fi
                     echo $ac_n "checking for XFree86 VidMode gamma support""... $ac_c" 1>&6
-echo "configure:4983: checking for XFree86 VidMode gamma support" >&5
+echo "configure:4987: checking for XFree86 VidMode gamma support" >&5
                     video_x11_vmgamma=no
                     cat > conftest.$ac_ext <<EOF
-#line 4986 "configure"
+#line 4990 "configure"
 #include "confdefs.h"
 
                      #include <X11/Xlib.h>
@@ -4994,7 +4998,7 @@ int main() {
                     
 ; return 0; }
 EOF
-if { (eval echo configure:4998: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5002: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
                     video_x11_vmgamma=yes
@@ -5028,10 +5032,10 @@ fi
 
             if test x$enable_dga = xyes; then
                 echo $ac_n "checking for XFree86 DGA 1.0 support""... $ac_c" 1>&6
-echo "configure:5032: checking for XFree86 DGA 1.0 support" >&5
+echo "configure:5036: checking for XFree86 DGA 1.0 support" >&5
                 video_x11_dga=no
                 cat > conftest.$ac_ext <<EOF
-#line 5035 "configure"
+#line 5039 "configure"
 #include "confdefs.h"
 
                  #include <X11/Xlib.h>
@@ -5042,7 +5046,7 @@ int main() {
                 
 ; return 0; }
 EOF
-if { (eval echo configure:5046: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5050: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
                 video_x11_dga=yes
@@ -5071,10 +5075,10 @@ fi
 
             if test x$enable_video_x11_xv = xyes; then
                 echo $ac_n "checking for XFree86 XvImage support""... $ac_c" 1>&6
-echo "configure:5075: checking for XFree86 XvImage support" >&5
+echo "configure:5079: checking for XFree86 XvImage support" >&5
                 video_x11_xv=no
                 cat > conftest.$ac_ext <<EOF
-#line 5078 "configure"
+#line 5082 "configure"
 #include "confdefs.h"
 
                  #include <X11/Xlib.h>
@@ -5089,7 +5093,7 @@ int main() {
                 
 ; return 0; }
 EOF
-if { (eval echo configure:5093: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5097: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
                 video_x11_xv=yes
@@ -5120,10 +5124,10 @@ fi
 
     if test x$enable_video = xyes -a x$enable_video_photon = xyes; then
         echo $ac_n "checking for QNX Photon support""... $ac_c" 1>&6
-echo "configure:5124: checking for QNX Photon support" >&5
+echo "configure:5128: checking for QNX Photon support" >&5
         video_photon=no
         cat > conftest.$ac_ext <<EOF
-#line 5127 "configure"
+#line 5131 "configure"
 #include "confdefs.h"
 
           #include <Ph.h>
@@ -5137,7 +5141,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5141: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5145: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         video_photon=yes
@@ -5169,10 +5173,10 @@ fi
 
     if test x$video_x11_dga = xyes -a x$enable_video_dga = xyes; then
         echo $ac_n "checking for XFree86 DGA 2.0 support""... $ac_c" 1>&6
-echo "configure:5173: checking for XFree86 DGA 2.0 support" >&5
+echo "configure:5177: checking for XFree86 DGA 2.0 support" >&5
         video_x11_dga2=no
         cat > conftest.$ac_ext <<EOF
-#line 5176 "configure"
+#line 5180 "configure"
 #include "confdefs.h"
 
          #include <X11/Xlib.h>
@@ -5184,7 +5188,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5188: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5192: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         video_x11_dga2=yes
@@ -5215,10 +5219,10 @@ fi
 
     if test x$enable_video = xyes -a x$enable_video_fbcon = xyes; then
         echo $ac_n "checking for framebuffer console support""... $ac_c" 1>&6
-echo "configure:5219: checking for framebuffer console support" >&5
+echo "configure:5223: checking for framebuffer console support" >&5
         video_fbcon=no
         cat > conftest.$ac_ext <<EOF
-#line 5222 "configure"
+#line 5226 "configure"
 #include "confdefs.h"
 
          #include <linux/fb.h>
@@ -5230,7 +5234,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5234: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5238: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         video_fbcon=yes
@@ -5261,10 +5265,10 @@ fi
 
     if test x$enable_video = xyes -a x$enable_video_ps2gs = xyes; then
         echo $ac_n "checking for PlayStation 2 GS support""... $ac_c" 1>&6
-echo "configure:5265: checking for PlayStation 2 GS support" >&5
+echo "configure:5269: checking for PlayStation 2 GS support" >&5
         video_ps2gs=no
         cat > conftest.$ac_ext <<EOF
-#line 5268 "configure"
+#line 5272 "configure"
 #include "confdefs.h"
 
          #include <linux/ps2/dev.h>
@@ -5275,7 +5279,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5279: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5283: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         video_ps2gs=yes
@@ -5306,10 +5310,10 @@ fi
 
     if test x$enable_video = xyes -a x$enable_video_ggi = xyes; then
         echo $ac_n "checking for GGI support""... $ac_c" 1>&6
-echo "configure:5310: checking for GGI support" >&5
+echo "configure:5314: checking for GGI support" >&5
         video_ggi=no
         cat > conftest.$ac_ext <<EOF
-#line 5313 "configure"
+#line 5317 "configure"
 #include "confdefs.h"
 
          #include <ggi/ggi.h>
@@ -5320,7 +5324,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5324: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5328: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         video_ggi=yes
@@ -5353,10 +5357,10 @@ fi
 
     if test x$enable_video = xyes -a x$enable_video_svga = xyes; then
         echo $ac_n "checking for SVGAlib (1.4.0+) support""... $ac_c" 1>&6
-echo "configure:5357: checking for SVGAlib (1.4.0+) support" >&5
+echo "configure:5361: checking for SVGAlib (1.4.0+) support" >&5
         video_svga=no
         cat > conftest.$ac_ext <<EOF
-#line 5360 "configure"
+#line 5364 "configure"
 #include "confdefs.h"
 
          #include <vga.h>
@@ -5371,7 +5375,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5375: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5379: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         video_svga=yes
@@ -5404,10 +5408,10 @@ fi
 
     if test x$enable_video = xyes -a x$enable_video_aalib = xyes; then
         echo $ac_n "checking for AAlib support""... $ac_c" 1>&6
-echo "configure:5408: checking for AAlib support" >&5
+echo "configure:5412: checking for AAlib support" >&5
         video_aalib=no
         cat > conftest.$ac_ext <<EOF
-#line 5411 "configure"
+#line 5415 "configure"
 #include "confdefs.h"
 
          #include <aalib.h>
@@ -5417,7 +5421,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5421: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5425: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         video_aalib=yes
@@ -5468,10 +5472,10 @@ CheckOpenGL()
 {
     if test x$enable_video = xyes -a x$enable_video_opengl = xyes; then
         echo $ac_n "checking for OpenGL (GLX) support""... $ac_c" 1>&6
-echo "configure:5472: checking for OpenGL (GLX) support" >&5
+echo "configure:5476: checking for OpenGL (GLX) support" >&5
         video_opengl=no
         cat > conftest.$ac_ext <<EOF
-#line 5475 "configure"
+#line 5479 "configure"
 #include "confdefs.h"
 
          #include <GL/gl.h>
@@ -5483,7 +5487,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5487: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5491: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         video_opengl=yes
@@ -5497,7 +5501,7 @@ rm -f conftest*
         if test x$video_opengl = xyes; then
             CFLAGS="$CFLAGS -DHAVE_OPENGL"
             echo $ac_n "checking for dlopen in -ldl""... $ac_c" 1>&6
-echo "configure:5501: checking for dlopen in -ldl" >&5
+echo "configure:5505: checking for dlopen in -ldl" >&5
 ac_lib_var=`echo dl'_'dlopen | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -5505,7 +5509,7 @@ else
   ac_save_LIBS="$LIBS"
 LIBS="-ldl  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 5509 "configure"
+#line 5513 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 /* We use char because int might match the return type of a gcc2
@@ -5516,7 +5520,7 @@ int main() {
 dlopen()
 ; return 0; }
 EOF
-if { (eval echo configure:5520: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:5524: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -5571,10 +5575,10 @@ fi
 
     if test x$enable_input_events = xyes; then
         echo $ac_n "checking for Linux 2.4 unified input interface""... $ac_c" 1>&6
-echo "configure:5575: checking for Linux 2.4 unified input interface" >&5
+echo "configure:5579: checking for Linux 2.4 unified input interface" >&5
         use_input_events=no
         cat > conftest.$ac_ext <<EOF
-#line 5578 "configure"
+#line 5582 "configure"
 #include "confdefs.h"
 
           #include <linux/input.h>
@@ -5587,7 +5591,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5591: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5595: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         use_input_events=yes
@@ -5673,10 +5677,10 @@ fi
     LIBS="$LIBS $pthread_lib"
     if test x$enable_threads = xyes -a x$enable_pthreads = xyes; then
         echo $ac_n "checking for pthreads""... $ac_c" 1>&6
-echo "configure:5677: checking for pthreads" >&5
+echo "configure:5681: checking for pthreads" >&5
         use_pthreads=no
         cat > conftest.$ac_ext <<EOF
-#line 5680 "configure"
+#line 5684 "configure"
 #include "confdefs.h"
 
          #include <pthread.h>
@@ -5688,7 +5692,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5692: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:5696: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   
         use_pthreads=yes
@@ -5706,10 +5710,10 @@ rm -f conftest*
 
             # Check to see if recursive mutexes are available
             echo $ac_n "checking for recursive mutexes""... $ac_c" 1>&6
-echo "configure:5710: checking for recursive mutexes" >&5
+echo "configure:5714: checking for recursive mutexes" >&5
             has_recursive_mutexes=no
             cat > conftest.$ac_ext <<EOF
-#line 5713 "configure"
+#line 5717 "configure"
 #include "confdefs.h"
 
               #include <pthread.h>
@@ -5725,7 +5729,7 @@ int main() {
             
 ; return 0; }
 EOF
-if { (eval echo configure:5729: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:5733: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   
             has_recursive_mutexes=yes
@@ -5750,10 +5754,10 @@ rm -f conftest*
             case "$target" in
                 *-*-linux*)
                     echo $ac_n "checking for broken glibc 2.0 pthreads""... $ac_c" 1>&6
-echo "configure:5754: checking for broken glibc 2.0 pthreads" >&5
+echo "configure:5758: checking for broken glibc 2.0 pthreads" >&5
                     glibc20_pthreads=no
                     cat > conftest.$ac_ext <<EOF
-#line 5757 "configure"
+#line 5761 "configure"
 #include "confdefs.h"
 
                       #include <features.h>
@@ -5768,7 +5772,7 @@ int main() {
                     
 ; return 0; }
 EOF
-if { (eval echo configure:5772: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5776: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
                     glibc20_pthreads=yes
@@ -5785,10 +5789,10 @@ rm -f conftest*
     LIBS="$ac_save_libs"
 
     echo $ac_n "checking whether semun is defined in /usr/include/sys/sem.h""... $ac_c" 1>&6
-echo "configure:5789: checking whether semun is defined in /usr/include/sys/sem.h" >&5
+echo "configure:5793: checking whether semun is defined in /usr/include/sys/sem.h" >&5
     have_semun=no
     cat > conftest.$ac_ext <<EOF
-#line 5792 "configure"
+#line 5796 "configure"
 #include "confdefs.h"
 
       #include <sys/types.h>
@@ -5800,7 +5804,7 @@ int main() {
     
 ; return 0; }
 EOF
-if { (eval echo configure:5804: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5808: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
     have_semun=yes
@@ -5841,10 +5845,10 @@ fi
 CheckWIN32()
 {
     echo $ac_n "checking Win32 compiler""... $ac_c" 1>&6
-echo "configure:5845: checking Win32 compiler" >&5
+echo "configure:5849: checking Win32 compiler" >&5
     have_win32_gcc=no
     cat > conftest.$ac_ext <<EOF
-#line 5848 "configure"
+#line 5852 "configure"
 #include "confdefs.h"
 
      #include <windows.h>
@@ -5854,7 +5858,7 @@ int main() {
     
 ; return 0; }
 EOF
-if { (eval echo configure:5858: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5862: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
     have_win32_gcc=yes
@@ -5896,10 +5900,10 @@ fi
 
     if test x$enable_directx = xyes; then
         echo $ac_n "checking for DirectX headers and libraries""... $ac_c" 1>&6
-echo "configure:5900: checking for DirectX headers and libraries" >&5
+echo "configure:5904: checking for DirectX headers and libraries" >&5
         use_directx=no
         cat > conftest.$ac_ext <<EOF
-#line 5903 "configure"
+#line 5907 "configure"
 #include "confdefs.h"
 
          #include "src/video/windx5/directx.h"
@@ -5909,7 +5913,7 @@ int main() {
         
 ; return 0; }
 EOF
-if { (eval echo configure:5913: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:5917: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   
         use_directx=yes
@@ -6889,8 +6893,14 @@ __EOF__
   cat >>$new <$old
 
         fi
+	if test x$enable_openbsdaudio = xyes; then
         # OpenBSD does not define "unix"
-        CFLAGS="$CFLAGS -Dunix"
+	    CFLAGS="$CFLAGS -Dunix"
+	fi
+	# OpenBSD needs linking with ossaudio emulation library
+	if test x$enable_oss = xyes; then
+	    LIBS="$LIBS -lossaudio"
+	fi
         ;;
     *-*-sysv5*)
         ARCH=sysv5
@@ -8897,7 +8907,7 @@ if test $ARCH = solaris; then
 fi
 
 if test $ARCH = openbsd; then
-  SDL_RLD_FLAGS="-L${X11BASE}/lib -Wl,-rpath,\${exec_prefix}/lib -Wl,-rpath,${X11BASE}/lib"
+  SDL_RLD_FLAGS="-Wl,-rpath,${X11BASE}/lib"
 fi
 
 if test x$enable_video = xtrue; then

$OpenBSD: patch-src_iconloader_qticonloader_cpp,v 1.2 2011/03/19 14:38:44 rpointel Exp $

Use the gnome icon theme unconditionally: fixes a problem with minitube
GUI not having icons under fvwm/cwm/kde3/...

--- src/iconloader/qticonloader.cpp.orig	Thu Mar 17 00:07:11 2011
+++ src/iconloader/qticonloader.cpp	Thu Mar 17 18:31:40 2011
@@ -104,7 +104,6 @@ Q_GLOBAL_STATIC(QtIconLoaderImplementation, iconLoader
     QIcon icon;
 
 #ifdef Q_WS_X11
-#if QT_VERSION < 0x040600
     QString pngExtension(QLatin1String(".png"));
     QList<int> iconSizes;
     iconSizes << 16 << 22 << 24 << 32 << 48;
@@ -112,9 +111,6 @@ Q_GLOBAL_STATIC(QtIconLoaderImplementation, iconLoader
         icon.addPixmap(iconLoaderInstance()->findIcon(size, name));
     }
 #else
-    icon = QIcon::fromTheme(name);
-#endif
-#else
         icon = QIcon(QString(":/images/%1.png").arg(name));
         if (!icon.isNull()) {
             icon.addPixmap(QString(":/images/%1_active.png").arg(name), QIcon::Active);
@@ -183,6 +179,10 @@ void QtIconLoaderImplementation::lookupIconTheme() con
     
     dataDirs.prepend(QDir::homePath() + QLatin1String("/:"));
     iconDirs = dataDirs.split(QLatin1Char(':'));
+    
+    if (themeName.isEmpty())
+        themeName = QLatin1String("gnome");
+    return;
     
     // If we are running GNOME we resolve and use GConf. In all other
     // cases we currently use the KDE icon theme

$OpenBSD: patch-ext_pdf_config_m4,v 1.2 2002/07/09 18:14:17 avsm Exp $
--- ext/pdf/config.m4.orig	Mon Dec  3 23:54:09 2001
+++ ext/pdf/config.m4	Mon Jul  8 21:17:07 2002
@@ -5,9 +5,23 @@ dnl
 PHP_ARG_WITH(pdflib,for PDFlib support,
 [  --with-pdflib[=DIR]     Include PDFlib support.])
 
+pdflib_ext_shared=$ext_shared
+
+PHP_ARG_WITH(jpeg-dir, for the location of libjpeg,
+[  --with-jpeg-dir[=DIR]     PDFLIB: define libjpeg install directory.
+                                     (OPTIONAL for PDFlib v4)])
+
+PHP_ARG_WITH(png-dir, for the location of libpng,
+[  --with-png-dir[=DIR]      PDFLIB: define libpng install directory.
+                                     (OPTIONAL for PDFlib v4)])
+
+PHP_ARG_WITH(tiff-dir, for the location of libtiff,
+[  --with-tiff-dir[=DIR]     PDFLIB: define libtiff install directory.
+                                     (OPTIONAL for PDFlib v4)])
+
 if test "$PHP_PDFLIB" != "no"; then
 
-  PHP_EXTENSION(pdf, $ext_shared)
+  PHP_EXTENSION(pdf, $pdflib_ext_shared)
   PHP_SUBST(PDFLIB_SHARED_LIBADD)
 
   dnl #
@@ -16,9 +30,6 @@ if test "$PHP_PDFLIB" != "no"; then
 
   dnl # libjpeg
     
-  PHP_ARG_WITH(jpeg-dir, for the location of libjpeg, 
-  [  --with-jpeg-dir[=DIR]     PDFLIB: define libjpeg install directory. (OPTIONAL for PDFlib v4)])
-
   if test "$PHP_JPEG_DIR" != "no"; then
     PHP_CHECK_LIBRARY(jpeg,jpeg_read_header, 
     [
@@ -34,9 +45,6 @@ if test "$PHP_PDFLIB" != "no"; then
 
   dnl # libpng
 
-  PHP_ARG_WITH(png-dir, for the location of libpng, 
-  [  --with-png-dir[=DIR]      PDFLIB: define libpng install directory.  (OPTIONAL for PDFlib v4)])
- 
   if test "$PHP_PNG_DIR" != "no"; then
     PHP_CHECK_LIBRARY(png,png_create_info_struct, 
     [
@@ -52,9 +60,6 @@ if test "$PHP_PDFLIB" != "no"; then
 
   dnl # libtiff
 
-  PHP_ARG_WITH(tiff-dir, for the location of libtiff,
-  [  --with-tiff-dir[=DIR]     PDFLIB: define libtiff install directory. (OPTIONAL for PDFlib v4)])
-
   if test "$PHP_TIFF_DIR" != "no"; then
     PHP_CHECK_LIBRARY(tiff,TIFFOpen, 
     [
@@ -111,7 +116,7 @@ Use the options --with-tiff-dir=<DIR>, -
 See config.log for more information.
 ])
         ],[
-          -L$PHP_PDFLIB/lib
+          -L$PHP_PDFLIB/lib $PDFLIB_SHARED_LIBADD
         ])
       else
         AC_MSG_ERROR([pdflib.h not found! Check the path passed to --with-pdflib=<PATH>. PATH should be the install prefix directory.])

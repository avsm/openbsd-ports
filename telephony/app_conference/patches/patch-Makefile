$OpenBSD: patch-Makefile,v 1.3 2007/09/06 12:31:31 sthen Exp $
--- Makefile.orig	Tue Jul 10 00:58:58 2007
+++ Makefile	Tue Jul 10 01:09:01 2007
@@ -18,8 +18,8 @@
 #
 
 INSTALL_PREFIX :=
-INSTALL_MODULES_DIR := $(INSTALL_PREFIX)/usr/lib/asterisk/modules
-INSTALL_SOUNDS_DIR := $(INSTALL_PREFIX)/var/lib/asterisk/sounds
+INSTALL_MODULES_DIR := $(PREFIX)/lib/asterisk/modules
+INSTALL_SOUNDS_DIR := $(PREFIX)/share/asterisk/sounds
 
 ASTERISK_INCLUDE_DIR ?= ../asterisk/include
 
@@ -47,7 +47,7 @@ INSTALL = install
 INCLUDE = -I$(ASTERISK_INCLUDE_DIR)
 DEBUG := -g
 
-CFLAGS = -pipe -Wall -Wmissing-prototypes -Wmissing-declarations -MD -MP $(DEBUG)
+CFLAGS += -fPIC -pipe -Wall -Wmissing-prototypes -Wmissing-declarations -MD -MP
 CPPFLAGS = $(INCLUDE) -D_REENTRANT -D_GNU_SOURCE
 #CFLAGS += -O2
 #CFLAGS += -O3 -march=pentium3 -msse -mfpmath=sse,387 -ffast-math
@@ -59,8 +59,8 @@ CPPFLAGS = $(INCLUDE) -D_REENTRANT -D_GNU_SOURCE
 # adding -msse -mfpmath=sse has little effect.
 #CFLAGS += -O3 -msse -mfpmath=sse
 #CFLAGS += $(shell if $(CC) -march=$(PROC) -S -o /dev/null -xc /dev/null >/dev/null 2>&1; then echo "-march=$(PROC)"; fi)
-CFLAGS += $(shell if uname -m | grep -q ppc; then echo "-fsigned-char"; fi)
-CPPFLAGS += -DCRYPTO
+#CFLAGS += $(shell if uname -m | grep -q ppc; then echo "-fsigned-char"; fi)
+#CPPFLAGS += -DCRYPTO
 
 #
 # Uncomment this if you want G.729A support (need to have the actual codec installed
@@ -89,7 +89,7 @@ OSARCH=$(shell uname -s)
 ifeq (${OSARCH},Darwin)
 SOLINK=-dynamic -bundle -undefined suppress -force_flat_namespace
 else
-SOLINK=-shared -Xlinker -x
+SOLINK=-shared -fPIC -Xlinker -x
 endif
 
 DEPS += $(subst .o,.d,$(OBJS))
@@ -109,7 +109,7 @@ distclean: clean
 	$(RM) $(TARGET)
 
 $(TARGET): $(OBJS)
-	$(CC) -pg $(SOLINK) -o $@ $(OBJS)
+	$(CC) $(SOLINK) -o $@ $(OBJS)
 
 vad_test: vad_test.o libspeex/preprocess.o libspeex/misc.o libspeex/smallft.o
 	$(CC) $(PROFILE) -o $@ $^ -lm

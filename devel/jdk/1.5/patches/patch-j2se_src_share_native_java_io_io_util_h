$OpenBSD: patch-j2se_src_share_native_java_io_io_util_h,v 1.1 2006/11/17 20:19:33 kurt Exp $
--- j2se/src/share/native/java/io/io_util.h.orig	Tue Oct 19 14:59:57 2004
+++ j2se/src/share/native/java/io/io_util.h	Wed Nov 15 13:49:33 2006
@@ -11,7 +11,15 @@
 extern jfieldID IO_fd_fdID;
 extern jfieldID IO_handle_fdID;
 
-#if !defined(O_DSYNC) || !defined(O_SYNC)
+#ifdef _ALLBSD_SOURCE
+#include <fcntl.h>
+#ifndef O_SYNC
+#define O_SYNC  O_FSYNC
+#endif
+#ifndef O_DSYNC
+#define O_DSYNC O_FSYNC
+#endif
+#elif !defined(O_DSYNC) || !defined(O_SYNC)
 #define O_SYNC  (0x0800)
 #define O_DSYNC (0x2000)
 #endif

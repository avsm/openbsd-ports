diff -cr STk-3.1/Makefile.in STk-3.1.new/Makefile.in
*** STk-3.1/Makefile.in	Wed Jul 24 12:53:04 1996
--- STk-3.1.new/Makefile.in	Tue Sep 17 15:26:07 1996
***************
*** 73,79 ****
  	@echo "SH_LDFLAGS	= @SH_LDFLAGS@"			>> config.make
  	@echo "SH_LOADER	= @SH_LOADER@"			>> config.make
  	@echo "SH_SUFFIX	= @SH_SUFFIX@"			>> config.make
! 	@echo "LIB_MALLOC	= @LIB_MALLOC@"			>> config.make
  	@echo "LIB_DLD		= @LIB_DLD@"			>> config.make
  		
  	@echo "STK_LIBRARY	= $(libdir)"			>> config.make
--- 73,79 ----
  	@echo "SH_LDFLAGS	= @SH_LDFLAGS@"			>> config.make
  	@echo "SH_LOADER	= @SH_LOADER@"			>> config.make
  	@echo "SH_SUFFIX	= @SH_SUFFIX@"			>> config.make
! 	@echo "LIB_MALLOC	= "				>> config.make
  	@echo "LIB_DLD		= @LIB_DLD@"			>> config.make
  		
  	@echo "STK_LIBRARY	= $(libdir)"			>> config.make
***************
*** 108,114 ****
  demos:
  	/bin/sh -c "(cd Demos; ../Src/test-stk -f hbrowse README.html)"
  
! install: clean-before
  	(cd Tcl;     	$(MAKE) install)
  	(cd Tk;      	$(MAKE) install)
  	(cd Mp;		$(MAKE) install)
--- 108,114 ----
  demos:
  	/bin/sh -c "(cd Demos; ../Src/test-stk -f hbrowse README.html)"
  
! install:
  	(cd Tcl;     	$(MAKE) install)
  	(cd Tk;      	$(MAKE) install)
  	(cd Mp;		$(MAKE) install)
diff -cr STk-3.1/Snow/io.c STk-3.1.new/Snow/io.c
*** STk-3.1/Snow/io.c	Sun Jul 21 03:54:35 1996
--- STk-3.1.new/Snow/io.c	Tue Sep 17 15:25:42 1996
***************
*** 90,96 ****
        if (Tk_initialized) {
  	filled = 0;
  	while (!filled) {
! 	  Tcl_DoOneEvent(TK_DONT_WAIT);
  	  if (Tk_GetNumMainWindows() <= 0) return EOF;
  	}
        }
--- 90,96 ----
        if (Tk_initialized) {
  	filled = 0;
  	while (!filled) {
! 	  Tcl_DoOneEvent(0);
  	  if (Tk_GetNumMainWindows() <= 0) return EOF;
  	}
        }
diff -cr STk-3.1/Src/io.c STk-3.1.new/Src/io.c
*** STk-3.1/Src/io.c	Sun Jul 21 03:54:35 1996
--- STk-3.1.new/Src/io.c	Tue Sep 17 15:25:42 1996
***************
*** 90,96 ****
        if (Tk_initialized) {
  	filled = 0;
  	while (!filled) {
! 	  Tcl_DoOneEvent(TK_DONT_WAIT);
  	  if (Tk_GetNumMainWindows() <= 0) return EOF;
  	}
        }
--- 90,96 ----
        if (Tk_initialized) {
  	filled = 0;
  	while (!filled) {
! 	  Tcl_DoOneEvent(0);
  	  if (Tk_GetNumMainWindows() <= 0) return EOF;
  	}
        }
*** STk-3.1/Lib/Makefile	Mon Jul 22 06:50:06 1996
--- STk-3.1.new/Lib/Makefile	Tue Sep 17 15:36:07 1996
***************
*** 18,24 ****
  	-if [ ! -d $(SITE_SCHEME) ] ; then mkdir -p $(SITE_SCHEME); fi
  	-if [ ! -d $(STK_IMAGES) ] ; then mkdir -p $(STK_IMAGES); fi
  	-if [ ! -d $(STK_STK) ] ; then mkdir -p $(STK_STK); fi
! 	for i in *.stk *.stklos prolog.ps STk.init; \
  	do \
  	  sed -e 's=/usr/local/lib/stk=$(libdir)=' \
  	      -e 's=/usr/local/bin=$(bindir)=' $$i > $(STK_STK)/$$i ;\
--- 18,24 ----
  	-if [ ! -d $(SITE_SCHEME) ] ; then mkdir -p $(SITE_SCHEME); fi
  	-if [ ! -d $(STK_IMAGES) ] ; then mkdir -p $(STK_IMAGES); fi
  	-if [ ! -d $(STK_STK) ] ; then mkdir -p $(STK_STK); fi
! 	for i in *.stk prolog.ps STk.init; \
  	do \
  	  sed -e 's=/usr/local/lib/stk=$(libdir)=' \
  	      -e 's=/usr/local/bin=$(bindir)=' $$i > $(STK_STK)/$$i ;\
*** STk-3.1/Tk/unix/Makefile.in	Tue Sep 17 15:47:29 1996
--- STk-3.1.new/Tk/unix/Makefile.in	Tue Sep 17 15:57:13 1996
***************
*** 75,86 ****
  # X11 include files accessible (the configure script will try to
  # set this value, and will cause it to be an empty string if the
  # include files are accessible via /usr/include).
! X11_INCLUDES =		@XINCLUDES@
  
  # Linker switch(es) to use to link with the X11 library archive (the
  # configure script will try to set this value automatically, but you
  # can override it).
! X11_LIB_SWITCHES =	@XLIBSW@
  
  # Libraries to use when linking:  must include at least Tk, Tcl, Xlib,
  # and the math library (in that order).  The "LIBS" part will be
--- 75,86 ----
  # X11 include files accessible (the configure script will try to
  # set this value, and will cause it to be an empty string if the
  # include files are accessible via /usr/include).
! X11_INCLUDES =		-I/usr/X11R6/include/
  
  # Linker switch(es) to use to link with the X11 library archive (the
  # configure script will try to set this value automatically, but you
  # can override it).
! X11_LIB_SWITCHES =	-L/usr/X11R6/lib/
  
  # Libraries to use when linking:  must include at least Tk, Tcl, Xlib,
  # and the math library (in that order).  The "LIBS" part will be
***************
*** 188,196 ****
  CC =		@CC@
  CC_SWITCHES =	$(STKCFLAGS) $(DFLGS) $(ALLOC) ${CFLAGS} -I${UNIX_DIR} \
  		-I${GENERIC_DIR} \
! 		-I../../Tcl -I../../Src -I${BMAP_DIR} -I${TCL_DIR} \
  		${AC_FLAGS} ${PROTO_FLAGS} ${SECURITY_FLAGS} ${MEM_DEBUG_FLAGS} \
! 		${KEYSYM_FLAGS} 
  
  WISH_OBJS = tkAppInit.o
  
--- 188,196 ----
  CC =		@CC@
  CC_SWITCHES =	$(STKCFLAGS) $(DFLGS) $(ALLOC) ${CFLAGS} -I${UNIX_DIR} \
  		-I${GENERIC_DIR} \
! 		-I../../Tcl -I../../Src -I${BMAP_DIR} -I${TCLDIR} \
  		${AC_FLAGS} ${PROTO_FLAGS} ${SECURITY_FLAGS} ${MEM_DEBUG_FLAGS} \
! 		${KEYSYM_FLAGS} ${X11_INCLUDES}
  
  WISH_OBJS = tkAppInit.o
  
***************
*** 285,291 ****
  
  test: tktest
  	@cwd=`pwd`; \
! 	cd $(TCL_DIR); TCL_LIBRARY=`pwd`/../library; export TCL_LIBRARY; \
  	cd $$cwd; cd $(TOP_DIR); TK_LIBRARY=`pwd`/library; export TK_LIBRARY; \
  	cd $$cwd; ( echo cd $(TOP_DIR)/tests\; source all\; exit ) | ./tktest
  
--- 285,291 ----
  
  test: tktest
  	@cwd=`pwd`; \
! 	cd $(TCLDIR); TCL_LIBRARY=`pwd`/../library; export TCL_LIBRARY; \
  	cd $$cwd; cd $(TOP_DIR); TK_LIBRARY=`pwd`/library; export TK_LIBRARY; \
  	cd $$cwd; ( echo cd $(TOP_DIR)/tests\; source all\; exit ) | ./tktest
  

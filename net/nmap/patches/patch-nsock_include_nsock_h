$OpenBSD: patch-nsock_include_nsock_h,v 1.3 2008/09/17 18:09:54 kili Exp $
--- nsock/include/nsock.h.orig	Mon Jul 14 21:37:26 2008
+++ nsock/include/nsock.h	Thu Sep 11 15:32:16 2008
@@ -79,6 +79,8 @@
 extern "C" {
 #endif
 
+#include <pcap.h>
+
 /* The read calls will generally return after reading at least this
  * much data so that the caller can process it and so that the
  * connection spewing data doesn't monopolize resources.  The caller
@@ -523,7 +525,7 @@ nsock_event_id nsock_pcap_read_packet(nsock_pool nsp, 
 void nse_readpcap(nsock_event nsee,
 	const unsigned char **l2_data, size_t *l2_len,
 	const unsigned char **l3_data, size_t *l3_len,
-	size_t *packet_len, struct timeval *ts); 
+	size_t *packet_len, struct bpf_timeval *ts); 
 
 /* Well. Just pcap-style datalink. Like DLT_EN10MB or DLT_SLIP. Check in pcap(3) manpage. */
 int nsi_pcap_linktype(nsock_iod nsiod);

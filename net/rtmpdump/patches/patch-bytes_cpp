$OpenBSD: patch-bytes_cpp,v 1.2 2009/04/29 00:51:23 sthen Exp $

- unbreak all big-endian arch (first hunk)
- unbreak strict alignment big-endian (second hunk)

--- bytes.cpp.orig	Fri Mar 20 11:32:48 2009
+++ bytes.cpp	Wed Apr 29 01:45:47 2009
@@ -28,10 +28,10 @@ void WriteNumber(char *data, double dVal)
 	uint64_t res;
 
 #if __FLOAT_WORD_ORDER == __BYTE_ORDER
+        uint64_t in  = *((uint64_t*)&dVal);
 #if __BYTE_ORDER == __BIG_ENDIAN
-	res = *((uint64_t*)&dVal);
+	res = in;
 #elif __BYTE_ORDER == __LITTLE_ENDIAN
-        uint64_t in  = *((uint64_t*)&dVal);
         res = __bswap_64(in);
 #endif
 #else
@@ -58,7 +58,9 @@ double ReadNumber(const char *data)
 {
 #if __FLOAT_WORD_ORDER == __BYTE_ORDER
 #if __BYTE_ORDER == __BIG_ENDIAN
-	return *((double *)data);
+	double val;
+	memcpy(&val, data, sizeof(double));
+	return val;
 #elif __BYTE_ORDER == __LITTLE_ENDIAN
 	uint64_t in  = *((uint64_t*)data);
 	uint64_t res = __bswap_64(in);

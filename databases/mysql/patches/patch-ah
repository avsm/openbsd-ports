--- sql/password.c.orig	Thu Feb 10 15:59:05 2000
+++ sql/password.c	Thu Feb 10 16:07:01 2000
@@ -163,6 +163,11 @@
   else
     extra=(char) (floor(rnd(&rand_st)*31));
   to=buff;
+
+  if (strlen(scrambled)!=strlen(to)) {
+         return 1;
+  }
+
   while (*scrambled)
   {
     if (*scrambled++ != (char) (*to++ ^ extra))

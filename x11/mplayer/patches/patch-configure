$OpenBSD: patch-configure,v 1.9 2002/06/04 11:26:17 espie Exp $
--- configure.orig	Mon May 13 22:52:10 2002
+++ configure	Sat May 18 23:16:51 2002
@@ -1538,7 +1538,7 @@ else
 fi
 echores "$_sys_soundcard"
 
-if test "$_sys_soundcard" != yes ; then
+if test "$_sys_soundcard" != yes -a "$_ossaudio" != no; then
 echocheck "soundcard.h"
 cat > $TMPC << EOF
 #include <soundcard.h>
@@ -2591,6 +2591,7 @@ if test "$_ossaudio" = yes ; then
   else
      if netbsd || openbsd ; then
        _def_ossaudio_devdsp='#define PATH_DEV_DSP "/dev/sound"'
+       _ld_arch="$_ld_arch -lossaudio"
      else
        _def_ossaudio_devdsp='#define PATH_DEV_DSP "/dev/dsp"'
      fi
@@ -2720,7 +2721,7 @@ echores "$_sgiaudio"
 
 
 echocheck "VCD support"
-if linux || bsdos || freebsd || netbsd || sunos ; then
+if linux || bsdos || freebsd || netbsd || openbsd || sunos ; then
   _inputmodules="vcd $_inputmodules"
   _def_vcd='#define HAVE_VCD 1'
   echores "ok"
@@ -2733,7 +2734,7 @@ fi
 echocheck "DVD support (libmpdvdkit)"
 if test "$_dvdkit" = auto ; then
  _dvdkit=no
- if linux || freebsd || netbsd ; then
+ if linux || freebsd || netbsd || openbsd; then
   test -f "./libmpdvdkit/Makefile" && _dvdkit=yes
  fi
 fi
@@ -3103,7 +3104,7 @@ EOF
   _iconv=no
   if freebsd ; then
     cc_check  -lm -lgiconv && _iconv=yes
-  elif bsdos ; then
+  elif bsdos || openbsd; then
     cc_check  -lm -liconv && _iconv=yes
   else
     cc_check -lm && _iconv=yes
@@ -3113,6 +3114,7 @@ if test "$_iconv" = yes ; then
   _def_iconv='#define USE_ICONV 1'
   freebsd && _ld_iconv='-lgiconv'
   bsdos && _ld_iconv='-liconv'
+  openbsd && _ld_iconv='-liconv'
 else
   _def_iconv='#undef USE_ICONV'
 fi
@@ -3614,7 +3616,6 @@ test "$_xanim" = yes && _ld_dl_dynamic='
 _ld_arch="$_ld_arch $_ld_pthread $_ld_dl $_ld_dl_dynamic"
 bsdos && _ld_arch="$_ld_arch -ldvd"
 if netbsd || openbsd ; then
-  _ld_arch="$_ld_arch -lossaudio"
   x86 && _ld_arch="$_ld_arch -li386"
 fi
 
@@ -3683,10 +3684,10 @@ cat > config.mak << EOF
 
 LANG = C
 TARGET_OS = $system_name
-prefix = $_prefix
-DATADIR = $_datadir
-CONFDIR = $_confdir
-LIBDIR = $_libdir
+prefix = \$(DESTDIR)$_prefix
+DATADIR = \$(DESTDIR)$_datadir
+CONFDIR = \$(DESTDIR)$_confdir
+LIBDIR = \$(DESTDIR)$_libdir
 #AR = ar
 CC = $_cc
 AWK = $_awk

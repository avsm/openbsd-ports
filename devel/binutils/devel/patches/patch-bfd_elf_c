$OpenBSD: patch-bfd_elf_c,v 1.1.1.1 2002/04/21 21:39:56 fgsch Exp $
--- bfd/elf.c.orig	Thu Feb 14 01:12:45 2002
+++ bfd/elf.c	Sun Apr  7 18:27:48 2002
@@ -5096,7 +5096,9 @@ _bfd_elf_get_symtab_upper_bound (abfd)
   Elf_Internal_Shdr *hdr = &elf_tdata (abfd)->symtab_hdr;
 
   symcount = hdr->sh_size / get_elf_backend_data (abfd)->s->sizeof_sym;
-  symtab_size = (symcount - 1 + 1) * (sizeof (asymbol *));
+  symtab_size = (symcount + 1) * (sizeof (asymbol *));
+  if (symtab_size > 0)
+    symtab_size -= sizeof (asymbol *);
 
   return symtab_size;
 }
@@ -5116,7 +5118,9 @@ _bfd_elf_get_dynamic_symtab_upper_bound 
     }
 
   symcount = hdr->sh_size / get_elf_backend_data (abfd)->s->sizeof_sym;
-  symtab_size = (symcount - 1 + 1) * (sizeof (asymbol *));
+  symtab_size = (symcount + 1) * (sizeof (asymbol *));
+  if (symtab_size > 0)
+    symtab_size -= sizeof (asymbol *);
 
   return symtab_size;
 }

--- rfc1524.c.orig	Sat Dec 12 03:07:15 1998
+++ rfc1524.c	Mon Jan 11 22:08:58 1999
@@ -436,7 +436,7 @@
   if (s[0] == '\0')
   {
     snprintf (s, l, "%s/muttXXXXXX", buf);
-    mktemp (s);
+    if (mkstemp (s) == -1) mutt_error("Can not open temporary file\n");
   }
   else
   {
@@ -447,7 +447,7 @@
     if ((period = strrchr (tmp, '.')) != NULL)
       *period = 0;
     snprintf (s, l, "%s/%s.XXXXXX", buf, tmp);
-    mktemp (s);
+    if (mkstemp (s) == -1) mutt_error("Can not open temporary file\n");
     if (period != NULL)
     {
       *period = '.';

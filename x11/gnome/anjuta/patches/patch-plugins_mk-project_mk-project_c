$OpenBSD: patch-plugins_mk-project_mk-project_c,v 1.1 2011/10/04 11:20:41 jasper Exp $

From fa547401997c3fecb1ef500d3b496ceeb413a0e2 Mon Sep 17 00:00:00 2001
From: Michael Biebl <biebl@debian.org>
Date: Mon, 03 Oct 2011 23:08:27 +0000
Subject: Fix format string vulnerability by using g_set_error_literal ()

--- plugins/mk-project/mk-project.c.orig	Wed Aug  3 15:28:44 2011
+++ plugins/mk-project/mk-project.c	Tue Oct  4 12:59:50 2011
@@ -486,10 +486,19 @@ project_load_makefile (MkpProject *project, GFile *fil
 	mkp_scanner_free (scanner);
 	if (!ok)
 	{
-		g_set_error (error, IANJUTA_PROJECT_ERROR,
+		if (err != NULL)
+		{
+			g_set_error_literal (error, IANJUTA_PROJECT_ERROR,
 						IANJUTA_PROJECT_ERROR_PROJECT_MALFORMED,
-						err == NULL ? _("Unable to parse make file") : err->message);
-		if (err != NULL) g_error_free (err);
+						err->message);
+			g_error_free (err);
+		}
+		else
+		{
+			g_set_error (error, IANJUTA_PROJECT_ERROR,
+						IANJUTA_PROJECT_ERROR_PROJECT_MALFORMED,
+						_("Unable to parse make file"));
+		}
 
 		return NULL;
 	}

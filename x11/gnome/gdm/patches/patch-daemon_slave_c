$OpenBSD: patch-daemon_slave_c,v 1.10 2008/11/25 18:27:39 ajacoutot Exp $
--- daemon/slave.c.orig	Wed Sep  3 20:36:08 2008
+++ daemon/slave.c	Tue Nov 25 17:18:20 2008
@@ -2843,7 +2843,7 @@ gdm_slave_greeter (void)
 
 		exec_command (LIBEXECDIR "/gdmlogin", NULL);
 
-		VE_IGNORE_EINTR (execl (LIBEXECDIR "/gdmlogin", LIBEXECDIR "/gdmlogin", NULL));
+		VE_IGNORE_EINTR (execl (LIBEXECDIR "/gdmlogin", LIBEXECDIR "/gdmlogin", (void *)NULL));
 
 		gdm_errorgui_error_box (d,
 			       GTK_MESSAGE_ERROR,
@@ -3571,6 +3571,7 @@ session_child_run (struct passwd *pwent,
 	GString *fullexec = NULL;
 	const char *shell = NULL;
 	const char *greeter;
+	const char *login;
 	gint result;
 	gchar **argv = NULL;
 
@@ -3790,8 +3791,7 @@ session_child_run (struct passwd *pwent,
 	if (setusercontext (NULL, pwent, pwent->pw_uid,
 			    LOGIN_SETLOGIN | LOGIN_SETPATH |
 			    LOGIN_SETPRIORITY | LOGIN_SETRESOURCES |
-			    LOGIN_SETUMASK | LOGIN_SETUSER |
-			    LOGIN_SETENV) < 0)
+			    LOGIN_SETUMASK | LOGIN_SETUSER) < 0)
 		gdm_child_exit (DISPLAY_REMANAGE,
 				_("%s: setusercontext () failed for %s. "
 				  "Aborting."), "session_child_run",

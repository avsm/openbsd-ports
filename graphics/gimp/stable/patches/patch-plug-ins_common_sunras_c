$OpenBSD: patch-plug-ins_common_sunras_c,v 1.1.2.1 2007/05/25 13:29:00 sturm Exp $
--- plug-ins/common/sunras.c.orig	Fri Nov 26 04:52:01 2004
+++ plug-ins/common/sunras.c	Fri May 25 14:58:39 2007
@@ -873,7 +873,7 @@ set_color_table (gint32           image_
   ncols = sunhdr->l_ras_maplength / 3;
   if (ncols <= 0) return;
 
-  for (j = 0; j < ncols; j++)
+  for (j = 0; j < MIN (ncols, 256); j++)
     {
       ColorMap[j*3]   = suncolmap[j];
       ColorMap[j*3+1] = suncolmap[j+ncols];

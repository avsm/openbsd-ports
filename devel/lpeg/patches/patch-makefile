$OpenBSD: patch-makefile,v 1.2 2010/05/06 20:57:35 jasper Exp $
--- makefile.orig	Sat Oct 11 22:21:05 2008
+++ makefile	Thu May  6 22:54:55 2010
@@ -1,13 +1,13 @@
-LUADIR = /usr/include/lua5.1/
+LUADIR = ${LOCALBASE}/include/
 
-COPT = -O2 -DNDEBUG
+COPT = -O2 -DNDEBUG -fPIC -shared
 
-CWARNS = -Wall -Wextra -pedantic \
+CWARNS = -Wall -pedantic \
         -Waggregate-return \
 	-Wbad-function-cast \
         -Wcast-align \
         -Wcast-qual \
-	-Wdeclaration-after-statement \
+# 	-Wdeclaration-after-statement \
 	-Wdisabled-optimization \
         -Wmissing-prototypes \
         -Wnested-externs \
@@ -17,12 +17,11 @@ CWARNS = -Wall -Wextra -pedantic \
 	-Wstrict-prototypes \
 	-Wundef \
         -Wwrite-strings \
-	#  -Wunreachable-code \
+#	-Wunreachable-code \
 
 
-CFLAGS = $(CWARNS) $(COPT) -ansi -I$(LUADIR)
+CFLAGS += $(CWARNS) $(COPT) -ansi -I$(LUADIR)
 DLLFLAGS = -shared
-CC = gcc
 
 lpeg.so: lpeg.o
 	$(CC) $(DLLFLAGS) lpeg.o -o lpeg.so

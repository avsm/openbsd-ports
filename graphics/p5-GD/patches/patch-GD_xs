$OpenBSD: patch-GD_xs,v 1.2 2005/10/21 10:29:17 fgsch Exp $
--- GD.xs.orig	Sat Jul 20 12:43:49 2002
+++ GD.xs	Thu Oct 20 20:41:29 2005
@@ -17,6 +17,7 @@
 #endif
 /* Copyright 1995 - 1998, Lincoln D. Stein.  See accompanying README file for
 	usage restrictions */
+#define gdFree free
 
 static int
 not_here(char *s)
@@ -339,7 +340,7 @@ static gdIOCtx* newDynamicCtx (char* dat
   ctx->ctx.getBuf = bufGetBuf;
   ctx->ctx.seek   = bufSeek;
   ctx->ctx.tell   = bufTell;
-  ctx->ctx.free   = bufFree;
+  ctx->ctx.gd_free   = bufFree;
   ctx->ctx.putC   = NULL;
   ctx->ctx.putBuf = NULL;
   return (gdIOCtx*)ctx;
@@ -392,7 +393,7 @@ gdnewFromPngData(packname="GD::Image", i
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromPngCtx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 	OUTPUT:
 	RETVAL
 
@@ -409,7 +410,7 @@ gdnewFromGdData(packname="GD::Image", im
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromGdCtx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 	OUTPUT:
 	RETVAL
 
@@ -426,7 +427,7 @@ gdnewFromGd2Data(packname="GD::Image", i
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromGd2Ctx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 	OUTPUT:
 	RETVAL
 
@@ -445,7 +446,7 @@ gdnewFromGifData(packname="GD::Image", i
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromGifCtx(ctx);
-        ctx->free(ctx);
+        ctx->gd_free(ctx);
 #else
     errormsg = perl_get_sv("@",0);
     sv_setpv(errormsg,"libgd was not built with gif support\n");
@@ -469,7 +470,7 @@ gdnewFromJpegData(packname="GD::Image", 
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromJpegCtx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 #else
         errormsg = perl_get_sv("@",0);
         sv_setpv(errormsg,"libgd was not built with jpeg support\n");
@@ -491,7 +492,7 @@ gdnewFromWBMPData(packname="GD::Image", 
 	data = SvPV(imageData,len);
         ctx = newDynamicCtx(data,len);
 	RETVAL = (GD__Image) gdImageCreateFromWBMPCtx(ctx);
-        (ctx->free)(ctx);
+        (ctx->gd_free)(ctx);
 	OUTPUT:
 	RETVAL
 
@@ -1351,7 +1352,7 @@ gdstringUp(image,font,x,y,s,color)
 	}
 
 void
-gdstringFT(image,fgcolor,fontname,ptsize,angle,x,y,string)
+gdstringTTF(image,fgcolor,fontname,ptsize,angle,x,y,string)
         SV *	        image
         int             fgcolor
 	char *          fontname
@@ -1376,7 +1377,7 @@ gdstringFT(image,fgcolor,fontname,ptsize
 	    img = NULL;
 	  }
 
-	  err = gdImageStringFT(img,brect,fgcolor,fontname,ptsize,angle,x,y,string);
+	  err = gdImageStringTTF(img,brect,fgcolor,fontname,ptsize,angle,x,y,string);
 	  if (err) {
 	    errormsg = perl_get_sv("@",0);
 	    if (errormsg != NULL)

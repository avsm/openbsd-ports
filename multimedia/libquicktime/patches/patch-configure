$OpenBSD: patch-configure,v 1.4 2006/01/08 23:48:37 jakemsr Exp $
--- configure.orig	Mon Jul 19 11:57:49 2004
+++ configure	Mon Aug  9 03:17:56 2004
@@ -19822,11 +19835,11 @@ ASFLAGS=
 
 
 
-COMMON_CFLAGS=" -finline-functions -Wall -Wno-unused -Winline"
+COMMON_CFLAGS="$CFLAGS -finline-functions -Wall -Wno-unused -Winline"
 PROFILE_CFLAGS=" -pg -fprofile-arcs -ftest-coverage"
 DEBUG_CFLAGS=" -g3"
 
-
+if test "x$OPTIMIZE" = "xyes"; then
 OPTIMIZE_CFLAGS="-O3"
 
 echo "$as_me:$LINENO: checking if $CC supports -funroll-all-loops flags" >&5
@@ -20069,6 +20082,7 @@ echo "${ECHO_T}$ac_cv_try_cflags_ok" >&6
     else
         :
     fi
+fi # OPTIMIZE = yes
 
 # -Wno-unused-variable -Wno-unused-parameter
 # -std=gnu99
@@ -20373,7 +20387,7 @@ fi
 rm -f conftest.$ac_objext conftest$ac_exeext conftest.$ac_ext
 if test "$ac_cv_search_pthread_create" = no; then
   for ac_lib in gthread pthread c_r; do
-    LIBS="-l$ac_lib  $ac_func_search_save_LIBS"
+    LIBS="-$ac_lib  $ac_func_search_save_LIBS"
     cat >conftest.$ac_ext <<_ACEOF
 #line $LINENO "configure"
 /* confdefs.h.  */
@@ -20409,7 +20423,7 @@ if { (eval echo "$as_me:$LINENO: \"$ac_l
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
-  ac_cv_search_pthread_create="-l$ac_lib"
+  ac_cv_search_pthread_create="-$ac_lib"
 break
 else
   echo "$as_me: failed program was:" >&5
@@ -23354,7 +23368,7 @@ fi;
     VORBIS_LIBS="-L$libdir"
   fi
 
-  VORBIS_LIBS="$VORBIS_LIBS -lvorbis -lm"
+  VORBIS_LIBS="$VORBIS_LIBS -lvorbis -logg -lm"
   VORBISFILE_LIBS="-lvorbisfile"
   VORBISENC_LIBS="-lvorbisenc"
 
@@ -23547,7 +23561,7 @@ if test "${ac_cv_lib_mp3lame_lame_decode
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lmp3lame  -lm -lvorbis $LIBS"
+LIBS="-lmp3lame  -lm -lvorbis -logg $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 #line $LINENO "configure"
 /* confdefs.h.  */
@@ -24448,6 +24462,7 @@ fi
   else
      PKG_CONFIG_MIN_VERSION=0.9.0
      if $PKG_CONFIG --atleast-pkgconfig-version $PKG_CONFIG_MIN_VERSION; then
+       if test X$with_ffmpeg_acl = Xyes ; then
         echo "$as_me:$LINENO: checking for avcodec_acl = $AVCODEC_REQUIRED" >&5
 echo $ECHO_N "checking for avcodec_acl = $AVCODEC_REQUIRED... $ECHO_C" >&6
 
@@ -24476,8 +24491,13 @@ echo "${ECHO_T}$AVCODEC_LIBS" >&6
 
         fi
 
+      else
+        echo "$as_me:$LINENO: result: yes" >&5
+        echo "${ECHO_T}yes" >&6
+        succeeded=yes
+        AVCODEC_LIBS="-lavcodec -lmp3lame -la52 -lvorbisenc -lvorbis -logg -lm -lz -pthread"
+      fi # ffmpeg_acl
 
-
      else
         echo "*** Your version of pkg-config is too old. You need version $PKG_CONFIG_MIN_VERSION or newer."
         echo "*** See http://www.freedesktop.org/software/pkgconfig"
@@ -24682,7 +24702,7 @@ fi
 
 # Set CPU specific compiler options
 
-if test "x$RPM_OPT_FLAGS" = "x" ; then
+if test "x$OPTIMIZE" = "xyes" ; then
     # detect Athlon CPU
     # the idea is to use -mcpu=athlon to get the important optimization
     # but keep -march=${host_cpu} from the command line. -march=i686

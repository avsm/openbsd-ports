$OpenBSD: patch-src_spawn-fcgi_c,v 1.3 2009/08/03 09:51:47 sthen Exp $

fix http://redmine.lighttpd.net/issues/2033, from upstream repo.

--- src/spawn-fcgi.c.orig	Wed Jul 29 21:59:15 2009
+++ src/spawn-fcgi.c	Wed Jul 29 21:59:23 2009
@@ -198,7 +198,7 @@ static int bind_socket(const char *addr, unsigned shor
 				return -1;
 			}
 
-			if (-1 == chmod(unixsocket, mode)) {
+			if (-1 != mode && -1 == chmod(unixsocket, mode)) {
 				fprintf(stderr, "spawn-fcgi: couldn't chmod socket: %s\n", strerror(errno));
 				close(fcgi_fd);
 				unlink(unixsocket);

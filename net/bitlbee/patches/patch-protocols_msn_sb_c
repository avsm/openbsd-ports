$OpenBSD: patch-protocols_msn_sb_c,v 1.4 2007/11/19 11:44:33 martynas Exp $
--- protocols/msn/sb.c.orig	Mon Aug 20 16:27:14 2007
+++ protocols/msn/sb.c	Mon Nov 19 13:39:01 2007
@@ -126,10 +126,11 @@ int msn_sb_sendmessage( struct msn_switchboard *sb, ch
 		
 		if( strcmp( text, TYPING_NOTIFICATION_MESSAGE ) != 0 )
 		{
-			buf = g_new0( char, sizeof( MSN_MESSAGE_HEADERS ) + strlen( text ) * 2 );
+			size_t buf_len = sizeof( MSN_MESSAGE_HEADERS ) + strlen( text ) * 2;
+			buf = g_new0( char, buf_len);
 			i = strlen( MSN_MESSAGE_HEADERS );
 			
-			strcpy( buf, MSN_MESSAGE_HEADERS );
+			strlcpy( buf, MSN_MESSAGE_HEADERS, buf_len );
 			for( j = 0; text[j]; j ++ )
 			{
 				if( text[j] == '\n' )
@@ -632,7 +633,7 @@ static int msn_sb_message( gpointer data, char *msg, i
 				}
 				else
 				{
-					strcpy( buf, "<< \x02""BitlBee\x02"" - Corrupted MSN filetransfer invitation message >>" );
+					strlcpy( buf, "<< \x02""BitlBee\x02"" - Corrupted MSN filetransfer invitation message >>", sizeof(buf) );
 				}
 				
 				if( name ) g_free( name );

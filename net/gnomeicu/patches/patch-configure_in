$OpenBSD: patch-configure_in,v 1.1 2001/09/20 00:38:20 naddy Exp $
--- configure.in.orig	Tue Feb 27 05:29:30 2001
+++ configure.in	Thu Sep 20 00:36:44 2001
@@ -230,6 +230,18 @@ AC_ARG_WITH(scary-eyeballs,
 ])
 
 AC_CHECK_HEADER([iconv.h], AC_DEFINE(HAVE_ICONV))
+AC_MSG_CHECKING([for iconv_open])
+AC_TRY_LINK([#include <iconv.h>],
+  [iconv_open("", "");], [AC_MSG_RESULT(yes)], [AC_MSG_RESULT(no)
+  AC_MSG_CHECKING([for iconv_open in -liconv])
+  save_LIBS="$LIBS"
+  LIBS="$LIBS -liconv"
+  dnl cannot use AC_CHECK_LIB because GNU libiconv uses other symbol names
+  AC_TRY_LINK([#include <iconv.h>],[iconv_open("", "");],
+    [AC_MSG_RESULT(yes)], [AC_MSG_RESULT(no)
+    LIBS=$save_LIBS]
+    AC_MSG_ERROR([no iconv library found]))
+])
 
 AC_OUTPUT(
 Makefile

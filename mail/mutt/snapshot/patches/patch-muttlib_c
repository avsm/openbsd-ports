$OpenBSD: patch-muttlib_c,v 1.1 2007/05/04 09:09:31 kili Exp $

--- muttlib.c.orig	Thu May  3 09:41:31 2007
+++ muttlib.c	Thu May  3 13:54:16 2007
@@ -536,7 +536,9 @@ char *mutt_gecos_name (char *dest, size_t destlen, str
   {
     if (dest[idx] == '&')
     {
-      memmove (&dest[idx + pwnl], &dest[idx + 1],
+      /* Don't move if destination is outside buffer. */
+      if (idx + pwnl < destlen)
+        memmove (&dest[idx + pwnl], &dest[idx + 1],
 	       MAX(destlen - idx - pwnl - 1, 0));
       memcpy (&dest[idx], pw->pw_name, MIN(destlen - idx - 1, pwnl));
       dest[idx] = toupper ((unsigned char) dest[idx]);

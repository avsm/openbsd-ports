$OpenBSD: patch-base_src_common_PtrArray_c,v 1.1 2003/05/23 13:22:14 todd Exp $
--- base/src/common/PtrArray.c.orig	Sat Mar 29 16:15:21 2003
+++ base/src/common/PtrArray.c	Thu May 22 17:46:42 2003
@@ -70,7 +70,7 @@ block_fetch(const ObVec* vec, uint32_t i
     if(((void**)ptr)[block_index] == 0 && h != 1)
     {
       uint32_t j;
-      ((void**)ptr)[block_index] = GC_MALLOC(sizeof(void*) * BLOCK_SIZE);
+      ((void**)ptr)[block_index] = malloc(sizeof(void*) * BLOCK_SIZE);
       for(j = 0; j != BLOCK_SIZE; j++)
         ((void***)ptr)[block_index][j] = 0;
     }
@@ -101,7 +101,7 @@ vec_MaybeGrow(ObVec *vec)
   if(vec->size == (1 << (L2BS * vec->height)))
   {
     uint32_t j;
-    const void** elem = GC_MALLOC(sizeof(void*) * BLOCK_SIZE);
+    const void** elem = malloc(sizeof(void*) * BLOCK_SIZE);
 
     for(j = 1; j != BLOCK_SIZE; j++)
       elem[j] = 0;
@@ -117,7 +117,7 @@ vvec_fetch(const ObVec* vec, uint32_t in
 {
   return block_fetch(vec, index, 0);
 }
-
+  
 void
 obvec_append(ObVec *vec, const void *vp)
 {
@@ -149,7 +149,7 @@ vec_sort_using(void *vec_ptr, int (*cmp)
     const uint32_t last_used   = vec_size(vec) % BLOCK_SIZE;
     const uint32_t total_blocks = full_blocks + (last_used ? 1 : 0);
 
-    uint32_t* leaf_index = GC_MALLOC_ATOMIC(sizeof(uint32_t) * total_blocks);
+    uint32_t* leaf_index = malloc(sizeof(uint32_t) * total_blocks);
 
     for(j = 0; j != total_blocks; j++)
       leaf_index[j] = 0;
@@ -336,7 +336,7 @@ init_vector(void *vec_ptr)
 StrVec *
 strvec_create(void)
 {
-  StrVec *vec = (StrVec *) GC_MALLOC(sizeof(StrVec));
+  StrVec *vec = (StrVec *) malloc(sizeof(StrVec));
 
   ser_init(vec, &StrVec_SerType, StrVec_SerType.ver);
   SER_MODIFIED(vec);
@@ -349,7 +349,7 @@ strvec_create(void)
 TnVec *
 tnvec_create(void)
 {
-  TnVec *vec = (TnVec *) GC_MALLOC(sizeof(TnVec));
+  TnVec *vec = (TnVec *) malloc(sizeof(TnVec));
 
   ser_init(vec, &TnVec_SerType, TnVec_SerType.ver);
   SER_MODIFIED(vec);
@@ -362,7 +362,7 @@ tnvec_create(void)
 ObVec *
 obvec_create()
 {
-  ObVec *vec = (ObVec *) GC_MALLOC(sizeof(ObVec));
+  ObVec *vec = (ObVec *) malloc(sizeof(ObVec));
 
   ser_init(vec, &ObVec_SerType, ObVec_SerType.ver);
   SER_MODIFIED(vec);
@@ -564,7 +564,7 @@ strvec_flatten(StrVec *vec)
 
   cumlen += 1;			/* for trailing null */
 
-  s = GC_MALLOC_ATOMIC(cumlen);
+  s = malloc(cumlen);
   cumlen = 0;
 
   for (i = 0; i < size; i++) {

$OpenBSD: patch-cleanup_c,v 1.1 2002/12/14 18:06:58 espie Exp $
--- cleanup.c.orig	Sat Dec 14 18:55:23 2002
+++ cleanup.c	Sat Dec 14 18:55:55 2002
@@ -43,6 +43,12 @@ void _exit_cleanup(int code, const char 
 	int ocode = code;
 	extern int keep_partial;
 	extern int log_got_error;
+	static int in_cleanup = 0;
+
+	/* forbid recursive calls */
+	if (in_cleanup)
+		return;
+	in_cleanup = 1;
 
 	signal(SIGUSR1, SIG_IGN);
 	signal(SIGUSR2, SIG_IGN);

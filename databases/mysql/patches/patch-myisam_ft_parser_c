$OpenBSD: patch-myisam_ft_parser_c,v 1.1 2004/10/20 04:47:29 brad Exp $
--- myisam/ft_parser.c.orig	Thu May 13 20:53:24 2004
+++ myisam/ft_parser.c	Tue Oct 19 22:15:59 2004
@@ -124,28 +124,31 @@ byte ft_get_word(byte **start, byte *end
     for (;doc<end;doc++)
     {
       if (true_word_char(*doc)) break;
-      if (*doc == FTB_RQUOT && param->quot) {
+      if (*doc == FTB_RQUOT && param->quot)
+      {
         param->quot=doc;
         *start=doc+1;
         return 3; /* FTB_RBR */
       }
-      if ((*doc == FTB_LBR || *doc == FTB_RBR || *doc == FTB_LQUOT)
-          && !param->quot)
+      if (!param->quot)
       {
-        /* param->prev=' '; */
-        *start=doc+1;
-        if (*doc == FTB_LQUOT) param->quot=*start;
-        return (*doc == FTB_RBR)+2;
+        if (*doc == FTB_LBR || *doc == FTB_RBR || *doc == FTB_LQUOT)
+        {
+          /* param->prev=' '; */
+          *start=doc+1;
+          if (*doc == FTB_LQUOT) param->quot=*start;
+          return (*doc == FTB_RBR)+2;
+        }
+        if (param->prev == ' ')
+        {
+          if (*doc == FTB_YES ) { param->yesno=+1;    continue; } else
+          if (*doc == FTB_EGAL) { param->yesno= 0;    continue; } else
+          if (*doc == FTB_NO  ) { param->yesno=-1;    continue; } else
+          if (*doc == FTB_INC ) { param->plusminus++; continue; } else
+          if (*doc == FTB_DEC ) { param->plusminus--; continue; } else
+          if (*doc == FTB_NEG ) { param->pmsign=!param->pmsign; continue; }
+        }
       }
-      if (param->prev == ' ' && !param->quot)
-      {
-        if (*doc == FTB_YES ) { param->yesno=+1;    continue; } else
-        if (*doc == FTB_EGAL) { param->yesno= 0;    continue; } else
-        if (*doc == FTB_NO  ) { param->yesno=-1;    continue; } else
-        if (*doc == FTB_INC ) { param->plusminus++; continue; } else
-        if (*doc == FTB_DEC ) { param->plusminus--; continue; } else
-        if (*doc == FTB_NEG ) { param->pmsign=!param->pmsign; continue; }
-      }
       param->prev=*doc;
       param->yesno=(FTB_YES==' ') ? 1 : (param->quot != 0);
       param->plusminus=param->pmsign=0;
@@ -169,6 +172,11 @@ byte ft_get_word(byte **start, byte *end
       *start=doc;
       return 1;
     }
+  }
+  if (param->quot)
+  {
+    param->quot=*start=doc;
+    return 3; /* FTB_RBR */
   }
   return 0;
 }

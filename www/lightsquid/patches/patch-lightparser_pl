$OpenBSD: patch-lightparser_pl,v 1.1.1.1 2009/05/08 22:03:57 sthen Exp $
--- lightparser.pl.orig	Fri Apr 17 16:18:08 2009
+++ lightparser.pl	Fri Apr 17 16:20:12 2009
@@ -246,10 +246,11 @@ while (<FF>) {
     $url =~ s/([a-z]+:\/\/)??.*\.(rapidshare\.com)/$1www.$2/o;
 
     #extract site name
-    $url =~ m/([a-z]+:\/\/)??([a-z0-9\-]+\.){1}(([a-z0-9\-]+\.){0,})([a-z0-9\-]+){1}(:[0-9]+)?\/(.*)/o;
-    $site=$2.$3.$5;
-    
-    $site=$Lurl if ($site eq "");
+    if ($url =~ m/([a-z]+:\/\/)??([a-z0-9\-]+\.){1}(([a-z0-9\-]+\.){0,})([a-z0-9\-]+){1}(:[0-9]+)?\/(.*)/o) {
+       $site=$2.$3.$5;
+    } else {
+       $site=$Lurl;
+    }
 
     $totalsize    {$user}       +=$Lsize;
     $totalhit     {$user}       ++;

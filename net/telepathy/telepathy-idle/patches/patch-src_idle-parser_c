$OpenBSD: patch-src_idle-parser_c,v 1.1.1.1 2007/10/27 16:18:54 jasper Exp $
--- src/idle-parser.c.orig	Fri Oct 12 22:13:36 2007
+++ src/idle-parser.c	Fri Oct 12 22:25:39 2007
@@ -195,7 +195,9 @@ void idle_parser_receive(IdleParser *parser, const gch
 
 	g_assert(msg != NULL);
 
-	len = strnlen(msg, IRC_MSG_MAXLEN + 3);
+	len = strlen(msg);
+	g_assert(len <= IRC_MSG_MAXLEN + 3);
+		
 
 	for (i = 0; i < len; i++) {
 		if ((msg[i] == '\n' || msg[i] == '\r')) {

$OpenBSD: patch-Makefile_in,v 1.3 2007/02/18 06:23:38 pvalchev Exp $
--- Makefile.in.orig	Sun Oct 16 20:25:28 2005
+++ Makefile.in	Sat Feb 17 22:20:59 2007
@@ -5,7 +5,7 @@ exec_prefix=@exec_prefix@
 bindir=@bindir@
 
 CC=@CC@
-CFLAGS=@CPPFLAGS@ @CFLAGS@ 
+CFLAGS=@CPPFLAGS@ @CFLAGS@ @DEFS@ -fPIC
 LIBS=@LIBS@
 LDFLAGS=@LDFLAGS@
 
@@ -15,7 +15,7 @@ MKLIBFLAGS=-linkall
 
 INSTALL=@INSTALL@
 
-all: bytecode opt docs
+all: bytecode docs
 
 docs:
 	if [ ! -d doc ]; then mkdir doc; fi
@@ -33,10 +33,9 @@ distclean: clean
 
 # install rebuilds sqlite3top to point to the findlib-managed dll and not the
 # one in . 
-install: sqlite3.cma sqlite3.cmxa sqlite3top
-	ocamlfind install sqlite3 META sqlite3.cmi sqlite3.mli sqlite3.cma *.cmxa *.a *.cmx *.so
-	ocamlfind ocamlmktop -o sqlite3top -package "sqlite3" sqlite3.cma
-	$(INSTALL) sqlite3top $(bindir)/sqlite3top
+install: sqlite3.cma sqlite3top
+	ocamlfind install sqlite3 META sqlite3.cmi sqlite3.mli sqlite3.cma -optional *.cmxa *.a *.cmx *.so
+	$(INSTALL) sqlite3top $(DESTDIR)$(bindir)/sqlite3top
 
 remove: uninstall
 uninstall:
@@ -48,7 +47,7 @@ update: sqlite3.cma
 	make install
 
 sqlite3top: sqlite3.cma
-	ocamlfind ocamlmktop -o sqlite3top sqlite3.cma
+	ocamlfind ocamlmktop -o sqlite3top libsqlite3.a sqlite3.cma
 
 sqlite3.cma: sqlite3.cmo sqlite3_stubs.o
 	ocamlmklib -o sqlite3 sqlite3.cmo sqlite3_stubs.o $(LDFLAGS) $(LIBS) $(MKLIBFLAGS)

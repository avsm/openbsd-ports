$OpenBSD: patch-configure_in,v 1.28 2008/08/20 16:35:15 brad Exp $
--- configure.in.orig	Fri Aug  8 15:21:03 2008
+++ configure.in	Fri Aug  8 22:44:09 2008
@@ -2293,18 +2293,6 @@ dnl during compile.
 		;;
 esac
 
-# Remove optimization for GCC 2.95.[123]
-# gcc -O[2] on *BSD and Linux (x86) causes pointers to magically become NULL
-if test "$GCC" = "yes"; then
-	GCCVER=`$CC -v 2>&1 | awk '$2 ==  "version" {print $3}'`
-	case "$GCCVER" in
-	[2.95.[123]])
-		echo "Removing -O for gcc on $host with GCC $GCCVER"
-		CFLAGS="`echo $CFLAGS | sed -e 's/-O[[0-9]]*//'`"
-		;;
-	esac
-fi
-
 # Recommended by Balint Nagy Endre <bne@CareNet.hu>
 case "$host" in
 	*-univel-sysv4.2MP)
@@ -2844,12 +2832,14 @@ AC_ARG_WITH(maxfd,
     ;;
   esac
 ])
+
+TLDFLAGS="$LDFLAGS"
+
 if test -z "$SQUID_MAXFD"; then
 
 dnl Not cached since people are likely to tune this
 AC_MSG_CHECKING(Maximum number of filedescriptors we can open)
 dnl damn! FreeBSD's pthreads breaks dup2().
-TLDFLAGS="$LDFLAGS"
 case $host in
 i386-unknown-freebsd*)
     if echo "$LDFLAGS" | grep -q pthread; then

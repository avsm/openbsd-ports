$OpenBSD: patch-configure,v 1.4 2008/06/17 13:54:09 ajacoutot Exp $
--- configure.orig	Fri Oct 19 08:22:39 2007
+++ configure	Tue Jun 17 15:52:24 2008
@@ -2163,7 +2163,7 @@ case "$target_cpu" in
    x86 | i686 | i586 | i486 | i386 ) MACHTYPE=x86
                    ;;
 
-   x86_64)	   MACHTYPE=x86_64 ;
+   x86_64|amd64)	   MACHTYPE=x86_64 ;
 		   P_64BIT=1 ;
                    LIB64=1 ;
 		   ;;
@@ -2175,6 +2175,11 @@ case "$target_cpu" in
    sparc )         MACHTYPE=sparc ;
 		   ;;
 
+   sparc64 )       MACHTYPE=sparc ;
+		   P_64BIT=1 ;
+                   LIB64=1 ;
+		   ;;
+
    powerpc )       MACHTYPE=ppc ;
 		   ;;
 
@@ -4683,13 +4688,13 @@ fi
 
 
 
-echo "$as_me:$LINENO: checking for pthread_create in -lpthread" >&5
-echo $ECHO_N "checking for pthread_create in -lpthread... $ECHO_C" >&6
+echo "$as_me:$LINENO: checking for pthread_create in -pthread" >&5
+echo $ECHO_N "checking for pthread_create in -pthread... $ECHO_C" >&6
 if test "${ac_cv_lib_pthread_pthread_create+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
+LIBS="-pthread  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -4754,8 +4759,12 @@ else
 fi
 
 if test ${HAS_PTHREADS} = yes ; then
-  ENDLDLIBS="$ENDLDLIBS -lpthread"
-  STDCCFLAGS="$STDCCFLAGS -D_REENTRANT"
+  if test ${OSTYPE} = OpenBSD ; then
+    ENDLDLIBS="$ENDLDLIBS -pthread"
+  else
+    ENDLDLIBS="$ENDLDLIBS -lpthread"
+  fi
+    STDCCFLAGS="$STDCCFLAGS -D_REENTRANT"
 else
   if test ${OSTYPE} = FreeBSD ; then
     HAS_PTHREADS=yes
@@ -4837,13 +4846,13 @@ _ACEOF
 echo "${ECHO_T}no" >&6
   fi
 
-  echo "$as_me:$LINENO: checking for sem_timedwait in -lpthread" >&5
-echo $ECHO_N "checking for sem_timedwait in -lpthread... $ECHO_C" >&6
+  echo "$as_me:$LINENO: checking for sem_timedwait in -pthread" >&5
+echo $ECHO_N "checking for sem_timedwait in -pthread... $ECHO_C" >&6
 if test "${ac_cv_lib_pthread_sem_timedwait+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
+LIBS="-pthread  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -5691,22 +5700,12 @@ fi
 
 
 
-if test "x$LIB64" != "x" ; then
-
 cat >>confdefs.h <<_ACEOF
-#define P_DEFAULT_PLUGIN_DIR "${INSTALLPREFIX}/lib64/pwlib"
-_ACEOF
-
-else
-
-cat >>confdefs.h <<_ACEOF
 #define P_DEFAULT_PLUGIN_DIR "${INSTALLPREFIX}/lib/pwlib"
 _ACEOF
 
-fi
 
 
-
 # Check whether --enable-resolver or --disable-resolver was given.
 if test "${enable_resolver+set}" = set; then
   enableval="$enable_resolver"
@@ -8189,7 +8188,7 @@ if test "${ac_cv_lib_SDL_SDL_CreateYUVOverlay+set}" = 
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lSDL -L${X11LIBDIR} -lpthread -lX11 -lXext $LIBS"
+LIBS="-lSDL -L${X11LIBDIR} -pthread -lX11 -lXext $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF

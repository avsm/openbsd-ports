$OpenBSD: patch-ntpq_ntpq_c,v 1.2.2.1 2009/06/28 02:42:41 william Exp $

Prevent a buffer overflow in ntpq.  (CVE-2009-0159)

--- ntpq/ntpq.c.orig	Mon Apr 20 17:24:34 2009
+++ ntpq/ntpq.c	Mon Apr 20 17:26:32 2009
@@ -3185,9 +3185,9 @@ cookedprint(
 				if (!decodeuint(value, &uval))
 				    output_raw = '?';
 				else {
-					char b[10];
+					char b[12];
 
-					(void) sprintf(b, "%03lo", uval);
+					(void) snprintf(b, sizeof(b), "%03lo", uval);
 					output(fp, name, b);
 				}
 				break;

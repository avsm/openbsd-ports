$OpenBSD: patch-configure_in,v 1.4 2007/12/20 22:54:28 kili Exp $
--- configure.in.orig	Wed Oct 31 09:06:02 2007
+++ configure.in	Sat Nov  3 11:09:13 2007
@@ -1102,10 +1102,10 @@ AC_ARG_WITH(libmng,  [  --without-libmng        build 
   if test "x$with_libmng" != xno && test -z "$LIBMNG" &&
      test -n "$LIBPNG" && test -n "$LIBJPEG" && test -n "$LIBZ"; then
     AC_CHECK_LIB(mng, mng_create,
-      [AC_CHECK_HEADER(libmng.h, mng_ok=yes)],
-      [have_libmng="no (MNG library not found)"], -lz -lm)
+      [AC_CHECK_HEADER(libmng.h, mng_ok=yes, $LIBJPEG -lz -lm -llcms)],
+      [have_libmng="no (MNG library not found)"], $LIBJPEG -lz -lm -llcms)
     if test "$mng_ok" = yes; then
-      MNG='mng$(EXEEXT)'; LIBMNG="-lmng $LIBJPEG $LIBPNG"
+      MNG='mng$(EXEEXT)'; LIBMNG="-lmng $LIBJPEG $LIBPNG -llcms"
     else
       have_libmng="no (MNG header file not found)"
     fi
@@ -1374,11 +1374,11 @@ if test "x$with_lcms" != xno; then
         have_lcms=yes
         AC_DEFINE(HAVE_LCMS_LCMS_H, 1,
           [Define to 1 if the lcms header must be included as lcms/lcms.h]))
-      ])
-  ])
+      ], ,-lm)
+  ], ,-lm)
   if test "x$have_lcms" = xyes; then
     AC_DEFINE(HAVE_LCMS, 1, [Define to 1 if lcms is available])
-    LIBLCMS="-llcms"
+    LIBLCMS="-lm -llcms"
     LCMS='lcms$(EXEEXT)'
   else
     have_lcms="no (lcms not found or unusable)"

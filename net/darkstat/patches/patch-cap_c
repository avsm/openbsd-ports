$OpenBSD: patch-cap_c,v 1.3 2007/02/12 17:38:03 ckuethe Exp $
--- cap.c.orig	Mon Feb 12 10:29:27 2007
+++ cap.c	Mon Feb 12 10:29:53 2007
@@ -43,7 +43,7 @@ static const linkhdr_t *linkhdr = NULL;
  * Init pcap.  Exits on failure.
  */
 void
-cap_init(const char *device, const char *filter)
+cap_init(const char *device, const char *filter, int promisc)
 {
    char errbuf[PCAP_ERRBUF_SIZE], *tmp_device;
    int linktype, caplen;
@@ -79,7 +79,7 @@ cap_init(const char *device, const char 
    pcap = pcap_open_live(
       tmp_device,
       caplen,      /* snaplen */
-      1,           /* promisc, FIXME */
+      promisc,           /* promisc */
       CAP_TIMEOUT,
       errbuf);
 
@@ -90,6 +90,11 @@ cap_init(const char *device, const char 
       warnx("pcap_open_live() warning: %s", errbuf);
 
    free(tmp_device);
+
+   if (promisc)
+      verbosef("capturing in promiscuous mode");
+   else
+      verbosef("capturing in non-promiscuous mode");
 
    /* Set filter expression, if any. */
    if (filter != NULL)

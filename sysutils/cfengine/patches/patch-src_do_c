$OpenBSD: patch-src_do_c,v 1.8 2009/04/25 22:07:37 okan Exp $
--- src/do.c.orig	Sat Dec  6 04:30:19 2008
+++ src/do.c	Sat Apr 11 16:32:57 2009
@@ -3399,7 +3399,7 @@ if (MatchStringInFstab(mountpt))
          CfLog(cfinform,"---------------------------------------------------","");
          
          /* delete current fstab entry and unmount if necessary */
-         snprintf(mountspec,CF_BUFSIZE,".+:%s",mountpt);
+         snprintf(mountspec,MAXPATHLEN,".+:%s",mountpt);
          mntentry = LocateItemContainingRegExp(VMOUNTED,mountspec);
          if (mntentry)
             {
@@ -3408,7 +3408,7 @@ if (MatchStringInFstab(mountpt))
             strcat(mountspec,mountpt);
             }
          else  /* mountpt isn't mounted, so Unmount can use dummy host name */
-             snprintf(mountspec,CF_BUFSIZE,"host:%s",mountpt);
+             snprintf(mountspec,MAXPATHLEN,"host:%s",mountpt);
          
          /* delete current fstab entry and unmount if necessary (don't rmdir) */
          cleaner.name        = mountspec;

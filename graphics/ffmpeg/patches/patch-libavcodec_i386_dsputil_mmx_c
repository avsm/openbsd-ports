$OpenBSD: patch-libavcodec_i386_dsputil_mmx_c,v 1.1 2008/01/26 01:56:02 jakemsr Exp $
--- libavcodec/i386/dsputil_mmx.c.orig	Mon Jan 21 01:28:41 2008
+++ libavcodec/i386/dsputil_mmx.c	Mon Jan 21 01:30:33 2008
@@ -3175,9 +3175,12 @@ void dsputil_init_mmx(DSPContext* c, AVCodecContext *a
 #ifdef CONFIG_ENCODERS
         const int dct_algo = avctx->dct_algo;
         if(dct_algo==FF_DCT_AUTO || dct_algo==FF_DCT_MMX){
+#ifdef ARCH_X86_64
             if(mm_flags & MM_SSE2){
                 c->fdct = ff_fdct_sse2;
-            }else if(mm_flags & MM_MMXEXT){
+            }else
+#endif
+            if(mm_flags & MM_MMXEXT){
                 c->fdct = ff_fdct_mmx2;
             }else{
                 c->fdct = ff_fdct_mmx;

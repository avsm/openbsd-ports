$OpenBSD: patch-eval_c,v 1.5 2009/03/07 12:30:17 bernd Exp $

Fix usage of short-named constants.

http://svn.ruby-lang.org/cgi-bin/viewvc.cgi?view=rev&revision=18485
http://svn.ruby-lang.org/cgi-bin/viewvc.cgi?view=rev&revision=22679
https://bugs.launchpad.net/ubuntu/+source/ruby1.8/+bug/282302

--- eval.c.orig	Mon Aug  4 05:16:55 2008
+++ eval.c	Mon Mar  2 13:18:59 2009
@@ -1066,7 +1066,7 @@ static VALUE ruby_wrapper;	/* security wrapper */
 
 NODE *ruby_cref = 0;
 NODE *ruby_top_cref;
-#define PUSH_CREF(c) ruby_cref = NEW_NODE(NODE_CREF,(c),0,ruby_cref)
+#define PUSH_CREF(c) ruby_cref = NEW_CREF(c,ruby_cref)
 #define POP_CREF() ruby_cref = ruby_cref->nd_next
 
 #define PUSH_SCOPE() do {		\
@@ -1399,7 +1399,7 @@ ruby_init()
 	rb_call_inits();
 	ruby_class = rb_cObject;
 	ruby_frame->self = ruby_top_self;
-	ruby_top_cref = rb_node_newnode(NODE_CREF,rb_cObject,0,0);
+	ruby_top_cref = NEW_CREF(rb_cObject, 0);
 	ruby_cref = ruby_top_cref;
 	rb_define_global_const("TOPLEVEL_BINDING", rb_f_binding(ruby_top_self));
 #ifdef __MACOS__

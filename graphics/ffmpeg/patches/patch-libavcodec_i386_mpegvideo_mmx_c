$OpenBSD: patch-libavcodec_i386_mpegvideo_mmx_c,v 1.1 2008/01/26 01:56:02 jakemsr Exp $
--- libavcodec/i386/mpegvideo_mmx.c.orig	Fri Dec 14 23:56:43 2007
+++ libavcodec/i386/mpegvideo_mmx.c	Mon Jan 21 11:00:22 2008
@@ -732,9 +732,12 @@ void MPV_common_init_mmx(MpegEncContext *s)
                 s->dct_quantize= dct_quantize_SSSE3;
             } else
 #endif
+#ifdef ARCH_X86_64
             if(mm_flags & MM_SSE2){
                 s->dct_quantize= dct_quantize_SSE2;
-            } else if(mm_flags & MM_MMXEXT){
+            } else
+#endif
+            if(mm_flags & MM_MMXEXT){
                 s->dct_quantize= dct_quantize_MMX2;
             } else {
                 s->dct_quantize= dct_quantize_MMX;

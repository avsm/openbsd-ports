$OpenBSD: patch-j2se_make_common_Release_gmk,v 1.1 2007/09/06 15:46:18 kurt Exp $
--- j2se/make/common/Release.gmk.orig	Thu Aug  2 03:45:44 2007
+++ j2se/make/common/Release.gmk	Fri Aug 10 21:36:11 2007
@@ -148,7 +148,7 @@ JRE_MAN_PAGES = \
 	pack200.1	      \
 	unpack200.1
 
-ifeq ($(ARCH_DATA_MODEL),32)
+ifeq ($(BUILD_DEPLOY), true)
   JRE_MAN_PAGES += javaws.1
 endif
 
@@ -158,7 +158,6 @@ endif
 JDK_MAN_PAGES = \
 	$(JRE_MAN_PAGES) \
 	appletviewer.1 \
-  apt.1 \
 	extcheck.1 \
 	idlj.1 \
 	jar.1 \
@@ -199,7 +198,19 @@ ifeq ($(PLATFORM), linux)
   DEST_MAN_PATH = man/man1
 endif
 
+ifeq ($(PLATFORM), bsd)
+  MANDIR=$(TOPDIR)/src/bsd/doc/man
+  JA_MANDIR=$(TOPDIR)/src/bsd/doc/man
+  DEST_MAN_PATH = man/man1
+endif
 
+ifeq ($(OS_VENDOR), OpenBSD)
+  FILES_FROM_ARG=-I
+else
+  FILES_FROM_ARG=-T
+endif
+
+
 #
 # Targets.
 #
@@ -789,7 +800,7 @@ else # Not windows
 	@#
 	@# Add Japanese manpages
 	@#
-  ifeq ($(PLATFORM), linux)
+  ifneq (,$(findstring $(PLATFORM), linux bsd))
 	for manpage in $(JRE_MAN_PAGES); do \
 	    for encoding in $(JA_TARGET_ENCODINGS); do \
 		MAN_DEST_PATH=$(JRE_IMAGE_DIR)/man/ja; \
@@ -1013,7 +1024,7 @@ initial-image-jdk:: initial-image-jdk-setup \
 	@# generated by the more efficient solaris/windows method of copying files.
 	@# So for Linux, make use of the -T option (like Solaris' -I option) of
 	@# obtaining the list of files from a file. MKS tar has no such option.
-  ifeq ($(PLATFORM), linux)
+  ifneq (,$(findstring $(PLATFORM), linux bsd))
 	for d in $(SOURCE_DIRS); do \
 	  $(RM) $(ABS_TEMPDIR)/src-files.list; \
 	  ($(CD) $$d;  \
@@ -1026,7 +1037,7 @@ initial-image-jdk:: initial-image-jdk-setup \
 	    done ; \
 	  ) ; \
 	  if [ -f  $(ABS_TEMPDIR)/src-files.list ] ; then \
-	    ($(CD) $$d; $(TAR) cf - -T $(ABS_TEMPDIR)/src-files.list ) \
+	    ($(CD) $$d; $(TAR) cf - $(FILES_FROM_ARG) $(ABS_TEMPDIR)/src-files.list ) \
 	       | ($(CD) $(JDK_IMAGE_DIR)/src; $(TAR) xf -); \
 	  fi; \
 	done
@@ -1100,7 +1111,7 @@ initial-image-jdk:: initial-image-jdk-setup \
 	@#
 	@# Add Japanese manpages for Solaris
 	@#
-    ifeq ($(PLATFORM), linux)
+    ifneq (,$(findstring $(PLATFORM), linux bsd))
 	for manpage in $(JDK_MAN_PAGES); do \
 	    for encoding in $(JA_TARGET_ENCODINGS); do \
 		MAN_DEST_PATH=$(JDK_IMAGE_DIR)/man/ja; \

$OpenBSD: patch-dnstop_c,v 1.2 2009/08/26 08:36:03 sthen Exp $

ns_r_refused comes from /usr/include/arpa/nameser.h on systems using
bind 9-based resolvers; REFUSED is equivalent.

--- dnstop.c.orig	Wed Jan 28 21:40:06 2009
+++ dnstop.c	Tue Aug 25 20:10:32 2009
@@ -45,6 +45,7 @@ static const char *Version = "20090128";
 #include <netdb.h>
 
 #ifdef HAVE_NET_IF_PPP_H
+#include <net/ppp_defs.h>
 #include <net/if_ppp.h>
 #define PPP_ADDRESS_VAL       0xff	/* The address byte value */
 #define PPP_CONTROL_VAL       0x03	/* The control byte value */
@@ -1630,7 +1631,7 @@ RFC1918PtrFilter(FilterData *fd)
 int
 RcodeRefusedFilter(FilterData *fd)
 {
-    return ns_r_refused == fd->rcode ? 1 : 0;
+    return REFUSED == fd->rcode ? 1 : 0;
 }
 
 void

--- sshconnect.c.orig	Mon May 11 15:37:47 1998
+++ sshconnect.c	Sun May 31 12:54:46 1998
@@ -326,6 +326,12 @@
     {
       struct sockaddr_in sin;
       int p;
+#if defined(__FreeBSD__) || defined(__OpenBSD__)  && !defined(SOCKS)
+	p = 1023;	/* Compat with old FreeBSD */
+      sock = rresvport(&p);
+      if (sock < 0)
+	fatal("rresvport: %.100s", strerror(errno));
+#else
       for (p = 1023; p > 512; p--)
 	{
 	  sock = socket(AF_INET, SOCK_STREAM, 0);
@@ -353,6 +359,7 @@
 	    }
 	  fatal("bind: %.100s", strerror(errno));
 	}
+#endif
       debug("Allocated local port %d.", p);
     }
   else

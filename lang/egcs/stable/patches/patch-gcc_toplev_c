$OpenBSD: patch-gcc_toplev_c,v 1.1 2002/05/27 16:58:29 espie Exp $
--- gcc/toplev.c.orig	Wed May  1 01:04:51 2002
+++ gcc/toplev.c	Mon May 27 15:48:28 2002
@@ -2248,6 +2248,19 @@ rest_of_decl_compilation (decl, asmspec,
 #define ASM_FINISH_DECLARE_OBJECT(FILE, DECL, TOP, END)
 #endif
 
+  /* We deferred calling assemble_alias so that we could collect
+     other attributes such as visibility.  Emit the alias now.  */
+  {
+    tree alias;
+    alias = lookup_attribute ("alias", DECL_ATTRIBUTES (decl));
+    if (alias)
+      {
+	alias = TREE_VALUE (TREE_VALUE (alias));
+	alias = get_identifier (TREE_STRING_POINTER (alias));
+        assemble_alias (decl, alias);
+      }
+  }
+
   /* Forward declarations for nested functions are not "external",
      but we need to treat them as if they were.  */
   if (TREE_STATIC (decl) || DECL_EXTERNAL (decl)

$OpenBSD: patch-src_client_side_c,v 1.4 2006/01/06 01:40:27 brad Exp $
--- src/client_side.c.orig	Thu Jan  5 20:07:54 2006
+++ src/client_side.c	Thu Jan  5 20:08:18 2006
@@ -2824,7 +2824,7 @@ parseHttpRequest(ConnStateData * conn, m
 #elif PF_TRANSPARENT
 	    static time_t last_reported = 0;
 	    if (pffd < 0)
-		pffd = open("/dev/pf", O_RDWR);
+		pffd = open("/dev/pf", O_RDONLY);
 	    if (pffd < 0) {
 		if (squid_curtime - last_reported > 60) {
 		    debug(50, 1) ("parseHttpRequest: PF open failed: %s\n", xstrerror());

$OpenBSD: patch-kcontrol_passwords_passwords_cpp,v 1.1 2003/01/07 00:19:34 espie Exp $
--- kcontrol/passwords/passwords.cpp.orig	Tue Jan  7 00:39:16 2003
+++ kcontrol/passwords/passwords.cpp	Tue Jan  7 01:08:33 2003
@@ -56,6 +56,11 @@ KPasswordConfig::KPasswordConfig(QWidget
     new QRadioButton(i18n("3 stars"), m_EMGroup);
     new QRadioButton(i18n("no echo"), m_EMGroup);
     connect(m_EMGroup, SIGNAL(clicked(int)), SLOT(slotEchoMode(int)));
+    m_SudoBut = new QCheckBox(i18n("&Use sudo"), this);
+    QWhatsThis::add( m_SudoBut, i18n("You can choose to use <em>sudo</em> instead of <em>su</em><p>"
+    "See <em>sudo</em>'s documentation for details") );
+    connect(m_SudoBut, SIGNAL(toggled(bool)), SLOT(slotSudo(bool)));
+    top->addWidget(m_SudoBut);
 
     // Keep password
 
@@ -119,6 +124,7 @@ void KPasswordConfig::load()
 
     m_bKeep = m_pConfig->readBoolEntry("Keep", defKeep);
     m_Timeout = m_pConfig->readNumEntry("Timeout", defTimeout);
+    m_bSudo = m_pConfig->readBoolEntry("Sudo", defSudo);
 
     apply();
     emit changed(false);
@@ -141,6 +147,7 @@ void KPasswordConfig::save()
     m_pConfig->writeEntry("Keep", m_bKeep, true, true);
     m_Timeout = m_TimeoutEdit->value()*60;
     m_pConfig->writeEntry("Timeout", m_Timeout, true, true);
+    m_pConfig->writeEntry("Sudo", m_bSudo, true, true);
 
     m_pConfig->sync();
 
@@ -159,6 +166,7 @@ void KPasswordConfig::defaults()
     m_Echo = defEchoMode;
     m_bKeep = defKeep;
     m_Timeout = defTimeout;
+    m_bSudo = defSudo;
 
     apply();
     emit changed(true);
@@ -169,6 +177,7 @@ void KPasswordConfig::apply()
 {
     m_EMGroup->setButton(m_Echo);
     m_KeepBut->setChecked(m_bKeep);
+    m_SudoBut->setChecked(m_bSudo);
 
     m_TimeoutEdit->setValue(m_Timeout/60);
     m_TimeoutEdit->setEnabled(m_bKeep);
@@ -189,6 +198,11 @@ void KPasswordConfig::slotKeep(bool keep
     emit changed(true);
 }
 
+void KPasswordConfig::slotSudo(bool sudo)
+{
+    m_bSudo = sudo;
+    emit changed(true);
+}
 
 int KPasswordConfig::buttons()
 {

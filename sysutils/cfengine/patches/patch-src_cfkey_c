$OpenBSD: patch-src_cfkey_c,v 1.2 2005/07/21 15:16:46 aanriot Exp $
--- src/cfkey.c.orig	Thu Apr  7 15:26:44 2005
+++ src/cfkey.c	Fri Jul 15 12:24:00 2005
@@ -149,20 +149,21 @@ void Initialize()
 umask(077);
  /* XXX Initialize workdir for non privileged users */
 
- strcpy(CFWORKDIR,WORKDIR);
+ (void)strlcpy(CFWORKDIR,WORKDIR,sizeof(CFWORKDIR));
 
  if (geteuid() > 0)
     {
     char *homedir;
     if ((homedir = getenv("HOME")) != NULL)
        {
-       strcpy(CFWORKDIR,homedir);
-       strcat(CFWORKDIR,"/.cfagent");
+       (void)strlcpy(CFWORKDIR,homedir,sizeof(CFWORKDIR));
+       (void)strlcat(CFWORKDIR,"/.cfagent",sizeof(CFWORKDIR));
        }
     }
  
-strcpy(VLOCKDIR,CFWORKDIR);
-strcpy(VLOGDIR,CFWORKDIR); 
+(void)strlcpy(VLOCKDIR,CFWORKDIR,CF_BUFSIZE);
+(void)strlcpy(VLOGDIR,CFWORKDIR,CF_BUFSIZE); 
+
 
 OpenSSL_add_all_algorithms();
 ERR_load_crypto_strings();

$OpenBSD: patch-configure_ac,v 1.16 2010/05/09 00:16:26 sthen Exp $
--- configure.ac.orig	Sun Apr 18 09:03:54 2010
+++ configure.ac	Wed May  5 18:37:05 2010
@@ -826,6 +826,9 @@ if test "${SYS}" != "mingw32" -a "${SYS}" != "mingwce"
 dnl Check for pthreads - borrowed from XMMS
 THREAD_LIB=error
 if test "${THREAD_LIB}" = "error"; then
+  AC_CHECK_LIB(pthread,main,THREAD_LIB="-pthread")
+fi
+if test "${THREAD_LIB}" = "error"; then
   AC_CHECK_LIB(pthread,main,THREAD_LIB="-lpthread")
 fi
 if test "${THREAD_LIB}" = "error"; then
@@ -2525,7 +2528,7 @@ then
   fi
 
   CPPFLAGS="${CPPFLAGS_save} ${CPPFLAGS_v4l2}"
-  AC_CHECK_HEADERS(linux/videodev2.h, [
+  AC_CHECK_HEADERS([linux/videodev2.h sys/videoio.h sys/videodev2.h], [
     VLC_ADD_PLUGIN([v4l2])
   ],[])
   CPPFLAGS="${CPPFLAGS_save}"
@@ -3753,14 +3756,14 @@ AC_ARG_ENABLE(png,
   [  --enable-png            PNG support (default enabled)])
 if test "${enable_png}" != "no"; then
 AC_CHECK_HEADERS(png.h, [
-  LDFLAGS="${LDFLAGS_save} -lz"
+  LDFLAGS="${LDFLAGS_save} -lm -lz"
   AC_CHECK_LIB(png, png_set_rows, [
-    VLC_ADD_LIBS([png],[-lpng -lz])
+    VLC_ADD_LIBS([png],[-lpng -lm -lz])
     VLC_ADD_PLUGIN([png])
     VLC_ADD_PLUGIN([osdmenu])
     VLC_ADD_PLUGIN([osd_parser])
     AC_DEFINE(HAVE_LIBPNG, 1, [Define if you have the PNG library: libpng])],
-    [],[-lz])
+    [],[-lm -lz])
     LDFLAGS="${LDFLAGS_save}"
   ])
 fi

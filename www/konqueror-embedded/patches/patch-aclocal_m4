$OpenBSD: patch-aclocal_m4,v 1.4 2003/07/16 17:00:07 brad Exp $
--- aclocal.m4.orig	Fri Jul  4 18:13:12 2003
+++ aclocal.m4	Sat Jul  5 15:18:53 2003
@@ -2672,10 +2672,8 @@ AC_DEFUN(AC_CHECK_COMPILERS,
       if test $kde_use_debug_code = "full"; then
         CFLAGS="-g3 $CFLAGS"
       else
-        CFLAGS="-g -O2 $CFLAGS"
+        CFLAGS="-g $CFLAGS"
       fi
-    else
-      CFLAGS="-O2 $CFLAGS"
     fi
   fi
 
@@ -2705,7 +2703,7 @@ AC_DEFUN(AC_CHECK_COMPILERS,
         if test "$kde_use_debug_code" = "full"; then
           CXXFLAGS="-g3 $CXXFLAGS"
         else
-          CXXFLAGS="-g -O2 $CXXFLAGS"
+          CXXFLAGS="-g $CXXFLAGS"
         fi
       fi
       KDE_CHECK_COMPILER_FLAG(fno-builtin,[CXXFLAGS="-fno-builtin $CXXFLAGS"])
@@ -2716,8 +2714,6 @@ AC_DEFUN(AC_CHECK_COMPILERS,
     else
       if test "$CXX" = "KCC"; then
         CXXFLAGS="+K3 $CXXFLAGS"
-      else
-        CXXFLAGS="-O2 $CXXFLAGS"
       fi  
     fi
   fi
@@ -3582,6 +3578,11 @@ AC_DEFUN(KDE_CHECK_LIBDL,
 [
 AC_CHECK_LIB(dl, dlopen, [
 LIBDL="-ldl"
+ac_cv_have_dlfcn=yes
+])
+
+AC_CHECK_LIB(c, dlopen, [
+LIBDL=
 ac_cv_have_dlfcn=yes
 ])
 

$OpenBSD: patch-backend_Makefile_in,v 1.2 2006/08/14 12:55:30 kurt Exp $
--- backend/Makefile.in.orig	Sun Jun 11 13:10:59 2006
+++ backend/Makefile.in	Tue Aug  8 22:52:13 2006
@@ -26,7 +26,7 @@ infodir = @infodir@
 mandir = @mandir@
 includedir = @includedir@
 oldincludedir = /usr/include
-configdir = ${sysconfdir}/sane.d
+configdir = ${datadir}/examples/$(PACKAGE)/sane.d
 BEOS_ADDONDIR = @BEOS_ADDONDIR@
 
 V_MAJOR = @V_MAJOR@
@@ -180,7 +180,8 @@ DISTFILES = abaton.c abaton.conf.in abat
 libsane-%.la: %.lo %-s.lo $(EXTRA) $(LIBOBJS)
 	@$(LIBTOOL) $(MLINK) $(CC) -export-dynamic -o $@ $($*_LIBS) \
 	$(LDFLAGS) $(BACKENDLIBS) $^ @LIBTOOL_LINK_EXTRA@ -rpath $(libsanedir) \
-	-version-info $(V_MAJOR):$(V_REV):$(V_MINOR) $(DYNAMIC_FLAG)
+	-version-info $(V_MAJOR):$(V_REV):$(V_MINOR) $(DYNAMIC_FLAG) \
+	-avoid-version
 
 %-s.lo:	%-s.c
 	@$(LIBTOOL) $(MCOMP) $(COMPILE) -DSTUBS -DBACKEND_NAME=$* $<
@@ -208,7 +209,7 @@ install-be:
 	  $(LIBTOOL) $(MINST) $(INSTALL_PROGRAM) $${be} \
               $(DESTDIR)$(libsanedir)/$${be} >/dev/null || exit 1; \
 	done
-	@$(LIBTOOL) $(MINST) --finish $(DESTDIR)$(libsanedir) >/dev/null
+#	@$(LIBTOOL) $(MINST) --finish $(DESTDIR)$(libsanedir) >/dev/null
 	@# Remove libsane.* links in lib/sane/ as these links to libsane-v4l.so
 	@# cause misdetection of scanners.
 	rm -f $(DESTDIR)$(libsanedir)/libsane.*
@@ -237,7 +238,7 @@ install-libsane:
 	@echo installing libsane.la in $(DESTDIR)$(libdir)/libsane.la...
 	@$(LIBTOOL) $(MINST) $(INSTALL_PROGRAM) libsane.la \
           $(DESTDIR)$(libdir)/libsane.la >/dev/null
-	@$(LIBTOOL) $(MINST) --finish $(DESTDIR)$(libdir)
+#	@$(LIBTOOL) $(MINST) --finish $(DESTDIR)$(libdir)
 
 install-becfg:
 	@list="$(CONFIGS)"; for cfg in $$list; do \
@@ -255,7 +256,7 @@ install-becfg:
 	 done
 
 install-lockpath:
-	$(MKDIR) -m 775 -g $(LOCKPATH_GROUP) $(DESTDIR)$(locksanedir)
+#	$(MKDIR) -m 775 -g $(LOCKPATH_GROUP) $(DESTDIR)$(locksanedir)
 
 uninstall:
 	rm -rf $(libsanedir) $(configdir) $(locksanedir)
@@ -287,7 +288,7 @@ dll-preload.c:
 libsane.la: dll.lo dll-s.lo $(EXTRA) $(addsuffix .lo,$(DLL_PRELOAD)) $(LIBOBJS)
 	@$(LIBTOOL) $(MLINK) $(CC) -o $@ $(LDFLAGS) $(BACKENDLIBS)  $^ \
 		$(addsuffix .lo,$(DLL_PRELOAD_EXTRAS)) @LIBTOOL_LINK_EXTRA@ \
-		-rpath $(libdir) -version-info $(V_MAJOR):$(V_REV):$(V_MINOR)
+		-rpath $(libdir) $(libsane_la_LDFLAGS)
 
 # Generate .conf files for all existing .conf.in files
 becfg: $(patsubst %.conf.in,%.conf,$(wildcard *.conf.in)) 

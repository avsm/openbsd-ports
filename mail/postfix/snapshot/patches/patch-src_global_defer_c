$OpenBSD: patch-src_global_defer_c,v 1.1 2004/06/11 07:47:30 brad Exp $
--- src/global/defer.c.orig	2003-09-21 19:43:38.000000000 -0400
+++ src/global/defer.c	2004-06-10 00:13:49.000000000 -0400
@@ -224,14 +224,16 @@ int     vdefer_append(int flags, const c
 			     ATTR_TYPE_STR, MAIL_ATTR_WHY, vstring_str(why),
 				ATTR_TYPE_END) != 0)
 	    msg_warn("%s: %s service failure", id, var_defer_service);
-	vlog_adhoc(id, orig_rcpt, recipient, relay, entry, "deferred", fmt, ap);
+	log_adhoc(id, orig_rcpt, recipient, relay, entry, "deferred",
+	          "%s", vstring_str(why));
 
 	/*
 	 * Traced delivery.
 	 */
 	if (flags & DEL_REQ_FLAG_RECORD)
-	    if (vtrace_append(flags, id, orig_rcpt, recipient, relay,
-			      entry, "4.0.0", "deferred", fmt, ap) != 0)
+	    if (trace_append(flags, id, orig_rcpt, recipient, relay,
+			     entry, "4.0.0", "deferred",
+			     "%s", vstring_str(why)) != 0)
 		msg_warn("%s: %s service failure", id, var_trace_service);
 
 	/*

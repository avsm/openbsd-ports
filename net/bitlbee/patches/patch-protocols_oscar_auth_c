$OpenBSD: patch-protocols_oscar_auth_c,v 1.2 2007/11/19 11:44:33 martynas Exp $
--- protocols/oscar/auth.c.orig	Mon Aug 20 16:27:15 2007
+++ protocols/oscar/auth.c	Mon Nov 19 13:39:01 2007
@@ -395,7 +395,7 @@ static int parse(aim_session_t *sess, aim_module_t *mo
 	memset(sess->sn, 0, sizeof(sess->sn));
 	if (aim_gettlv(tlvlist, 0x0001, 1)) {
 		info.sn = aim_gettlv_str(tlvlist, 0x0001, 1);
-		strncpy(sess->sn, info.sn, sizeof(sess->sn));
+		strlcpy(sess->sn, info.sn, sizeof(sess->sn));
 	}
 
 	/*
@@ -529,7 +529,7 @@ int auth_modfirst(aim_session_t *sess, aim_module_t *m
 	mod->family = 0x0017;
 	mod->version = 0x0000;
 	mod->flags = 0;
-	strncpy(mod->name, "auth", sizeof(mod->name));
+	strlcpy(mod->name, "auth", sizeof(mod->name));
 	mod->snachandler = snachandler;
 
 	return 0;

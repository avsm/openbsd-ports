$OpenBSD: patch-jdk_make_java_zip_Makefile,v 1.3 2009/05/23 03:03:25 kurt Exp $
--- jdk/make/java/zip/Makefile.orig	Fri May  8 03:34:15 2009
+++ jdk/make/java/zip/Makefile	Sun May 10 23:05:12 2009
@@ -69,16 +69,28 @@ else
 CPPFLAGS += -UDEBUG 
 endif
 
-CPPFLAGS += -I$(SHARE_SRC)/native/java/util/zip/zlib-$(ZLIB_VERSION)
 CPPFLAGS += -I$(SHARE_SRC)/native/java/io
 CPPFLAGS += -I$(PLATFORM_SRC)/native/java/io
 
+ifeq ($(PLATFORM),bsd)
+CPPFLAGS += -I$(PLATFORM_SRC)/hpi/include
+endif
+
+ifneq ($(SYSTEM_ZLIB),true)
+CPPFLAGS += -I$(SHARE_SRC)/native/java/util/zip/zlib-$(ZLIB_VERSION)
+
 #
 # Add to ambient vpath so we pick up the library files
 #
 vpath %.c $(SHARE_SRC)/native/$(PKGDIR)/zlib-$(ZLIB_VERSION)
+endif
 
 #
 # Link to JVM library for JVM_Zip* functions
 #
+ifeq ($(SYSTEM_ZLIB),true)
+OTHER_LDLIBS = -lz
+else
 OTHER_LDLIBS = $(JVMLIB)
+endif
+

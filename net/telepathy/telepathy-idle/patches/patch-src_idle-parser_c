$OpenBSD: patch-src_idle-parser_c,v 1.2 2009/06/02 04:46:29 jasper Exp $
--- src/idle-parser.c.orig	Fri Mar 27 17:24:50 2009
+++ src/idle-parser.c	Mon Jun  1 20:18:04 2009
@@ -207,7 +207,9 @@ void idle_parser_receive(IdleParser *parser, const gch
 
 	g_assert(msg != NULL);
 
-	len = strnlen(msg, IRC_MSG_MAXLEN + 3);
+	len = strlen(msg);
+	g_assert(len <= IRC_MSG_MAXLEN + 3);
+		
 
 	for (i = 0; i < len; i++) {
 		if ((msg[i] == '\n' || msg[i] == '\r')) {

Security fix for hierarchical acl processing


$OpenBSD: patch-MoinMoin_security___init___py,v 1.1.4.1 2009/12/05 23:41:27 william Exp $
--- MoinMoin/security/__init__.py.orig	Sun Aug 31 15:00:52 2008
+++ MoinMoin/security/__init__.py	Tue Aug 11 22:44:50 2009
@@ -69,6 +69,10 @@ def _check(request, pagename, username, right):
                 allowed = acl.may(request, username, right)
                 if allowed is not None:
                     return allowed
+                # If the item has an acl (even one that doesn't match) we *do not*
+                # check the parents. We only check the parents if there's no acl on
+                # the item at all.
+                break
         if not some_acl:
             allowed = cache.acl_rights_default.may(request, username, right)
             if allowed is not None:

--- kioslave/audiocd/configure.in.in.orig	Sun Jul 29 06:56:35 2001
+++ kioslave/audiocd/configure.in.in	Thu Aug 23 22:38:05 2001
@@ -38,6 +38,11 @@ if test "x$with_cdparanoia" = "xCHECK" ;
         break
       fi
     done
+    for dir in $kde_libraries /usr/lib /usr/local/lib; do
+	if ls $dir|grep "^libcdda_paranoia.so.*" 2>&1 >/dev/null; then
+	    ext=so
+	fi
+    done
     if test "$with_cdparanoia" = FOUND; then
       if test "$ext" = la; then
         grep "^library_names='*[a-z]*'" $para_libdir/libcdda_paranoia.$ext 2>&1 > /dev/null || with_cdparanoia=NOTFOUND
@@ -266,7 +271,7 @@ no) AC_MSG_RESULT(no) ;;
 NOTFOUND) AC_MSG_RESULT(searched but not found) ;;
 *)
   if test "x$with_vorbis" = "xFOUND" ; then
-    msg="incs=$vorbis_libdir libs=$vorbis_incdir"
+    msg="incs=$vorbis_incdir libs=$vorbis_libdir"
   else
     msg="$with_vorbis"
     VORBIS_ROOT="$with_vorbis"
@@ -280,8 +285,10 @@ NOTFOUND) AC_MSG_RESULT(searched but not
   non_compile=no
   if test "x$enable_vorbistest" = xyes ; then
     ac_save_CFLAGS="$CFLAGS"
+    ac_save_CXXFLAGS="$CXXFLAGS"
     ac_save_LIBS="$LIBS"
     CFLAGS="$CFLAGS $all_includes $VORBIS_INCS"
+    CXXFLAGS="$CXXFLAGS $all_includes $VORBIS_INCS"
     LIBS="$LIBS $all_libraries $VORBIS_LIBS"
     rm -f conf.vorbistest
     AC_TRY_RUN([
@@ -298,6 +305,7 @@ int main ()
 
 ], , non_compile=yes , [echo $ac_n "cross compiling; assumed OK... $ac_c"])
     CFLAGS="$ac_save_CFLAGS"
+    CXXFLAGS="$ac_save_CXXFLAGS"
     LIBS="$ac_save_LIBS"
     # bogus return value, but it _did_ run
     test -f conf.vorbistest && non_compile="no"
@@ -308,12 +316,13 @@ int main ()
      AC_MSG_RESULT($msg)
      AC_DEFINE_UNQUOTED(HAVE_VORBIS, 1, [Define if you have vorbis])
      VORBISFILE_LIBS="-lvorbisfile"
-     VORBISENC_LIBS="-lvorbisenc"
+     VORBISENC_LIBS="-lvorbisenc -lvorbis"
      KCM_AUDIOCD="kcmaudiocd"	
   else
      AC_MSG_RESULT(no (but first try gave $msg))
      echo "*** Could not run Vorbis test program, checking why..."
      CFLAGS="$CFLAGS $all_includes $VORBIS_INCS"
+     CXXFLAGS="$CXXFLAGS $all_includes $VORBIS_INCS"
      LIBS="$LIBS $all_libraries $VORBIS_LIBS"
      AC_TRY_LINK([
 #include <stdio.h>
@@ -332,6 +341,7 @@ int main ()
      echo "*** exact error that occured. This usually means Vorbis was incorrectly installed"
      echo "*** or that you have moved Vorbis since it was installed." ])
      CFLAGS="$ac_save_CFLAGS"
+     CXXFLAGS="$ac_save_CXXFLAGS"
      LIBS="$ac_save_LIBS"
      VORBIS_INCS=""
      VORBIS_LIBS=""

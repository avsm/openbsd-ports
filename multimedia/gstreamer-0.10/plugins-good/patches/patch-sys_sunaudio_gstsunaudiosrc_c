$OpenBSD: patch-sys_sunaudio_gstsunaudiosrc_c,v 1.1 2007/01/09 23:22:56 espie Exp $
--- sys/sunaudio/gstsunaudiosrc.c.orig	Tue Jan  9 23:24:45 2007
+++ sys/sunaudio/gstsunaudiosrc.c	Tue Jan  9 23:26:04 2007
@@ -45,8 +45,6 @@
 #include <fcntl.h>
 #include <string.h>
 #include <unistd.h>
-#include <stropts.h>
-#include <sys/mixer.h>
 
 #include "gstsunaudiosrc.h"
 
@@ -248,9 +246,8 @@ gst_sunaudiosrc_open (GstAudioSrc * asrc
   int fd, ret, err;
 
   fd = open (sunaudiosrc->device, O_RDONLY);
-  err = ioctl (fd, AUDIO_MIXER_MULTIPLE_OPEN);
 
-  if (fd == -1 || err == -1) {
+  if (fd == -1) {
     GST_ELEMENT_ERROR (sunaudiosrc, RESOURCE, OPEN_READ, (NULL),
         ("can't open connection to Sun Audio device %s", sunaudiosrc->device));
 
@@ -375,7 +372,7 @@ gst_sunaudiosrc_prepare (GstAudioSrc * a
   }
 
 
-  ioctl (sunaudiosrc->fd, I_FLUSH, FLUSHR);
+  ioctl (sunaudiosrc->fd, AUDIO_FLUSH);
 
   return TRUE;
 }
@@ -429,7 +426,7 @@ gst_sunaudiosrc_reset (GstAudioSrc * asr
   }
 
   /* Flush the audio */
-  ret = ioctl (sunaudiosrc->fd, I_FLUSH, FLUSHR);
+  ret = ioctl (sunaudiosrc->fd, AUDIO_FLUSH);
   if (ret == -1) {
     GST_ELEMENT_ERROR (sunaudiosrc, RESOURCE, SETTINGS, (NULL), ("%s",
             strerror (errno)));

--- configure.orig	2001-10-29 15:24:18.000000000 +0100
+++ configure	2003-12-26 17:27:26.000000000 +0100
@@ -52,7 +52,10 @@ else
 fi
 
 # Check licensed modules
-MODULES=`$MAKE -f src/Makefile.in listallmodules`
+if [ -z "$MODULES" ]
+then
+    MODULES=`$MAKE -f src/Makefile.in listallmodules`
+fi
 
 # Qt/Embedded?
 if [ -f configs/linux-generic-g++-shared ]
@@ -78,6 +81,7 @@ then
     Licensee=you
     while true
     do
+	break
 	echo
 	echo "This is the Qt$EMB Free Edition."
 	echo
@@ -1347,7 +1351,7 @@ chmod -w src/tools/qmodules.h
 [ "x$LIBPNG" = "xno" ] && QT_LIBS="${QT_LIBS} -lpng"
 [ "x$ZLIB" = "xno" ] && QT_LIBS="${QT_LIBS} -lz"
 [ "x$JPEG" = "xyes" ] && QT_LIBS="${QT_LIBS} -ljpeg"
-[ "x$MNG" = "xyes" ] && QT_LIBS="${QT_LIBS} -lmng -ljpeg" # assume JNG support
+[ "x$MNG" = "xyes" ] && QT_LIBS="${QT_LIBS} -lmng -llcms -ljpeg" # assume JNG support
 [ "x$NAS_SOUND" = "xyes" ] && QT_LIBS="${QT_LIBS} -laudio -lXt" # Xt junk in audio library
 QT_LIBS="$L_FLAGS $R_FLAGS $QT_LIBS $l_FLAGS"
 
@@ -1441,19 +1445,7 @@ echo Creating makefiles...
 
 sepath=`echo $relpath | sed -e 's/\\./\\\\./g'`
 
-if [ $KDE = yes ]
-then
-    if [ '!' -f $KDEDIR/bin/dcopserver ]
-    then
-	KDE=no
-	echo ""
-	echo "You wanted to compile the Qt Designer with"
-	echo "KDE 2 support, but \$KDEDIR does not point"
-	echo "to a valid KDE 2 installation. KDE 2 support"
-	echo "has been turned off."
-	echo ""
-    fi
-fi
+# KDE check removed, as this will happen later.
 
 for a in `find $relpath/. -name Makefile.in -print | sort` ; do
     dir=`dirname $a`

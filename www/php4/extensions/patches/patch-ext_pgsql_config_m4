$OpenBSD: patch-ext_pgsql_config_m4,v 1.1.1.1 2002/06/24 19:27:48 avsm Exp $
--- ext/pgsql/config.m4.orig	Wed Jun 19 22:29:57 2002
+++ ext/pgsql/config.m4	Wed Jun 19 22:37:03 2002
@@ -26,29 +26,16 @@ if test "$PHP_PGSQL" != "no"; then
       fi
     done
 
-    for j in lib lib/pgsql lib/postgres lib/postgresql ""; do
-      if test -f "$i/$j/libpq.so"; then 
-        PGSQL_LIBDIR=$i/$j
-      fi
-    done
   done
 
   if test -z "$PGSQL_INCLUDE"; then
     AC_MSG_ERROR(Cannot find libpq-fe.h. Please specify correct PostgreSQL installation path)
   fi
 
-  if test -z "$PGSQL_LIBDIR"; then
-    AC_MSG_ERROR(Cannot find libpq.so. Please specify correct PostgreSQL installation path)
-  fi
-
-  if test -z "$PGSQL_INCLUDE" -a -z "$PGSQL_LIBDIR" ; then
-    AC_MSG_ERROR([Unable to find libpq anywhere under $withval])
-  fi
-
-  AC_DEFINE(HAVE_PGSQL,1,[ ])
   old_LIBS=$LIBS
   old_LDFLAGS=$LDFLAGS
   LDFLAGS="$LDFLAGS -L$PGSQL_LIBDIR"
+  AC_CHECK_LIB(pq, PQconnectdb, AC_DEFINE(HAVE_PGSQL,1,[]), AC_MSG_ERROR(Cannot find libpq.  Please ensure it is in your system's library path))
   AC_CHECK_LIB(pq, PQescapeString,AC_DEFINE(HAVE_PQESCAPE,1,[ ]))
   AC_CHECK_LIB(pq, PQsetnonblocking,AC_DEFINE(HAVE_PQSETNONBLOCKING,1,[ ]))
   AC_CHECK_LIB(pq, PQcmdTuples,AC_DEFINE(HAVE_PQCMDTUPLES,1,[ ]))

$OpenBSD: patch-src_discdb_c,v 1.2 2005/06/30 22:34:29 alek Exp $
--- src/discdb.c.orig	Mon Jun  6 11:58:57 2005
+++ src/discdb.c	Mon Jun  6 11:59:56 2005
@@ -311,7 +311,7 @@ gboolean DiscDBDoQuery(DiscInfo *disc,Di
     query->query_match=MATCH_EXACT;
     query->query_matches=0;
 
-    while((inbuffer=DiscDBReadLine(&dataptr))) {
+    while(query->query_matches < MAX_INEXACT_MATCHES && (inbuffer=DiscDBReadLine(&dataptr))) {
       query->query_list[query->query_matches].list_genre=
 	DiscDBGenreValue(g_strstrip(strtok(inbuffer," ")));
       
@@ -331,7 +331,7 @@ gboolean DiscDBDoQuery(DiscInfo *disc,Di
     query->query_match=MATCH_INEXACT;
     query->query_matches=0;
 
-    while((inbuffer=DiscDBReadLine(&dataptr))) {
+    while(query->query_matches < MAX_INEXACT_MATCHES && (inbuffer=DiscDBReadLine(&dataptr))) {
       query->query_list[query->query_matches].list_genre=
 	DiscDBGenreValue(g_strstrip(strtok(inbuffer," ")));
       

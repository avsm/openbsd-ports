$OpenBSD: patch-kio_kmimemagic_cpp,v 1.1.2.1 2003/01/07 00:12:40 brad Exp $
--- kio/kmimemagic.cpp.orig	Fri Aug  3 16:13:55 2001
+++ kio/kmimemagic.cpp	Sun Jan  5 16:07:24 2003
@@ -1478,7 +1478,9 @@ KMimeMagic::fsmagic(const char *fn, stru
 					char *tmp;
 					char buf2[BUFSIZ + BUFSIZ + 4];
 
-					strcpy(buf2, fn);
+					strncpy(buf2, fn, BUFSIZ);
+                    buf2[BUFSIZ] = 0;
+
 					if ((tmp = strrchr(buf2, '/')) == NULL) {
 						tmp = buf; /* in current dir */
 					} else {

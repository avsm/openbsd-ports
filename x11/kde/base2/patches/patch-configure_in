$OpenBSD: patch-configure_in,v 1.1 2001/08/26 12:04:44 espie Exp $
--- configure.in.orig	Mon Aug  6 03:30:14 2001
+++ configure.in	Sat Aug 25 14:15:36 2001
@@ -35,7 +35,7 @@ dnl Perform program name transformation
 AC_ARG_PROGRAM
 
 dnl Automake doc recommends to do this only here. (Janos)
-AM_INIT_AUTOMAKE(kdebase, "2.2") dnl searches for some needed programs
+AM_INIT_AUTOMAKE(kdebase-2.2, "2.2") dnl searches for some needed programs
 
 KDE_SET_PREFIX
 
@@ -789,6 +789,11 @@ if test "x$with_cdparanoia" = "xCHECK" ;
         break
       fi
     done
+    for dir in $kde_libraries /usr/lib /usr/local/lib; do
+	if ls $dir|grep "^libcdda_paranoia.so.*" 2>&1 >/dev/null; then
+	    ext=so
+	fi
+    done
     if test "$with_cdparanoia" = FOUND; then
       if test "$ext" = la; then
         grep "^library_names='*[a-z]*'" $para_libdir/libcdda_paranoia.$ext 2>&1 > /dev/null || with_cdparanoia=NOTFOUND
@@ -891,8 +896,10 @@ NOTFOUND) AC_MSG_RESULT(searched but not
   non_compile=no
   if test "x$enable_lametest" = xyes ; then
     ac_save_CFLAGS="$CFLAGS"
+    ac_save_CXXFLAGS="$CXXFLAGS"
     ac_save_LIBS="$LIBS"
     CFLAGS="$CFLAGS $all_includes $LAME_INCS"
+    CXXFLAGS="$CFLAGS $all_includes $LAME_INCS"
     LIBS="$LIBS $all_libraries $LAME_LIBS"
     rm -f conf.lametest conf.wrongver
     AC_TRY_RUN([
@@ -915,6 +922,7 @@ int main ()
 }
 ], , non_compile=yes , [echo $ac_n "cross compiling; assumed OK... $ac_c"])
     CFLAGS="$ac_save_CFLAGS"
+    CXXFLAGS="$ac_save_CXXFLAGS"
     LIBS="$ac_save_LIBS"
     # bogus return value, but it _did_ run correctly
     test -f conf.lametest && non_compile=no
@@ -932,6 +940,7 @@ int main ()
       # only do this test, if it really didn't run
       echo "*** Could not run Lame test program, checking why..."
       CFLAGS="$CFLAGS $all_includes $LAME_INCS"
+      CXXFLAGS="$CFLAGS $all_includes $LAME_INCS"
       LIBS="$LIBS $all_libraries $LAME_LIBS"
       AC_TRY_LINK([
 #include <stdio.h>
@@ -958,6 +967,7 @@ echo "*** or that you have moved Lame si
       # ac_save_* still set, because this else part is only entered if the
       # enable_lametest was yes, in which case also ac_save_* was set.
       CFLAGS="$ac_save_CFLAGS"
+      CXXFLAGS="$ac_save_CXXFLAGS"
       LIBS="$ac_save_LIBS"
     fi
     LAME_INCS=
@@ -1017,7 +1027,7 @@ no) AC_MSG_RESULT(no) ;;
 NOTFOUND) AC_MSG_RESULT(searched but not found) ;;
 *)
   if test "x$with_vorbis" = "xFOUND" ; then
-    msg="incs=$vorbis_libdir libs=$vorbis_incdir"
+    msg="incs=$vorbis_incdir libs=$vorbis_libdir"
   else
     msg="$with_vorbis"
     VORBIS_ROOT="$with_vorbis"
@@ -1031,8 +1041,10 @@ NOTFOUND) AC_MSG_RESULT(searched but not
   non_compile=no
   if test "x$enable_vorbistest" = xyes ; then
     ac_save_CFLAGS="$CFLAGS"
+    ac_save_CXXFLAGS="$CXXFLAGS"
     ac_save_LIBS="$LIBS"
     CFLAGS="$CFLAGS $all_includes $VORBIS_INCS"
+    CXXFLAGS="$CXXFLAGS $all_includes $VORBIS_INCS"
     LIBS="$LIBS $all_libraries $VORBIS_LIBS"
     rm -f conf.vorbistest
     AC_TRY_RUN([
@@ -1049,6 +1061,7 @@ int main ()
 
 ], , non_compile=yes , [echo $ac_n "cross compiling; assumed OK... $ac_c"])
     CFLAGS="$ac_save_CFLAGS"
+    CXXFLAGS="$ac_save_CXXFLAGS"
     LIBS="$ac_save_LIBS"
     # bogus return value, but it _did_ run
     test -f conf.vorbistest && non_compile="no"
@@ -1059,12 +1072,13 @@ int main ()
      AC_MSG_RESULT($msg)
      AC_DEFINE_UNQUOTED(HAVE_VORBIS, 1, [Define if you have vorbis])
      VORBISFILE_LIBS="-lvorbisfile"
-     VORBISENC_LIBS="-lvorbisenc"
+     VORBISENC_LIBS="-lvorbisenc -lvorbis"
      KCM_AUDIOCD="kcmaudiocd"	
   else
      AC_MSG_RESULT(no (but first try gave $msg))
      echo "*** Could not run Vorbis test program, checking why..."
      CFLAGS="$CFLAGS $all_includes $VORBIS_INCS"
+     CXXFLAGS="$CXXFLAGS $all_includes $VORBIS_INCS"
      LIBS="$LIBS $all_libraries $VORBIS_LIBS"
      AC_TRY_LINK([
 #include <stdio.h>
@@ -1083,6 +1097,7 @@ int main ()
      echo "*** exact error that occured. This usually means Vorbis was incorrectly installed"
      echo "*** or that you have moved Vorbis since it was installed." ])
      CFLAGS="$ac_save_CFLAGS"
+     CXXFLAGS="$ac_save_CXXFLAGS"
      LIBS="$ac_save_LIBS"
      VORBIS_INCS=""
      VORBIS_LIBS=""
@@ -1655,8 +1670,8 @@ kdcop/Makefile \
 kdebugdialog/Makefile \
 kdeprint/Makefile \
 kdeprint/descriptions/Makefile \
-kdeprint/kdeprintfax/Makefile \
 kdeprint/kdeprint_part/Makefile \
+kdeprint/kdeprintfax/Makefile \
 kdeprint/kjobviewer/Makefile \
 kdeprint/kprinter/Makefile \
 kdeprint/printmgr/Makefile \

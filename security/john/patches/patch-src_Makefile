$OpenBSD: patch-src_Makefile,v 1.3 2005/05/31 08:08:52 sturm Exp $
--- src/Makefile.orig	Wed May  4 19:49:31 2005
+++ src/Makefile	Tue May 31 09:44:24 2005
@@ -17,7 +17,7 @@ NULL = /dev/null
 CPPFLAGS = -E
 CFLAGS = -c -Wall -O2 -fomit-frame-pointer
 ASFLAGS = -c
-LDFLAGS = -s
+LDFLAGS = -s -lm
 OPT_NORMAL = -funroll-loops
 OPT_INLINE = -finline-functions
 
@@ -249,7 +249,7 @@ openbsd-x86-any-a.out:
 	$(LN) x86-any.h arch.h
 	$(MAKE) $(PROJ) \
 		JOHN_OBJS="$(JOHN_OBJS) x86.o" \
-		ASFLAGS="$(ASFLAGS) -DUNDERSCORES -DALIGN_LOG -DBSD"
+		ASFLAGS="$(ASFLAGS) -DBSD"
 
 openbsd-sparc:
 	$(MAKE) use-openbsd-sparc HAMMER=use-openbsd-sparc NAIL=sparc.h
@@ -260,7 +260,13 @@ use-openbsd-sparc:
 	$(MAKE) $(NAIL) \
 		BENCH_DES_OBJS_DEPEND="$(BENCH_DES_OBJS_ORIG) sparc.o" \
 		JOHN_OBJS="$(JOHN_OBJS_ORIG) sparc.o" \
-		ASFLAGS="-c -DUNDERSCORES -DBSD"
+		ASFLAGS="-c -DBSD"
+
+openbsd-sparc64:
+	$(LN) sparc64.h arch.h
+	$(MAKE) $(PROJ) \
+		CFLAGS="$(CFLAGS) -m64 -mcpu=ultrasparc" \
+		LDFLAGS="-m64 -s"
 
 openbsd-vax:
 	$(LN) vax.h arch.h

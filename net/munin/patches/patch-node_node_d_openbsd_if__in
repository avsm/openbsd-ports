$OpenBSD: patch-node_node_d_openbsd_if__in,v 1.1.1.1 2009/11/17 11:11:21 sthen Exp $
--- node/node.d.openbsd/if_.in.orig	Thu Feb 21 13:24:36 2008
+++ node/node.d.openbsd/if_.in	Mon Nov 16 16:26:42 2009
@@ -33,7 +33,7 @@ fi
 
 if [ "$1" = "suggest" ]; then
 	if [ -x /usr/bin/netstat ]; then
-		netstat -i -b -n | sed -n -e '/^faith/d' -e '/^lo[0-9]/d' -e '/^pflog/d' -e '/<Link#[0-9]*>/s/\** .*//p'
+		netstat -i -b -n | sed -n -e '/^faith/d' -e '/^lo[0-9]/d' -e '/^pflog/d' -e '/<Link>/s/\** .*//p'
 		exit 0
 	else
 		exit 1
@@ -47,7 +47,7 @@ if [ "$1" = "config" ]; then
 	echo 'graph_args --base 1000'
 	echo 'graph_vlabel bits per ${graph_period} in (-) / out (+)'
 	echo 'graph_category network'
-	echo "graph_info This graph shows the traffic of the $INTERFACE network interface. Please note that the traffic is shown in bits per second, not bytes. IMPORTANT: Since the data source for this plugin use 32bit counters, this plugin is really unreliable and unsuitable for most 100Mb (or faster) interfaces, where bursts are expected to exceed 50Mbps. This means that this plugin is usuitable for most production environments."
+	echo "graph_info This graph shows the traffic of the $INTERFACE network interface. Please note that the traffic is shown in bits per second, not bytes."
 	echo 'rbytes.label received'
         echo 'rbytes.type COUNTER'
         echo 'rbytes.graph no'
@@ -63,11 +63,11 @@ fi
 if [ "$INTERFACE" = "aggregated" ]; then
 	/usr/bin/netstat -i -b -n | grep -v '^lo' | awk '
 BEGIN { rsum = 0; osum = 0; }
-/<Link#[0-9]*>/ {
-	if (NF == 10) { 
-		rsum += $6; osum += $9;
+/<Link>/ {
+	if (NF == 5) { 
+		rsum += $4; osum += $5;
 	} else {
-		rsum += $7; osum += $10;
+		rsum += $5; osum += $6;
 	}
 }
 END {
@@ -77,13 +77,13 @@ END {
   
 else
 	/usr/bin/netstat -i -b -n -I $INTERFACE | awk '
-/<Link#[0-9]*>/ {
-	if (NF == 10) { 
-		print "rbytes.value", $6;
-		print "obytes.value", $9;
+/<Link>/ {
+	if (NF == 5) { 
+		print "rbytes.value", $4;
+		print "obytes.value", $5;
 	} else {
-		print "rbytes.value", $7;
-		print "obytes.value", $10;
+		print "rbytes.value", $5;
+		print "obytes.value", $6;
 	}
 }'
 fi

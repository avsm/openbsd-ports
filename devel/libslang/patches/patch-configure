$OpenBSD: patch-configure,v 1.10 2002/05/08 02:04:08 brad Exp $
--- configure.orig	Sun Feb 10 02:39:19 2002
+++ configure	Tue May  7 19:57:59 2002
@@ -577,7 +577,7 @@ fi
 
 
 ac_aux_dir=
-for ac_dir in autoconf $srcdir/autoconf; do
+for ac_dir in ${GNUSYSTEM_AUX_DIR} autoconf $srcdir/autoconf; do
   if test -f $ac_dir/install-sh; then
     ac_aux_dir=$ac_dir
     ac_install_sh="$ac_aux_dir/install-sh -c"
@@ -2032,6 +2032,25 @@ case "$host_os" in
      ELFLIB_MAJOR="lib$(THIS_LIB).$(ELF_MAJOR_VERSION).dylib"
      ELFLIB_MAJOR_MINOR="lib$(THIS_LIB).$(ELF_MAJOR_VERSION).$(ELF_MINOR_VERSION).dylib"
      ;;
+  *openbsd* )
+     DYNAMIC_LINK_FLAGS=""
+     ELF_CC="$CC"
+     case `arch -s` in
+       sparc64)
+         ELF_CFLAGS="$CFLAGS -fPIC"
+        ;;
+       *)
+         ELF_CFLAGS="$CFLAGS -fpic"
+        ;;
+     esac
+     ELF_LINK="$CC -shared $ELF_CFLAGS"
+     ELF_LINK_CMD="\$(ELF_LINK)"
+     ELF_DEP_LIBS="\$(DL_LIB) -lm -lcurses"
+     CC_SHARED="$CC -shared $ELF_CFLAGS"
+     if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`"; then
+       DYNAMIC_LINK_FLAGS="-Wl,-E"
+     fi
+     ;;
   * )
     echo "Note: ELF compiler for host_os=$host_os may be wrong"
     ELF_CC="$CC"
@@ -2078,7 +2097,7 @@ then
   then 
     
 case "$host_os" in
-  *linux*|*solaris* )
+  *linux*|*solaris*|*openbsd* )
     if test "X$GCC" = Xyes
     then
       if test "X$ac_R_nospace" = "Xno"
@@ -2117,7 +2136,7 @@ fi
 
 
 echo $ac_n "checking size of short""... $ac_c" 1>&6
-echo "configure:2121: checking size of short" >&5
+echo "configure:2140: checking size of short" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_short'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2125,7 +2144,7 @@ else
   ac_cv_sizeof_short=2
 else
   cat > conftest.$ac_ext <<EOF
-#line 2129 "configure"
+#line 2148 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -2136,7 +2155,7 @@ main()
   exit(0);
 }
 EOF
-if { (eval echo configure:2140: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:2159: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_short=`cat conftestval`
 else
@@ -2156,7 +2175,7 @@ EOF
 
 
 echo $ac_n "checking size of int""... $ac_c" 1>&6
-echo "configure:2160: checking size of int" >&5
+echo "configure:2179: checking size of int" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_int'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2164,7 +2183,7 @@ else
   ac_cv_sizeof_int=4
 else
   cat > conftest.$ac_ext <<EOF
-#line 2168 "configure"
+#line 2187 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -2175,7 +2194,7 @@ main()
   exit(0);
 }
 EOF
-if { (eval echo configure:2179: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:2198: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_int=`cat conftestval`
 else
@@ -2195,7 +2214,7 @@ EOF
 
 
 echo $ac_n "checking size of long""... $ac_c" 1>&6
-echo "configure:2199: checking size of long" >&5
+echo "configure:2218: checking size of long" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_long'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2203,7 +2222,7 @@ else
   ac_cv_sizeof_long=4
 else
   cat > conftest.$ac_ext <<EOF
-#line 2207 "configure"
+#line 2226 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -2214,7 +2233,7 @@ main()
   exit(0);
 }
 EOF
-if { (eval echo configure:2218: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:2237: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_long=`cat conftestval`
 else
@@ -2234,7 +2253,7 @@ EOF
 
 
 echo $ac_n "checking size of float""... $ac_c" 1>&6
-echo "configure:2238: checking size of float" >&5
+echo "configure:2257: checking size of float" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_float'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2242,7 +2261,7 @@ else
   ac_cv_sizeof_float=4
 else
   cat > conftest.$ac_ext <<EOF
-#line 2246 "configure"
+#line 2265 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -2253,7 +2272,7 @@ main()
   exit(0);
 }
 EOF
-if { (eval echo configure:2257: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:2276: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_float=`cat conftestval`
 else
@@ -2273,7 +2292,7 @@ EOF
 
 
 echo $ac_n "checking size of double""... $ac_c" 1>&6
-echo "configure:2277: checking size of double" >&5
+echo "configure:2296: checking size of double" >&5
 if eval "test \"`echo '$''{'ac_cv_sizeof_double'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2281,7 +2300,7 @@ else
   ac_cv_sizeof_double=8
 else
   cat > conftest.$ac_ext <<EOF
-#line 2285 "configure"
+#line 2304 "configure"
 #include "confdefs.h"
 #include <stdio.h>
 main()
@@ -2292,7 +2311,7 @@ main()
   exit(0);
 }
 EOF
-if { (eval echo configure:2296: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:2315: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_sizeof_double=`cat conftestval`
 else
@@ -2314,7 +2333,7 @@ EOF
 
 
 echo $ac_n "checking for Terminfo""... $ac_c" 1>&6
-echo "configure:2318: checking for Terminfo" >&5
+echo "configure:2337: checking for Terminfo" >&5
 MISC_TERMINFO_DIRS="$FINKPREFIX/share/terminfo"
 if test ! -d $MISC_TERMINFO_DIRS
 then
@@ -2431,7 +2450,7 @@ PROGRAM_ELF_ORULES="$PROGRAM_ELF_ORULES
 
 
 echo $ac_n "checking SLANG_VERSION""... $ac_c" 1>&6
-echo "configure:2435: checking SLANG_VERSION" >&5
+echo "configure:2454: checking SLANG_VERSION" >&5
 slang_version=`grep "^#define  *SLANG_VERSION " $srcdir/src/slang.h |
                awk '{ print $3 }'`
 slang_major_version=`echo $slang_version |
@@ -2441,7 +2460,8 @@ slang_minor_version=`echo $slang_version
 slang_mminor_version=`echo $slang_version $slang_major_version $slang_minor_version |
  awk '{ print ($1 - $2*10000 - $3*100) }'`
 
-slang_minor_version="$slang_minor_version.$slang_mminor_version"
+slang_major_version=$slang_major_version$slang_minor_version
+slang_minor_version=$slang_mminor_version
 slang_version="$slang_major_version.$slang_minor_version"
 echo "$ac_t""$slang_version" 1>&6
 

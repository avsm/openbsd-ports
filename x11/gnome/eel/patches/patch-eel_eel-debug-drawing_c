$OpenBSD: patch-eel_eel-debug-drawing_c,v 1.1 2009/01/30 18:15:59 jasper Exp $

Use mkstemp() instead of legacy and race-prone mktemp().

--- eel/eel-debug-drawing.c.orig	Fri Jan 30 19:07:20 2009
+++ eel/eel-debug-drawing.c	Fri Jan 30 19:08:15 2009
@@ -285,15 +285,19 @@ eel_debug_show_pixbuf_in_external_viewer (const GdkPix
 	char *file_name;
 	gboolean save_result;
 	int ignore;
+	int fd;
 
 	g_return_if_fail (pixbuf != NULL);
 	g_return_if_fail (viewer_name != NULL);
 
 	file_name = g_strdup ("/tmp/eel-debug-png-file-XXXXXX");
 
-	if (mktemp (file_name) != file_name) {
+	fd = g_mkstemp (file_name);
+	if (fd == -1) {
 		g_free (file_name);
 		file_name = g_strdup_printf ("/tmp/isis-debug-png-file-%d", getpid ());
+	} else {
+		close (fd);
 	}
 
 	save_result = eel_gdk_pixbuf_save_to_file (pixbuf, file_name);

$OpenBSD: patch-apps_silcd_command_reply_c,v 1.2 2009/01/23 11:01:06 sthen Exp $
--- apps/silcd/command_reply.c.orig	Sat Oct 25 09:59:17 2008
+++ apps/silcd/command_reply.c	Sat Jan 17 07:57:46 2009
@@ -236,6 +236,10 @@ silc_server_command_reply_whois_save(SilcServerCommand
     client->data.status &= ~SILC_IDLIST_STATUS_RESOLVING;
     client->mode = mode;
     client->servername = servername[0] ? strdup(servername) : NULL;
+
+    SILC_LOG_DEBUG(("stat.clients %d->%d", server->stat.clients,
+		    server->stat.clients + 1));
+    server->stat.clients++;
   } else {
     /* We have the client already, update the data */
 
@@ -660,6 +664,10 @@ silc_server_command_reply_identify_save(SilcServerComm
       client->data.status |= SILC_IDLIST_STATUS_REGISTERED;
       client->data.status |= SILC_IDLIST_STATUS_RESOLVED;
       client->data.status &= ~SILC_IDLIST_STATUS_RESOLVING;
+
+      SILC_LOG_DEBUG(("stat.clients %d->%d", server->stat.clients,
+		      server->stat.clients + 1));
+      server->stat.clients++;
     } else {
       /* We have the client already, update the data */
 
@@ -1241,6 +1249,8 @@ SILC_SERVER_CMD_REPLY_FUNC(stats)
 			 SILC_STR_UI_INT(&server->stat.router_ops),
 			 SILC_STR_END);
   }
+
+  SILC_LOG_DEBUG(("stat.clients = %d", server->stat.clients));
 
  out:
   SILC_SERVER_PENDING_EXEC(cmd, SILC_COMMAND_STATS);

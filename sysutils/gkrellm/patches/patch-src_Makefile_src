$OpenBSD: patch-src_Makefile_src,v 1.7 2003/01/01 21:21:01 naddy Exp $
--- src/Makefile.src.orig	Mon Jul  1 04:13:04 2002
+++ src/Makefile.src	Wed Jan  1 22:16:09 2003
@@ -9,8 +9,7 @@ MANDIR ?= /usr/local/share/man/man1
 MANMODE ?= 644
 MANDIRMODE ?= 755
 INSTALL ?= install
-LINK_FLAGS ?= -Wl,-E
-CC ?= gcc
+LINK_FLAGS ?= -Wl
 STRIP ?= -s
 
 GKRELLM_INCLUDES = gkrellm.h gkrellm_public_proto.h
@@ -21,7 +20,7 @@ IMLIB_INCLUDE = `imlib-config --cflags-g
 GTK_LIB = `$(GTK_CONFIG) --libs gthread`
 IMLIB_LIB = `imlib-config --libs-gdk`
 
-FLAGS = -O2 -I.. $(GTK_INCLUDE) $(IMLIB_INCLUDE) $(GTOP_INCLUDE)
+FLAGS = -I.. $(GTK_INCLUDE) $(IMLIB_INCLUDE) $(GTOP_INCLUDE)
 FLAGS+= $(PTHREAD_INC)
 
 LIBS = $(GTK_LIB) $(IMLIB_LIB) $(GTOP_LIBS) $(SYS_LIBS)
@@ -38,7 +37,7 @@ ifeq ($(HAVE_GETADDRINFO),1)
     FLAGS += -DHAVE_GETADDRINFO
 endif
 
-CC += -Wall $(FLAGS)
+CFLAGS += $(FLAGS)
 
 OBJS =	main.o alerts.o apm.o base64.o clock.o cpu.o disk.o fs.o hostname.o \
 	inet.o mail.o meminfo.o net.o proc.o sensors.o uptime.o \
@@ -70,6 +69,9 @@ darwin: 
 netbsd:
 	$(MAKE) PTHREAD_INC=-I/usr/local/include \
 	GTK_CONFIG=gtk-config GTOP_LIBS= EXTRAOBJS= SYS_LIBS="-lkvm" gkrellm
+
+openbsd:
+	$(MAKE) GTK_CONFIG=gtk-config GTOP_LIBS= SYS_LIBS="-lkvm -pthread" gkrellm
 
 solaris:
 	$(MAKE) CFLAGS="-Wno-implicit-int" \

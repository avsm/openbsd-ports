$OpenBSD: patch-daemon_gvfsbackenddav_c,v 1.1 2009/08/07 08:40:07 ajacoutot Exp $

Fix unmounting webdav share:
    http://bugzilla.gnome.org/show_bug.cgi?id=567664

--- daemon/gvfsbackenddav.c.orig	Fri Aug  7 10:21:57 2009
+++ daemon/gvfsbackenddav.c	Fri Aug  7 10:23:13 2009
@@ -2124,11 +2124,11 @@ do_set_display_name (GVfsBackend           *backend,
   soup_uri_free (source);
 }
 
-static gboolean
-try_unmount (GVfsBackend    *backend,
+static void 
+do_unmount (GVfsBackend    *backend,
              GVfsJobUnmount *job)
 {
-  _exit (0);
+ g_vfs_job_succeeded (G_VFS_JOB (job));
 }
 
 /* ************************************************************************* */
@@ -2156,5 +2156,5 @@ g_vfs_backend_dav_class_init (GVfsBackendDavClass *kla
   backend_class->make_directory    = do_make_directory;
   backend_class->delete            = do_delete;
   backend_class->set_display_name  = do_set_display_name;
-  backend_class->try_unmount       = try_unmount;
+  backend_class->unmount           = do_unmount;
 }

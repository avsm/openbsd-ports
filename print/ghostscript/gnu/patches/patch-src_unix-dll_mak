$OpenBSD: patch-src_unix-dll_mak,v 1.3 2006/01/02 22:44:50 sturm Exp $
--- src/unix-dll.mak.orig	Fri Apr 19 03:10:40 2002
+++ src/unix-dll.mak	Mon Jan  2 22:15:16 2006
@@ -46,11 +46,11 @@ GSSOX=$(BINDIR)/$(SOBINRELDIR)/$(GSSOX_X
 
 # shared library
 GS_SONAME=lib$(GS).so
-GS_SONAME_MAJOR=$(GS_SONAME).$(GS_VERSION_MAJOR)
-GS_SONAME_MAJOR_MINOR= $(GS_SONAME).$(GS_VERSION_MAJOR).$(GS_VERSION_MINOR)
+GS_SONAME_MAJOR=$(GS_SONAME).$(LIBgs_VERSION:R)
+GS_SONAME_MAJOR_MINOR= $(GS_SONAME).$(LIBgs_VERSION)
 GS_SO=$(BINDIR)/$(GS_SONAME)
-GS_SO_MAJOR=$(GS_SO).$(GS_VERSION_MAJOR)
-GS_SO_MAJOR_MINOR=$(GS_SO_MAJOR).$(GS_VERSION_MINOR)
+GS_SO_MAJOR=$(GS_SO).$(LIBgs_VERSION:R)
+GS_SO_MAJOR_MINOR=$(GS_SO).$(LIBgs_VERSION)
 
 # Shared object is built by redefining GS_XE in a recursive make.
 
@@ -70,11 +70,11 @@ $(GSSOX_XE): $(GS_SO) $(GLSRC)dxmain.c
 	$(GLCC) -g `gtk-config --cflags` -o $(GSSOX_XE) $(GLSRC)dxmain.c -L$(BINDIR) -l$(GS) `gtk-config --libs`
 
 $(GSSOC_XE): $(GS_SO) $(GLSRC)dxmainc.c
-	$(GLCC) -g -o $(GSSOC_XE) $(GLSRC)dxmainc.c -L$(BINDIR) -l$(GS)
+	$(GLCC) -g -o $(GSSOC_XE) $(GLSRC)dxmainc.c -L$(BINDIR) -l$(GS) $(EXTRALIBS)
 
 # ------------------------- Recursive make targets ------------------------- #
 
-SODEFS=LDFLAGS='$(LDFLAGS) $(CFLAGS_SO) -shared -Wl,-soname,$(GS_SONAME_MAJOR)'\
+SODEFS=LDFLAGS='$(LDFLAGS) $(CFLAGS_SO) -shared '\
  GS_XE=$(BINDIR)/$(SOBINRELDIR)/$(GS_SONAME_MAJOR_MINOR)\
  STDIO_IMPLEMENTATION=c\
  DISPLAY_DEV=$(DD)$(SOOBJRELDIR)/display.dev\

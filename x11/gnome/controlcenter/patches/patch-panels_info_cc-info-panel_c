$OpenBSD: patch-panels_info_cc-info-panel_c,v 1.2 2011/09/27 12:15:23 ajacoutot Exp $

No PackageKit on OpenBSD.

--- panels/info/cc-info-panel.c.orig	Mon Sep 26 18:04:02 2011
+++ panels/info/cc-info-panel.c	Tue Sep 27 11:36:10 2011
@@ -23,7 +23,12 @@
 
 #include "cc-info-panel.h"
 
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
+#include <sys/param.h>
+#include <sys/mount.h>
+#else
 #include <sys/vfs.h>
+#endif
 #include <polkit/polkit.h>
 
 #include <glib.h>
@@ -1296,6 +1301,7 @@ on_pk_get_updates_ready (GObject      *source,
                          GAsyncResult *res,
                          CcInfoPanel  *self)
 {
+#ifndef __OpenBSD__
   GError     *error;
   GVariant   *result;
 
@@ -1307,6 +1313,9 @@ on_pk_get_updates_ready (GObject      *source,
       g_error_free (error);
       return;
     }
+#else
+  return;
+#endif
 }
 
 static void
@@ -1314,6 +1323,7 @@ on_pk_get_tid_ready (GObject      *source,
                      GAsyncResult *res,
                      CcInfoPanel  *self)
 {
+#ifndef __OpenBSD__
   GError     *error;
   GVariant   *result;
   char       *tid;
@@ -1360,6 +1370,9 @@ on_pk_get_tid_ready (GObject      *source,
                      NULL,
                      (GAsyncReadyCallback) on_pk_get_updates_ready,
                      self);
+#else
+  return;
+#endif
 }
 
 static void
@@ -1422,6 +1435,7 @@ cc_info_panel_init (CcInfoPanel *self)
 
   g_assert (self->priv->session_bus);
 
+#ifndef __OpenBSD__
   self->priv->pk_proxy = g_dbus_proxy_new_for_bus_sync (G_BUS_TYPE_SYSTEM,
                                                         G_DBUS_PROXY_FLAGS_NONE,
                                                         NULL,
@@ -1443,6 +1457,7 @@ cc_info_panel_init (CcInfoPanel *self)
                         self);
       refresh_updates (self);
     }
+#endif
 
   gtk_builder_add_from_file (self->priv->builder,
                              GNOMECC_UI_DIR "/info.ui",
@@ -1457,8 +1472,10 @@ cc_info_panel_init (CcInfoPanel *self)
 
   self->priv->graphics_data = get_graphics_data ();
 
+#ifndef __OpenBSD__
   widget = WID ("updates_button");
   g_signal_connect (widget, "clicked", G_CALLBACK (on_updates_button_clicked), self);
+#endif
 
   info_panel_setup_selector (self);
   info_panel_setup_overview (self);

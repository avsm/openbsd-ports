$OpenBSD: patch-src_yp_c,v 1.1 2005/04/16 15:37:31 sturm Exp $
--- src/yp.c.orig	Fri Dec 17 20:01:26 2004
+++ src/yp.c	Mon Mar  7 14:11:59 2005
@@ -365,6 +365,7 @@ static unsigned do_yp_touch (ypdata_t *y
     char *val, *artist, *title;
     int ret;
     char *max_listeners;
+    size_t songlen;
 
     artist = (char *)stats_get_value (yp->mount, "artist");
     title = (char *)stats_get_value (yp->mount, "title");
@@ -378,10 +379,11 @@ static unsigned do_yp_touch (ypdata_t *y
              separator = "";
          }
          if (title == NULL) title = strdup("");
-         song = malloc (strlen (artist) + strlen (title) + strlen (separator) +1);
+         songlen = strlen(artist) + strlen(title) + strlen(separator) + 1;
+         song = malloc(songlen);
          if (song)
          {
-             sprintf (song, "%s%s%s", artist, separator, title);
+             snprintf(song, songlen, "%s%s%s", artist, separator, title);
              add_yp_info(yp, "yp_currently_playing", song, YP_CURRENT_SONG);
              free (song);
          }

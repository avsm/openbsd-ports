$OpenBSD: patch-lib_common_c,v 1.2 2004/10/15 11:30:57 robert Exp $
--- lib/common.c.orig	Tue Jul  6 18:03:05 2004
+++ lib/common.c	Fri Oct 15 13:22:39 2004
@@ -1838,7 +1838,10 @@
   if (! path)
     return SASL_BADPARAM;
 
+  /* Honor external variable only in a safe environment */
+  if (getuid() == geteuid() && getgid() == getegid())
   *path = getenv(SASL_PATH_ENV_VAR);
+  
   if (! *path)
     *path = PLUGINDIR;
 

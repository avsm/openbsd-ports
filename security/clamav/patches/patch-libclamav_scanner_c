--- libclamav/scanners.c.orig	Sat Jul  1 05:58:56 2006
+++ libclamav/scanners.c	Fri Jul 28 02:28:02 2006
@@ -643,11 +643,6 @@ static int cli_scangzip(int desc, const 
 
 #ifdef HAVE_BZLIB_H
 
-#ifdef NOBZ2PREFIX
-#define BZ2_bzReadOpen bzReadOpen
-#define BZ2_bzReadClose bzReadClose
-#define BZ2_bzRead bzRead
-#endif
 
 static int cli_scanbzip(int desc, const char **virname, unsigned long int *scanned, const struct cl_node *root, const struct cl_limits *limits, unsigned int options, unsigned int arec, unsigned int mrec)
 {
@@ -668,7 +663,7 @@ static int cli_scanbzip(int desc, const 
 	if(limits->archivememlim)
 	    memlim = 1;
 
-    if((bfd = BZ2_bzReadOpen(&bzerror, fs, 0, memlim, NULL, 0)) == NULL) {
+    if((bfd = (BZFILE *)BZ2_bzReadOpen(&bzerror, fs, 0, memlim, NULL, 0)) == NULL) {
 	cli_dbgmsg("Bzip: Can't initialize bzip2 library (descriptor: %d).\n", desc);
 	fclose(fs);
 	return CL_EBZIP;

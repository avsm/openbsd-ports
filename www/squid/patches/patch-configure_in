$OpenBSD: patch-configure_in,v 1.27 2008/07/16 21:18:27 brad Exp $
--- configure.in.orig	Wed Jun 25 18:18:55 2008
+++ configure.in	Sun Jun 29 03:10:24 2008
@@ -2286,18 +2286,6 @@ dnl during compile.
 		;;
 esac
 
-# Remove optimization for GCC 2.95.[123]
-# gcc -O[2] on *BSD and Linux (x86) causes pointers to magically become NULL
-if test "$GCC" = "yes"; then
-	GCCVER=`$CC -v 2>&1 | awk '$2 ==  "version" {print $3}'`
-	case "$GCCVER" in
-	[2.95.[123]])
-		echo "Removing -O for gcc on $host with GCC $GCCVER"
-		CFLAGS="`echo $CFLAGS | sed -e 's/-O[[0-9]]*//'`"
-		;;
-	esac
-fi
-
 # Recommended by Balint Nagy Endre <bne@CareNet.hu>
 case "$host" in
 	*-univel-sysv4.2MP)
@@ -2836,12 +2824,14 @@ AC_ARG_WITH(maxfd,
     ;;
   esac
 ])
+
+TLDFLAGS="$LDFLAGS"
+
 if test -z "$SQUID_MAXFD"; then
 
 dnl Not cached since people are likely to tune this
 AC_MSG_CHECKING(Maximum number of filedescriptors we can open)
 dnl damn! FreeBSD's pthreads breaks dup2().
-TLDFLAGS="$LDFLAGS"
 case $host in
 i386-unknown-freebsd*)
     if echo "$LDFLAGS" | grep -q pthread; then

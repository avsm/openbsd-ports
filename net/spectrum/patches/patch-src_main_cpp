$OpenBSD: patch-src_main_cpp,v 1.1 2011/01/10 18:34:31 sebastia Exp $

fix for bug: http://spectrum.im/issues/131

--- src/main.cpp.orig	Tue Dec 28 17:58:40 2010
+++ src/main.cpp	Fri Jan  7 23:45:26 2011
@@ -1866,6 +1866,10 @@ void GlooxMessageHandler::onDisconnect(ConnectionError
 		m_userManager->removeAllUsers();
 
 	Log("gloox", "trying to reconnect after 1 second");
+	if (m_socketId > 0) {
+		purple_input_remove(m_socketId);
+		m_socketId = 0;
+	}
 	purple_timeout_add_seconds(1, &transportReconnect, NULL);
 
 // 	if (connectIO) {

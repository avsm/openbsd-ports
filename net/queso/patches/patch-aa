--- tcpip.c.orig	Mon Jul 26 23:34:24 1999
+++ tcpip.c	Mon Jul 26 23:39:18 1999
@@ -271,6 +271,7 @@
     switch(datalink) {
       case DLT_EN10MB:
         offset = 14; break;
+      case DLT_LOOP:
       case DLT_NULL:
       case DLT_PPP:
         offset =  4; break;
@@ -285,6 +286,8 @@
         offset =  8; break;
       case DLT_IEEE802:
         offset = 22; break;
+      case DLT_ENC:
+        offset = 12; break;
       default:
         fprintf(stderr, "unknown datalink type (%d)", datalink);
         return(0);

$OpenBSD: patch-src_backend_tcop_utility_c,v 1.1 2005/02/05 15:11:58 sturm Exp $
--- src/backend/tcop/utility.c.orig	Sat Feb  5 13:02:05 2005
+++ src/backend/tcop/utility.c	Sat Feb  5 13:03:10 2005
@@ -814,6 +814,8 @@ ProcessUtility(Node *parsetree,
 			{
 				LoadStmt   *stmt = (LoadStmt *) parsetree;
 
+				if (!superuser())
+					elog(ERROR, "permission denied");
 				closeAllVfds(); /* probably not necessary... */
 				load_file(stmt->filename);
 			}

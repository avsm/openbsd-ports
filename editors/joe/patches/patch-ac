--- b.c.orig	Fri Jan 20 01:38:25 1995
+++ b.c	Mon Aug 30 09:04:50 1999
@@ -21,6 +21,7 @@
 #include <pwd.h>
 #endif
 #include <errno.h>
+#include <sys/types.h>
 
 #include "config.h"
 #include "blocks.h"
@@ -1630,7 +1631,7 @@
    if(x==1)
     {
     char *z;
-    s=getenv("HOME");
+    s=(char *)getenv("HOME");
     z=vsncpy(NULL,0,sz(s));
     z=vsncpy(z,sLEN(z),sz(n+x));
     vsrm(n);
@@ -1990,6 +1991,7 @@
  {
  long tim=time(0);
  B *b;
+ mode_t mask=umask(077); /* no access to DEADJOE for others */
  FILE *f=fopen("DEADJOE","a");
  fprintf(f,"\n*** Modified files in JOE when it aborted on %s",ctime(&tim));
  if(sig) fprintf(f,"*** JOE was aborted by signal %d\n",sig);

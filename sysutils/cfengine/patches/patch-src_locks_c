$OpenBSD: patch-src_locks_c,v 1.2 2004/08/08 14:02:11 sturm Exp $
--- src/locks.c.orig	Tue May 18 02:37:46 2004
+++ src/locks.c	Mon Aug  2 13:30:35 2004
@@ -80,7 +80,7 @@ struct LockData
 void PreLockState()
 
 {
- strcpy(CFLOCK,"pre-lock-state");
+ (void)strlcpy(CFLOCK,"pre-lock-state",CF_BUFSIZE);
 }
 
 /********************************************************************/
@@ -88,7 +88,7 @@ void PreLockState()
 void SaveExecLock()
 
 {
- strcpy(SAVELOCK,CFLOCK);
+ (void)strlcpy(SAVELOCK,CFLOCK,CF_BUFSIZE);
 }
 
 
@@ -97,7 +97,7 @@ void SaveExecLock()
 void RestoreExecLock()
 
 {
- strcpy(CFLOCK,SAVELOCK);
+ (void)strlcpy(CFLOCK,SAVELOCK,CF_BUFSIZE);
 }
 
 /********************************************************************/
@@ -343,7 +343,7 @@ if (PutLock(CFLAST) == -1)
 
  
 LockLog(getpid(),"Lock removed normally ",CFLOCK,"");
-strcpy(CFLOCK,"no_active_lock");
+(void)strlcpy(CFLOCK,"no_active_lock",CF_BUFSIZE);
 }
 
 
@@ -668,7 +668,7 @@ if ((tim = time((time_t *)NULL)) == -1)
    Debug("Cfengine: couldn't read system clock\n");
    }
 
-sprintf(buffer,"%s",ctime(&tim));
+(void)snprintf(buffer,sizeof(buffer),"%s",ctime(&tim));
 
 Chop(buffer);
 

$OpenBSD: patch-common_dconf-shmdir_c,v 1.2 2010/10/27 11:38:58 ajacoutot Exp $
--- common/dconf-shmdir.c.orig	Mon Jul 26 16:10:20 2010
+++ common/dconf-shmdir.c	Wed Oct 27 00:26:56 2010
@@ -21,8 +21,14 @@
 
 #include "dconf-shmdir.h"
 
+#ifndef __OpenBSD__
 #include <sys/statfs.h>
 #include <sys/vfs.h>
+#else
+#include <string.h>
+#include <sys/param.h>
+#include <sys/mount.h>
+#endif
 #include <errno.h>
 
 #ifndef NFS_SUPER_MAGIC
@@ -48,7 +54,11 @@ is_local (const gchar *filename)
       while (s < 0 && errno == EINTR);
     }
 
+#ifndef __OpenBSD__
   return s == 0 && buf.f_type != NFS_SUPER_MAGIC;
+#else
+  return s == 0 && strcmp(buf.f_fstypename, MOUNT_NFS) != 0;
+#endif
 }
 
 gchar *

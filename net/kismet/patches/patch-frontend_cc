$OpenBSD: patch-frontend_cc,v 1.1 2006/11/01 21:13:19 kili Exp $

# From upstream SVN.

--- frontend.cc.orig	Wed Jun 29 20:04:43 2005
+++ frontend.cc	Fri Oct 20 15:38:06 2006
@@ -722,9 +722,8 @@ void Frontend::ReadGroupMap(FILE *in_fil
     snprintf(format, 64, "%%6[^:]: %%%d[^ ] %%1024[^\n]\n", MAC_STR_LEN);
 
     while (!feof(in_file)) {
-        fgets(dline, 8192, in_file);
-
-        if (feof(in_file)) break;
+        if (fgets(dline, 8192, in_file) == NULL ||
+	    feof(in_file)) break;
 
         // Fetch the line and continue if we're invalid...
         if (sscanf(dline, format, type, parm1, parm2) < 3)

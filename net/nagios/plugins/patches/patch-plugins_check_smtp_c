$OpenBSD: patch-plugins_check_smtp_c,v 1.1.1.1 2005/07/25 16:32:07 sturm Exp $
--- plugins/check_smtp.c.orig	Sat Jan  1 17:15:39 2005
+++ plugins/check_smtp.c	Mon Jul 18 22:55:58 2005
@@ -76,7 +76,7 @@ int my_close(void);
 char regex_expect[MAX_INPUT_BUFFER] = "";
 regex_t preg;
 regmatch_t pmatch[10];
-char timestamp[10] = "";
+char timestamp[20] = "";
 char errbuf[MAX_INPUT_BUFFER];
 int cflags = REG_EXTENDED | REG_NOSUB | REG_NEWLINE;
 int eflags = 0;
@@ -667,7 +667,7 @@ check_certificate (X509 ** certificate)
   
   days_left = (mktime (&stamp) - time (NULL)) / 86400;
   snprintf
-    (timestamp, 16, "%02d/%02d/%04d %02d:%02d",
+    (timestamp, sizeof(timestamp), "%02d/%02d/%04d %02d:%02d",
      stamp.tm_mon + 1,
      stamp.tm_mday, stamp.tm_year + 1900, stamp.tm_hour, stamp.tm_min);
   

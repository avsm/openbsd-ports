$OpenBSD: patch-src_proto_c,v 1.2 2004/08/08 14:02:11 sturm Exp $
--- src/proto.c.orig	Mon Jun 28 03:38:20 2004
+++ src/proto.c	Mon Aug  2 13:30:36 2004
@@ -132,8 +132,8 @@ if (!SKIPIDENTIFY && (strcmp(VDOMAIN,CF_
  
  if ((strstr(hp->h_name,".") == 0) && (strlen(VDOMAIN) > 0))
     {
-    strcat(dnsname,".");
-    strcat(dnsname,VDOMAIN);
+    (void)strlcat(dnsname,".",sizeof(dnsname));
+    (void)strlcat(dnsname,VDOMAIN,sizeof(dnsname));
     } 
 #endif 
  
@@ -145,14 +145,14 @@ uname = user_ptr ? user_ptr->pw_name : "
 if ((strlen(VDOMAIN) > 0) && !IsIPV6Address(dnsname) && !strchr(dnsname,'.'))
    {
    Debug("Appending domain %s to %s\n",VDOMAIN,dnsname);
-   strcat(dnsname,".");
+   (void)strlcat(dnsname,".",sizeof(dnsname));
    strncat(dnsname,VDOMAIN,CF_MAXVARSIZE/2);
    }  
 
 if (strncmp(dnsname,localip,strlen(localip)) == 0)
    {
    /* Seems to be a bug in some resolvers that adds garbage, when it just returns the input */
-   strcpy(dnsname,localip);
+   (void)strlcpy(dnsname,localip,sizeof(dnsname));
    }
 
  snprintf(sendbuff,CF_BUFSIZE-1,"CAUTH %s %s %s %d",localip,dnsname,uname,CFSIGNATURE);

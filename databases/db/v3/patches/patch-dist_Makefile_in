$OpenBSD: patch-dist_Makefile_in,v 1.4 2005/11/01 15:44:24 bernd Exp $
--- dist/Makefile.in.orig	Tue Jul 18 17:37:57 2000
+++ dist/Makefile.in	Tue Nov  1 13:02:45 2005
@@ -34,11 +34,11 @@ SOVERSION=	@DB_VERSION_MAJOR@.@DB_VERSIO
 libdb=		libdb.a
 
 libso_base=	libdb
-libso_linkname=	$(libso_base)-$(SOVERSION).la
-libso=		$(libso_base)-$(SOVERSION).@SOSUFFIX@
-libso_target=	$(libso_base)-$(SOVERSION).la
+libso_linkname=	$(libso_base).la
+libso=		$(libso_base).@SOSUFFIX@.$(SOVERSION)
+libso_target=	$(libso_base).la
 libso_default=	$(libso_base).@SOSUFFIX@
-libso_major=	$(libso_base)-$(SOMAJOR).@SOSUFFIX@
+libso_major=	$(libso_base).@SOSUFFIX@.$(SOMAJOR)
 
 ##################################################
 # C++
@@ -49,10 +49,10 @@ libso_major=	$(libso_base)-$(SOMAJOR).@S
 ##################################################
 libcxx=		libdb_cxx.a
 libxso_base=	libdb_cxx
-libxso=		$(libxso_base)-$(SOVERSION).@SOSUFFIX@
-libxso_target=	$(libxso_base)-$(SOVERSION).la
+libxso=		$(libxso_base).@SOSUFFIX@.$(SOVERSION)
+libxso_target=	$(libxso_base).la
 libxso_default=	$(libxso_base).@SOSUFFIX@
-libxso_major=	$(libxso_base)-$(SOMAJOR).@SOSUFFIX@
+libxso_major=	$(libxso_base).@SOSUFFIX@.$(SOMAJOR)
 
 ##################################################
 # JAVA
@@ -71,11 +71,11 @@ JAVA_DBDIR=	$(JAVA_SRCDIR)/com/sleepycat
 JAVA_EXDIR=	$(JAVA_SRCDIR)/com/sleepycat/examples
 
 libjso_base=	libdb_java
-libjso=		$(libjso_base)-$(SOVERSION).@SOSUFFIX@
-libjso_target=	$(libjso_base)-$(SOVERSION).la
+libjso=		$(libjso_base).@SOSUFFIX@.$(SOVERSION)
+libjso_target=	$(libjso_base).la
 libjso_default=	$(libjso_base).@SOSUFFIX@
-libjso_major=	$(libjso_base)-$(SOMAJOR).@SOSUFFIX@
-libjso_g=	$(libjso_base)-$(SOVERSION)_g.@SOSUFFIX@
+libjso_major=	$(libjso_base).@SOSUFFIX@.$(SOVERSION)
+libjso_g=	$(libjso_base)_g.@SOSUFFIX@.$(SOVERSION)
 
 ##################################################
 # TCL
@@ -86,10 +86,10 @@ libjso_g=	$(libjso_base)-$(SOVERSION)_g.
 ##################################################
 TCFLAGS=	@TCFLAGS@
 libtso_base=	libdb_tcl
-libtso=		$(libtso_base)-$(SOVERSION).@SOSUFFIX@
-libtso_target=	$(libtso_base)-$(SOVERSION).la
+libtso=		$(libtso_base).@SOSUFFIX@.$(SOVERSION)
+libtso_target=	$(libtso_base).la
 libtso_default=	$(libtso_base).@SOSUFFIX@
-libtso_major=	$(libtso_base)-$(SOMAJOR).@SOSUFFIX@
+libtso_major=	$(libtso_base).@SOSUFFIX@.$(SOMAJOR)
 
 ##################################################
 # DB_DUMP185 UTILITY
@@ -112,7 +112,8 @@ exec_prefix=@exec_prefix@
 bindir=	@bindir@
 includedir=@includedir@
 libdir=	@libdir@
-docdir=	$(prefix)/docs
+libsdir=	$(prefix)/lib
+docdir=	$(prefix)/share/doc/db
 
 dmode=	755
 emode=	555
@@ -398,7 +399,7 @@ install_include:
 	@test -d $(includedir) || \
 	    ($(mkdir) -p $(includedir) && $(chmod) $(dmode) $(includedir))
 	@cd $(includedir) && $(rm) -f db.h db_185.h db_cxx.h
-	@$(cp) -p db.h db_185.h $(srcdir)/include/db_cxx.h $(includedir)
+	@${BSD_INSTALL_DATA} -p db.h db_185.h $(srcdir)/include/db_cxx.h $(includedir)
 	@cd $(includedir) && $(chmod) $(fmode) db.h db_185.h db_cxx.h
 
 install_static: install_setup
@@ -424,9 +425,9 @@ install_dynamic: install_setup
 	@cd $(libdir) && \
 	    $(rm) -f $(libso) $(libso_default) $(libso_major)
 	@$(INSTALLER) $(libso_target) $(libdir)
+	@cd $(libsdir) && $(ln) -s db/$(libso)
 	@cd $(libdir) && $(ln) -s $(libso) $(libso_default)
 	@cd $(libdir) && $(ln) -s $(libso) $(libso_major)
-	@$(LIBTOOL) --mode=finish $(libdir)
 
 install_dynamic_cxx: install_setup
 	@echo "Installing DB C++ library: $(libdir) ..."
@@ -435,6 +436,7 @@ install_dynamic_cxx: install_setup
 	@cd $(libdir) && \
 	    $(rm) -f $(libxso) $(libxso_default) $(libxso_major)
 	@$(INSTALLER) $(libxso_target) $(libdir)
+	@cd $(libsdir) && $(ln) -s db/$(libxso)
 	@cd $(libdir) && $(ln) -s $(libxso) $(libxso_default)
 	@cd $(libdir) && $(ln) -s $(libxso) $(libxso_major)
 
@@ -445,6 +447,7 @@ install_tcl: install_setup
 	@cd $(libdir) && \
 	    $(rm) -f $(libtso) $(libtso_default) $(libtso_major)
 	@$(INSTALLER) $(libtso_target) $(libdir)
+	@cd $(libsdir) && $(ln) -s db/$(libtso)
 	@cd $(libdir) && $(ln) -s $(libtso) $(libtso_default)
 	@cd $(libdir) && $(ln) -s $(libtso) $(libtso_major)
 
@@ -465,13 +468,14 @@ install_docs: install_setup
 	    ($(mkdir) -p $(docdir) && $(chmod) $(dmode) $(docdir))
 	@cd $(docdir) && $(rm) -rf *
 	@cd $(srcdir)/docs && $(cp) -pr * $(docdir)/
+	@chown -R root:wheel $(docdir)/
 
 install_utilities: install_setup
 	@echo "Installing DB utilities: $(bindir) ..."
 	@test -d $(bindir) || \
 	    ($(mkdir) -p $(bindir) && $(chmod) $(dmode) $(bindir))
 	@cd $(bindir) && $(rm) -f $(PROGS)
-	@$(INSTALLER) -fp $(PROGS) $(bindir)
+	@$(INSTALLER) $(PROGS) $(bindir)
 	@cd $(bindir) && (test ! -f $(strip) || $(strip) $(PROGS))
 	@cd $(bindir) && $(chmod) $(emode) $(PROGS)
 

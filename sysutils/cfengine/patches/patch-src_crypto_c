$OpenBSD: patch-src_crypto_c,v 1.2 2004/10/01 21:22:15 sturm Exp $
--- src/crypto.c.orig	Wed Aug 11 22:55:51 2004
+++ src/crypto.c	Fri Oct  1 23:14:47 2004
@@ -49,11 +49,11 @@ snprintf(VBUFF,CF_BUFSIZE,"%s/randseed",
 
  if (stat(VBUFF,&statbuf) == -1)
     {
-    snprintf(AVDB,CF_BUFSIZE,"%s/%s",WORKDIR,CF_AVDB_FILE);
+    snprintf(AVDB,sizeof(AVDB),"%s/%s",WORKDIR,CF_AVDB_FILE);
     }
  else
     {
-    strcpy(AVDB,VBUFF);
+    (void)strlcpy(AVDB,VBUFF,sizeof(AVDB));
     }
 
 Verbose("Looking for a source of entropy in %s\n",AVDB);
@@ -294,7 +294,7 @@ snprintf(buffer,CF_BUFSIZE,"%d%d%25s",(i
 
 EVP_DigestUpdate(&context,buffer,CF_BUFSIZE);
 
-snprintf(pscomm,CF_BUFSIZE,"%s %s",VPSCOMM[VSYSTEMHARDCLASS],VPSOPTS[VSYSTEMHARDCLASS]);
+snprintf(pscomm,CF_MAXLINKSIZE,"%s %s",VPSCOMM[VSYSTEMHARDCLASS],VPSOPTS[VSYSTEMHARDCLASS]);
 
 if ((pp = cfpopen(pscomm,"r")) == NULL)
    {

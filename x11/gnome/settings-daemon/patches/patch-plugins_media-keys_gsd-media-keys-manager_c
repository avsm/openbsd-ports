$OpenBSD: patch-plugins_media-keys_gsd-media-keys-manager_c,v 1.3 2009/10/11 22:53:22 ajacoutot Exp $

- Give eject(1) a slightly bigger chance of actually doing something.
- Set the correct "sleep" command for apm(8).

--- plugins/media-keys/gsd-media-keys-manager.c.orig	Sun Oct 11 23:53:00 2009
+++ plugins/media-keys/gsd-media-keys-manager.c	Sun Oct 11 23:54:43 2009
@@ -64,7 +64,7 @@
 #define MAX_VOLUME 65536.0
 
 #if defined(__OpenBSD__)
-# define EJECT_COMMAND "eject -t /dev/cd0"
+# define EJECT_COMMAND "eject -t /dev/rcd0c"
 #else
 # define EJECT_COMMAND "eject -T"
 #endif
@@ -896,6 +896,11 @@ do_action (GsdMediaKeysManager *manager,
                 break;
         case SLEEP_KEY:
                 do_sleep_action (SLEEP_COMMAND, "xset dpms force off");
+#if defined(__OpenBSD__) || defined(__FreeBSD__)
+                do_sleep_action ("zzz", "xset dpms force off");
+#else
+                do_sleep_action ("apm", "xset dpms force off");
+#endif
                 break;
         case SCREENSAVER_KEY:
                 if ((cmd = g_find_program_in_path ("gnome-screensaver-command"))) {

$OpenBSD: patch-configure,v 1.4.2.2 2006/12/13 22:44:12 sturm Exp $
--- configure.orig	Sun Nov  5 17:09:20 2006
+++ configure	Wed Dec 13 23:43:10 2006
@@ -11838,11 +11838,11 @@ cat >>conftest.$ac_ext <<_ACEOF
 #ifdef __cplusplus
 extern "C"
 #endif
-char bzReadOpen ();
+char BZ2_bzReadOpen ();
 int
 main ()
 {
-return bzReadOpen ();
+return BZ2_bzReadOpen ();
   ;
   return 0;
 }
@@ -12258,6 +12258,8 @@ cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
+#include <sys/types.h>
+#include <netinet/in.h>
 #include <resolv.h>
 _ACEOF
 rm -f conftest.$ac_objext
@@ -13319,13 +13321,9 @@ _ACEOF
 openbsd*)
     if test "$have_pthreads" = "yes"; then
 	LIBCLAMAV_LIBS="$LIBCLAMAV_LIBS -pthread"
-	if test "$use_cr" = "no"; then
-	    CLAMD_LIBS="$CLAMD_LIBS -pthread"
-	    CLAMAV_MILTER_LIBS="$CLAMAV_MILTER_LIBS -pthread"
-	else
-	    CLAMD_LIBS="$CLAMD_LIBS -pthread -lc_r"
-	    CLAMAV_MILTER_LIBS="$CLAMAV_MILTER_LIBS -pthread -lc_r"
-	fi
+	ADDITIONAL_LIBS="-pthread"
+	CLAMD_LIBS="$CLAMD_LIBS -pthread"
+	CLAMAV_MILTER_LIBS="$CLAMAV_MILTER_LIBS -pthread"
 	TH_SAFE="-thread-safe"
 
 cat >>confdefs.h <<\_ACEOF
@@ -14523,6 +14521,7 @@ cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
+#include <sys/types.h>
 #include <tcpd.h>
 int allow_severity = 0;
 int deny_severity  = 0;
@@ -14591,6 +14590,7 @@ cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
+#include <sys/types.h>
 #include <tcpd.h>
 int allow_severity = 0;
 int deny_severity  = 0;

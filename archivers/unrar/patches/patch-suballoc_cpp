$OpenBSD: patch-suballoc_cpp,v 1.3 2007/06/26 19:47:59 rui Exp $
--- suballoc.cpp.orig	Tue May 22 06:03:02 2007
+++ suballoc.cpp	Mon Jun 25 19:34:54 2007
@@ -31,10 +31,16 @@ inline void* SubAllocator::RemoveNode(int indx) 
   return RetVal;
 }
 
+#define PAD		__alignof__(void *)
+#define ROUND(v)	((v) & (PAD - 1) ? ((v) + PAD) & ~(PAD - 1) : (v))
 
 inline uint SubAllocator::U2B(int NU) 
 { 
+#ifndef __STRICT_ALIGNMENT
   return /*8*NU+4*NU*/UNIT_SIZE*NU;
+#else
+  return (ROUND(UNIT_SIZE * NU));
+#endif /* !__STRICT_ALIGNMENT */
 }
 
 

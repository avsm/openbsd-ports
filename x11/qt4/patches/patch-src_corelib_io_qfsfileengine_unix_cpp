$OpenBSD: patch-src_corelib_io_qfsfileengine_unix_cpp,v 1.4 2007/03/17 17:58:17 espie Exp $
--- src/corelib/io/qfsfileengine_unix.cpp.orig	Wed Feb 21 10:58:42 2007
+++ src/corelib/io/qfsfileengine_unix.cpp	Sat Mar 17 10:47:27 2007
@@ -580,13 +580,13 @@ uint QFSFileEngine::ownerId(FileOwner own) const
 
 QString QFSFileEngine::owner(FileOwner own) const
 {
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
     QVarLengthArray<char, 1024> buf(sysconf(_SC_GETPW_R_SIZE_MAX));
 #endif
 
     if(own == OwnerUser) {
         struct passwd *pw = 0;
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
         struct passwd entry;
         getpwuid_r(ownerId(own), &entry, buf.data(), buf.size(), &pw);
 #else
@@ -596,7 +596,7 @@ QString QFSFileEngine::owner(FileOwner own) const
             return QFile::decodeName(QByteArray(pw->pw_name));
     } else if(own == OwnerGroup) {
         struct group *gr = 0;
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
         buf.resize(sysconf(_SC_GETGR_R_SIZE_MAX));
         struct group entry;
         getgrgid_r(ownerId(own), &entry, buf.data(), buf.size(), &gr);

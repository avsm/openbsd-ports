$OpenBSD: patch-configure,v 1.32 2005/04/09 22:06:19 pvalchev Exp $
--- configure.orig	Thu Dec 23 08:36:00 2004
+++ configure	Sat Apr  9 01:51:28 2005
@@ -465,6 +465,9 @@ if test -z "$_target" ; then
         if [ "`$_cc -dumpmachine | grep x86_64 | cut -d- -f1`" = "x86_64" -a \
              -z "`echo $CFLAGS | grep -- -m32`"  ]; then
           host_arch=x86_64
+        elif [ "`$_cc -dumpmachine | grep amd64 | cut -d- -f1`" = "amd64" -a \
+              -z "`echo $CFLAGS | grep -- -m32`"  ]; then
+          host_arch=x86_64
         else
           host_arch=i386
         fi
@@ -700,10 +703,15 @@ fi
 
 x86_exts_check()
 {
+  case $host_arch in
+  x86_64) pparam="3dnow 3dnowext mmx mmxext xmm sse2"
+    ;;
+  *)
   pparam=`$_cpuinfo | grep 'features' | cut -d ':' -f 2 | _head 1`
   if test -z "$pparam" ; then
     pparam=`$_cpuinfo | grep 'flags' | cut -d ':' -f 2 | _head 1`
   fi
+  esac
 
   _mmx=no
   _3dnow=no
@@ -2180,7 +2188,7 @@ echores "$_setlocale"
 
 
 echocheck "iconv"
-if test "$_iconv" = auto ; then
+if test "$_iconv" != no ; then
   _iconv_tmp='#include <iconv.h>'
 
   cat > $TMPC << EOF
@@ -4659,7 +4667,7 @@ echores "$_sgiaudio"
 
 
 echocheck "VCD support"
-if linux || bsdos || freebsd || netbsd || sunos || darwin ; then
+if linux || bsdos || freebsd || netbsd || sunos || darwin || openbsd ; then
   _inputmodules="vcd $_inputmodules"
   _def_vcd='#define HAVE_VCD 1'
   echores "ok"
@@ -6607,7 +6615,7 @@ CACA_LIB = $_ld_caca
 # audio output
 ALSA_LIB = $_ld_alsa
 NAS_LIB = $_ld_nas
-ARTS_LIB = $_ld_arts
+ARTS_LIB = $_ld_arts -lstdc++
 ARTS_INC = $_inc_arts
 ESD_LIB = $_ld_esd
 ESD_INC = $_inc_esd
@@ -6877,7 +6885,7 @@ $_def_malloc
 $_def_memalign
 #ifndef HAVE_MEMALIGN
 # define memalign(a,b) malloc(b)
-#define MEMALIGN_HACK 1
+/* #define MEMALIGN_HACK 1 */
 #endif
 
 /* Define this if your system has the "alloca.h" header file */

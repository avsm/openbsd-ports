$OpenBSD: patch-telepathy-glib_Makefile_in,v 1.3 2010/10/25 12:38:32 jasper Exp $

- For some reason on mips64(el), nm doesn't create the _gen/abi.nm file,
but returns 1. This patch lets the build continue.

- Be sure to use the correct libtool.

--- telepathy-glib/Makefile.in.orig	Mon Sep 20 19:33:48 2010
+++ telepathy-glib/Makefile.in	Mon Oct 25 14:32:28 2010
@@ -1470,7 +1470,7 @@ check-local: check-coding-style
 @HAVE_LD_VERSION_SCRIPT_TRUE@	diff -c _gen/versioned-abi.txt _gen/abi.txt
 
 @HAVE_LD_VERSION_SCRIPT_TRUE@_gen/abi.txt: libtelepathy-glib-internal.la abi.am
-@HAVE_LD_VERSION_SCRIPT_TRUE@	$(NM) .libs/libtelepathy-glib-internal.a > _gen/abi.nm
+@HAVE_LD_VERSION_SCRIPT_TRUE@	$(NM) .libs/libtelepathy-glib-internal.a > _gen/abi.nm || true
 @HAVE_LD_VERSION_SCRIPT_TRUE@	grep " [DT] " < _gen/abi.nm > _gen/abi.funcs
 @HAVE_LD_VERSION_SCRIPT_TRUE@	cut -d" " -f3 < _gen/abi.funcs > _gen/abi.funcnames
 @HAVE_LD_VERSION_SCRIPT_TRUE@	grep "^tp" < _gen/abi.funcnames > _gen/abi.tpfuncnames
@@ -1650,7 +1650,7 @@ _gen/tp-cli-%-body.h _gen/tp-cli-%.h: _gen/tp-spec-%.x
 @HAVE_INTROSPECTION_TRUE@		-I$(top_srcdir) \
 @HAVE_INTROSPECTION_TRUE@		--include=GLib-2.0 \
 @HAVE_INTROSPECTION_TRUE@		--include=Gio-2.0 \
-@HAVE_INTROSPECTION_TRUE@		--libtool="$(top_builddir)/libtool" \
+@HAVE_INTROSPECTION_TRUE@		--libtool="${LIBTOOL}" \
 @HAVE_INTROSPECTION_TRUE@		--library=libtelepathy-glib.la \
 @HAVE_INTROSPECTION_TRUE@		--pkg gio-2.0 \
 @HAVE_INTROSPECTION_TRUE@		--pkg dbus-glib-1 \
@@ -1661,7 +1661,7 @@ _gen/tp-cli-%-body.h _gen/tp-cli-%.h: _gen/tp-spec-%.x
 @HAVE_INTROSPECTION_TRUE@	@rm -f _gen/$@.tmp
 
 @HAVE_INTROSPECTION_TRUE@%.typelib: %.gir $(INTROSPECTION_COMPILER)
-@HAVE_INTROSPECTION_TRUE@	$(AM_V_GEN)$(top_builddir)/libtool --mode=execute \
+@HAVE_INTROSPECTION_TRUE@	${LIBTOOL} --mode=execute \
 @HAVE_INTROSPECTION_TRUE@	    $(INTROSPECTION_COMPILER) \
 @HAVE_INTROSPECTION_TRUE@	        --includedir=$(srcdir) \
 @HAVE_INTROSPECTION_TRUE@	        --includedir=. \

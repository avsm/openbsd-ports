--- listener.c.orig	Thu Oct 21 01:35:49 1999
+++ listener.c	Thu Oct 21 01:37:24 1999
@@ -77,7 +77,8 @@
     /*
      *  Read packets from the pcap device.
      */
-    for (;packet = GET_RAW(fp->pd, &pc_hdr);)
+    for (;;) {
+      if ((packet = GET_RAW(fp->pd, &pc_hdr)))
     {
         /*
          *  Align the IP header beyond the link header.
@@ -106,6 +107,7 @@
             default:
                 continue;
         }
+    }
     }
     destroy_listener(fp);
     exit(0);

$OpenBSD: patch-sysdeps_common_fsusage_c,v 1.5 2011/06/22 15:30:01 jasper Exp $

commit 93829c8cbb6c719266dd522f7d1cf76afff0f4a8
Author: Jasper Lievisse Adriaanse <jasper@humppa.nl>
Date:   Wed Jun 22 17:24:37 2011 +0200

    Fix filesystem read/write accounting on OpenBSD
    
    https://bugzilla.gnome.org/show_bug.cgi?id=652980

--- sysdeps/common/fsusage.c.orig	Mon Mar 14 23:08:03 2011
+++ sysdeps/common/fsusage.c	Tue May 31 20:50:38 2011
@@ -149,6 +149,15 @@ _glibtop_freebsd_get_fsusage_read_write(glibtop *serve
 #define _glibtop_get_fsusage_read_write(S, B, P) \
 	_glibtop_freebsd_get_fsusage_read_write(S, B, P)
 
+#elif defined(__OpenBSD__)
+void
+_glibtop_openbsd_get_fsusage_read_write(glibtop *server,
+					glibtop_fsusage *buf,
+					const char *path);
+
+#define _glibtop_get_fsusage_read_write(S, B, P) \
+	_glibtop_openbsd_get_fsusage_read_write(S, B, P)
+
 #else /* default fallback */
 #warning glibtop_get_fsusage .read .write are not implemented.
 static inline void
@@ -270,7 +279,7 @@ glibtop_get_fsusage_s (glibtop *server, glibtop_fsusag
     return;
 
 #if (defined(sun) || defined(__sun)) && (defined(__SVR4) || defined(__svr4__)) \
-	|| defined(__FreeBSD__)
+	|| defined(__FreeBSD__) || defined(__OpenBSD__)
   /* Solaris but not SunOS and FreeBSD */
   buf->block_size = fsd.f_frsize;
 #else

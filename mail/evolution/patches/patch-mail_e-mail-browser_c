$OpenBSD: patch-mail_e-mail-browser_c,v 1.1 2010/06/15 10:51:38 ajacoutot Exp $

From pstream GIT 4a2343cb34498c701e71679e3c50c9fc81dd5b80
Bug 618902 - Crash when viewing/closing messages quickly
Closing an EMailBrowser window causes it to be disposed immediately, but
ongoing async operations still hold an EMailBrowser reference -- in
particular, regenerating the internal message list and fetching a mail
message. The callback functions for these operations were not equipped
to deal with the disposed-but-not-yet-finalized object.

--- mail/e-mail-browser.c.orig	Tue Apr 27 13:43:02 2010
+++ mail/e-mail-browser.c	Tue Jun 15 09:19:15 2010
@@ -446,7 +446,8 @@ mail_browser_dispose (GObject *object)
 	}
 
 	if (priv->message_list != NULL) {
-		g_object_unref (priv->message_list);
+		/* This will cancel a regen operation. */
+		gtk_widget_destroy (priv->message_list);
 		priv->message_list = NULL;
 	}
 

$OpenBSD: patch-src_dynamic-plugins_sf_dynamic_plugins_c,v 1.4 2009/08/16 13:31:27 rui Exp $
--- src/dynamic-plugins/sf_dynamic_plugins.c.orig	Mon Jan 26 22:50:08 2009
+++ src/dynamic-plugins/sf_dynamic_plugins.c	Wed Apr  8 12:40:35 2009
@@ -233,8 +233,7 @@ void LoadAllLibs(char *path, LoadLibraryFunc loadFunc)
         dirEntry = readdir(directory);
         while (dirEntry)
         {
-            if (dirEntry->d_reclen &&
-                !fnmatch(EXT, dirEntry->d_name, FNM_PATHNAME | FNM_PERIOD))
+                if(!fnmatch(EXT, dirEntry->d_name, FNM_PATHNAME | FNM_PERIOD))
             {
                 SnortSnprintf(path_buf, PATH_MAX, "%s%s%s", path, "/", dirEntry->d_name);
                 loadFunc(path_buf, 1);

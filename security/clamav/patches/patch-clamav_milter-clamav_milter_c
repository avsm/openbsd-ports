--- clamav-milter/clamav-milter.c.orig	Wed Dec 12 23:41:25 2007
+++ clamav-milter/clamav-milter.c	Tue Dec 18 10:18:09 2007
@@ -1126,7 +1126,7 @@ main(int argc, char **argv)
 		 * uid == 0 for that
 		 */
 		on = 1;
-		if(setsockopt(broadcastSock, SOL_SOCKET, SO_BROADCAST, (int *)&on, sizeof(on)) < 0) {
+		if(setsockopt(broadcastSock, SOL_SOCKET, 0, (int *)&on, sizeof(on)) < 0) {
 			perror("setsockopt");
 			return EX_UNAVAILABLE;
 		}
@@ -1148,7 +1148,7 @@ main(int argc, char **argv)
 
 			memset(&ifr, '\0', sizeof(struct ifreq));
 			strncpy(ifr.ifr_name, iface, sizeof(ifr.ifr_name) - 1);
-			if(setsockopt(broadcastSock, SOL_SOCKET, SO_BINDTODEVICE, &ifr, sizeof(ifr)) < 0) {
+			if(setsockopt(broadcastSock, SOL_SOCKET, 0, &ifr, sizeof(ifr)) < 0) {
 				perror(iface);
 				return EX_CONFIG;
 			}

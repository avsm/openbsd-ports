$OpenBSD: patch-sys_sunaudio_gstsunaudiosink_c,v 1.5 2009/11/29 09:17:38 ajacoutot Exp $
--- sys/sunaudio/gstsunaudiosink.c.orig	Tue May 12 02:00:07 2009
+++ sys/sunaudio/gstsunaudiosink.c	Mon Nov 23 18:28:12 2009
@@ -41,7 +41,6 @@
 
 #include <fcntl.h>
 #include <string.h>
-#include <stropts.h>
 #include <unistd.h>
 #include <sys/mman.h>
 
@@ -316,13 +315,14 @@ gst_sunaudiosink_open (GstAudioSink * asink)
       sunaudiosink->info.monitor_gain);
   GST_DEBUG_OBJECT (sunaudiosink, "output_muted %d",
       sunaudiosink->info.output_muted);
+#ifndef __OpenBSD__
   GST_DEBUG_OBJECT (sunaudiosink, "hw_features %08x",
       sunaudiosink->info.hw_features);
   GST_DEBUG_OBJECT (sunaudiosink, "sw_features %08x",
       sunaudiosink->info.sw_features);
   GST_DEBUG_OBJECT (sunaudiosink, "sw_features_enabled %08x",
       sunaudiosink->info.sw_features_enabled);
-
+#endif
   return TRUE;
 
 open_failed:
@@ -617,7 +617,7 @@ gst_sunaudiosink_reset (GstAudioSink * asink)
   }
 
   /* Flush the audio */
-  ret = ioctl (sunaudiosink->fd, I_FLUSH, FLUSHW);
+  ret = ioctl (sunaudiosink->fd, AUDIO_FLUSH);
   if (ret == -1) {
     GST_ELEMENT_ERROR (sunaudiosink, RESOURCE, SETTINGS, (NULL), ("%s",
             strerror (errno)));
@@ -632,7 +632,7 @@ gst_sunaudiosink_reset (GstAudioSink * asink)
 
   g_cond_signal (sunaudiosink->sleep_cond);
 
-  ret = ioctl (sunaudiosink->fd, I_FLUSH, FLUSHW);
+  ret = ioctl (sunaudiosink->fd, AUDIO_FLUSH);
   if (ret == -1) {
     GST_ELEMENT_ERROR (sunaudiosink, RESOURCE, SETTINGS, (NULL), ("%s",
             strerror (errno)));

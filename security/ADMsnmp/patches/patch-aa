*** snmp.c-orig	Wed Feb 17 02:20:05 1999
--- snmp.c	Sun Mar 14 13:27:11 1999
***************
*** 33,38 ****
--- 33,40 ----
  #include <sys/stat.h>
  #include <netdb.h>
  #include <netinet/in.h>
+ #include <sys/types.h>
+ #include <sys/socket.h>
  
  
  struct snmpchex
***************
*** 239,246 ****
  
  			    return (i + 2);
  			  }
! 			else
  			  return (-1);
  		  }
  	    }
        }
--- 241,249 ----
  
  			    return (i + 2);
  			  }
! 			else {
  			  return (-1);
+ 			}
  		  }
  	    }
        }
***************
*** 300,306 ****
    memset (buf, 0, sizeofbuf);
    i = getreq (buf, namez, GETREQ_SYSDEC, id, set_req);
    memcpy ((buf + i), sysdec, GETREQ_SYSDEC);
!   return (sendto (sock, buf, i + GETREQ_SYSDEC, 0, sin, sizeof (struct sockaddr_in)));
  }
  
  /** getreq paket **/
--- 303,309 ----
    memset (buf, 0, sizeofbuf);
    i = getreq (buf, namez, GETREQ_SYSDEC, id, set_req);
    memcpy ((buf + i), sysdec, GETREQ_SYSDEC);
!   return (sendto (sock, buf, i + GETREQ_SYSDEC, 0, (const struct sockaddr *)sin, sizeof (struct sockaddr_in)));
  }
  
  /** getreq paket **/
***************
*** 460,466 ****
        i = 0;
        /** we get an answer !!!! */
        
!       if ((i = recvfrom (sock, (char *) &buf, sizeof (buf), 0, &sin, &x)) > 0)
  	{
  	  nd = 0;
  	 /** extract the ID the return code and the community name **/
--- 463,469 ----
        i = 0;
        /** we get an answer !!!! */
        
!       if ((i = recvfrom (sock, (char *) &buf, sizeof (buf), 0, (struct sockaddr *)&sin, &x)) > 0)
  	{
  	  nd = 0;
  	 /** extract the ID the return code and the community name **/
***************
*** 581,587 ****
        printf ("cant resolve hostname!\n");
        exit (-1);
      }
!   opz.wordfile = strdup ("snmp.passwd");
    opz.outputfile = NULL;
    opz.guess = -1;
    opz.manysend = 2;
--- 584,590 ----
        printf ("cant resolve hostname!\n");
        exit (-1);
      }
!   opz.wordfile = strdup ("/usr/local/etc/ADMsnmp.passwd");
    opz.outputfile = NULL;
    opz.guess = -1;
    opz.manysend = 2;

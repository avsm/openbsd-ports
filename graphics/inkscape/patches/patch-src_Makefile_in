$OpenBSD: patch-src_Makefile_in,v 1.1.1.1 2008/04/04 14:37:26 landry Exp $
--- src/Makefile.in.orig	Tue Mar 11 05:47:10 2008
+++ src/Makefile.in	Sun Mar 30 20:58:16 2008
@@ -77,7 +77,7 @@
 # repaced with (wrapper of?) DOM
 #
 
-
+GLIB_GENMARSHAL = @GLIB_GENMARSHAL@
 VPATH = @srcdir@
 pkgdatadir = $(datadir)/@PACKAGE@
 pkglibdir = $(libdir)/@PACKAGE@
@@ -7282,16 +7282,10 @@ helper/clean:
 
 helper/unit-menu.$(OBJEXT): helper/sp-marshal.h
 
-# TODO: Check that the generated sp-marshal.h is the same as before.
-helper/sp-marshal.h: helper/sp-marshal.list
-	glib-genmarshal --prefix=sp_marshal --header $(srcdir)/helper/sp-marshal.list > helper/tmp.$$$$	\
-	 && mv helper/tmp.$$$$ helper/sp-marshal.h
-
-helper/sp-marshal.cpp: helper/sp-marshal.list helper/sp-marshal.h
-	( echo '#include "helper/sp-marshal.h"' &&	\
-	  glib-genmarshal --prefix=sp_marshal --body $(srcdir)/helper/sp-marshal.list )	\
-	 > helper/tmp.$$$$	\
-	 && mv helper/tmp.$$$$ helper/sp-marshal.cpp
+helper/sp-marshal.h: helper/sp-marshal.list $(GLIB_GENMARSHAL)
+	$(GLIB_GENMARSHAL) $< --header --prefix=sp_marshal > $@
+helper/sp-marshal.c: helper/sp-marshal.list $(GLIB_GENMARSHAL)
+	$(GLIB_GENMARSHAL) $< --body --prefix=sp_marshal > $@
 
 helper/sp-marshal.cpp helper/sp-marshal.h: Makefile
 

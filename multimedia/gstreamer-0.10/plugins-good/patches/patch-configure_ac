$OpenBSD: patch-configure_ac,v 1.8 2009/11/29 09:17:38 ajacoutot Exp $
--- configure.ac.orig	Mon Nov 23 18:19:53 2009
+++ configure.ac	Mon Nov 23 18:22:26 2009
@@ -456,6 +456,8 @@ AG_GST_CHECK_FEATURE(GST_V4L2, [Video 4 Linux 2], v4l2
 #ifdef __sun /* Solaris */
 #include <sys/types.h>
 #include <sys/videodev2.h>
+#elif defined __OpenBSD__
+#include <sys/videoio.h>
 #else /* Linux */
 #include <linux/types.h>
 #define _LINUX_TIME_H
@@ -497,6 +499,8 @@ return 0;
 #ifdef __sun /* Solaris */
 #include <sys/types.h>
 #include <sys/videodev2.h>
+#elif defined __OpenBSD__
+#include <sys/videoio.h>
 #else /* Linux */
 #include <linux/types.h>
 #define _LINUX_TIME_H
@@ -681,6 +685,21 @@ AG_GST_CHECK_FEATURE(ESD, [ESounD sound daemon], esdsi
   fi
 ])
 
+dnl *** libsndio ***
+translit(dnm, m, l) AM_CONDITIONAL(USE_LIBSNDIO, true)
+AG_GST_CHECK_FEATURE(LIBSNDIO, [libsndio audio], libsndio, [
+  AC_CHECK_HEADER(sndio.h, HAVE_LIBSNDIO="yes", HAVE_LIBSNDIO="no")
+  if test $HAVE_LIBSNDIO = yes
+  then
+    AC_CHECK_LIB(sndio, sio_open, HAVE_LIBSNDIO="yes", HAVE_LIBSNDIO="no", [])
+    if test $HAVE_LIBSNDIO = yes
+    then
+      LIBSNDIO_LIBS=-lsndio
+      AC_SUBST(LIBSNDIO_LIBS)
+    fi
+  fi
+])
+
 dnl *** FLAC ***
 translit(dnm, m, l) AM_CONDITIONAL(USE_FLAC, true)
 AG_GST_CHECK_FEATURE(FLAC, [FLAC lossless audio], flac, [
@@ -749,7 +768,7 @@ AG_GST_CHECK_FEATURE(LIBDV, [libdv DV demuxer/decoder]
 dnl *** libpng ***
 translit(dnm, m, l) AM_CONDITIONAL(USE_LIBPNG, true)
 AG_GST_CHECK_FEATURE(LIBPNG, [Portable Network Graphics library], png, [
-  AG_GST_PKG_CHECK_MODULES(LIBPNG, libpng12)
+  AG_GST_PKG_CHECK_MODULES(LIBPNG, libpng)
 ])
 
 dnl *** pulseaudio ***
@@ -962,6 +981,7 @@ AM_CONDITIONAL(USE_CAIRO, false)
 AM_CONDITIONAL(USE_DIRECTSOUND, false)
 AM_CONDITIONAL(USE_DV1394, false)
 AM_CONDITIONAL(USE_ESD, false)
+AM_CONDITIONAL(USE_LIBSNDIO, false)
 AM_CONDITIONAL(USE_FLAC, false)
 AM_CONDITIONAL(USE_GCONF, false)
 AM_CONDITIONAL(USE_GCONFTOOL, false)
@@ -1098,6 +1118,7 @@ ext/annodex/Makefile
 ext/cairo/Makefile
 ext/dv/Makefile
 ext/esd/Makefile
+ext/libsndio/Makefile
 ext/flac/Makefile
 ext/gconf/Makefile
 ext/gdk_pixbuf/Makefile

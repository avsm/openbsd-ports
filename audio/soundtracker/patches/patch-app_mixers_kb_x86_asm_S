$OpenBSD: patch-app_mixers_kb_x86_asm_S,v 1.1.1.1 2002/02/05 18:04:10 espie Exp $
--- app/mixers/kb-x86-asm.S.orig	Sun Sep 24 09:50:51 2000
+++ app/mixers/kb-x86-asm.S	Thu Jan 31 08:55:03 2002
@@ -24,6 +24,16 @@
  *
  */
 
+#ifndef _C_LABEL
+# ifdef __ELF__
+#  define _C_LABEL(x) x
+# else
+#  define _C_LABEL(x) _ ## x
+# endif
+#endif
+#undef GLOBAL
+#define GLOBAL(x)   .globl _C_LABEL(x); _C_LABEL(x):
+
 #if defined(__i386__)
 
 .section	.data
@@ -53,8 +63,7 @@ minuseins:	.float -1.0
 			
 .text
 
-.globl kbasm_post_mixing
-kbasm_post_mixing:
+GLOBAL(kbasm_post_mixing)
 	pushl	%ebp
 	movl	%esp, %ebp
 
@@ -129,8 +138,7 @@ clipstereo:	// convert/clip samples, 16b
 	fstp	%st		// -
 	ret
 
-.globl kbasm_mix
-kbasm_mix:
+GLOBAL(kbasm_mix)
 	pushl	%ebp
 	movl	%esp, %ebp
 
@@ -360,8 +368,7 @@ kbasm_mix_cubic_scopes_filtered_backward
 	CUBICMIXER 1 1 1 1
 
 .section	.data
-.globl kbasm_mixers
-kbasm_mixers:
+GLOBAL(kbasm_mixers)
 	.long kbasm_mix_cubic_noscopes_unfiltered_forward_noramp
 	.long kbasm_mix_cubic_noscopes_unfiltered_backward_noramp
 	.long kbasm_mix_cubic_noscopes_filtered_forward_noramp

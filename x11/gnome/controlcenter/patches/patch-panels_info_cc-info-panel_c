$OpenBSD: patch-panels_info_cc-info-panel_c,v 1.1.1.1 2011/09/12 07:29:31 ajacoutot Exp $

No PackageKit on OpenBSD.

--- panels/info/cc-info-panel.c.orig	Tue May 24 10:36:24 2011
+++ panels/info/cc-info-panel.c	Wed Jun  1 13:01:22 2011
@@ -23,7 +23,12 @@
 
 #include "cc-info-panel.h"
 
+#if defined(__FreeBSD__) || defined(__OpenBSD__)
+#include <sys/param.h>
+#include <sys/mount.h>
+#else
 #include <sys/vfs.h>
+#endif
 
 #include <glib.h>
 #include <glib/gi18n.h>
@@ -1123,6 +1128,7 @@ on_pk_get_updates_ready (GObject      *source,
                          GAsyncResult *res,
                          CcInfoPanel  *self)
 {
+#ifndef __OpenBSD__
   GError     *error;
   GVariant   *result;
 
@@ -1134,6 +1140,9 @@ on_pk_get_updates_ready (GObject      *source,
       g_error_free (error);
       return;
     }
+#else
+  return;
+#endif
 }
 
 static void
@@ -1141,6 +1150,7 @@ on_pk_get_tid_ready (GObject      *source,
                      GAsyncResult *res,
                      CcInfoPanel  *self)
 {
+#ifndef __OpenBSD__
   GError     *error;
   GVariant   *result;
   char       *tid;
@@ -1186,6 +1196,9 @@ on_pk_get_tid_ready (GObject      *source,
                      NULL,
                      (GAsyncReadyCallback) on_pk_get_updates_ready,
                      self);
+#else
+  return;
+#endif
 }
 
 static void
@@ -1247,6 +1260,7 @@ cc_info_panel_init (CcInfoPanel *self)
 
   g_assert (self->priv->session_bus);
 
+#ifndef __OpenBSD__
   self->priv->pk_proxy = g_dbus_proxy_new_for_bus_sync (G_BUS_TYPE_SYSTEM,
                                                         G_DBUS_PROXY_FLAGS_NONE,
                                                         NULL,
@@ -1265,6 +1279,7 @@ cc_info_panel_init (CcInfoPanel *self)
                         self);
       refresh_updates (self);
     }
+#endif
 
   gtk_builder_add_from_file (self->priv->builder,
                              GNOMECC_UI_DIR "/info.ui",
@@ -1279,8 +1294,10 @@ cc_info_panel_init (CcInfoPanel *self)
 
   self->priv->graphics_data = get_graphics_data ();
 
+#ifndef __OpenBSD__
   widget = WID (self->priv->builder, "updates_button");
   g_signal_connect (widget, "clicked", G_CALLBACK (on_updates_button_clicked), self);
+#endif
 
   info_panel_setup_selector (self);
   info_panel_setup_overview (self);

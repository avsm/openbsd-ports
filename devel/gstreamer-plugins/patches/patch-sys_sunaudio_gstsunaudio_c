$OpenBSD: patch-sys_sunaudio_gstsunaudio_c,v 1.3 2007/06/29 06:13:44 jakemsr Exp $
--- sys/sunaudio/gstsunaudio.c.orig	Wed Dec 15 10:23:31 2004
+++ sys/sunaudio/gstsunaudio.c	Fri Jun  1 22:17:43 2007
@@ -28,7 +28,10 @@
 #include <string.h>
 #include <unistd.h>
 #include <sys/mman.h>
+#include <sys/types.h>
+#include <sys/ioctl.h>
 #include <sys/audioio.h>
+#include <string.h>
 #include "gstsunelement.h"
 #include "gstsunmixer.h"
 #include "gstsunaudiosrc.h"
@@ -184,8 +187,8 @@ gst_sunaudiosink_class_init (GstSunAudioSinkClass * kl
   gstelement_class->change_state = gst_sunaudiosink_change_state;
 
   g_object_class_install_property (gobject_class, ARG_DEVICE,
-      g_param_spec_string ("device", "Device", "Audio Device (/dev/audio)",
-          "/dev/audio", G_PARAM_READWRITE));
+      g_param_spec_string ("device", "Device", "Audio Device (/dev/sound)",
+          "/dev/sound", G_PARAM_READWRITE));
   g_object_class_install_property (gobject_class, ARG_BUFFER_SIZE,
       g_param_spec_int ("buffer_size", "Buffer Size", "Buffer Size",
           1, G_MAXINT, 64, G_PARAM_READWRITE));
@@ -210,7 +213,7 @@ gst_sunaudiosink_init (GstSunAudioSink * sunaudiosink)
 
   audiodev = g_getenv ("AUDIODEV");
   if (audiodev == NULL)
-    audiodev = "/dev/audio";
+    audiodev = "/dev/sound";
   sunaudiosink->device = g_strdup (audiodev);
 }
 
@@ -296,10 +299,9 @@ gst_sunaudiosink_setparams (GstSunAudioSink * sunaudio
   ainfo.play.sample_rate = sunaudiosink->rate;
   ainfo.play.channels = sunaudiosink->channels;
   ainfo.play.precision = sunaudiosink->width;
-  ainfo.play.encoding = AUDIO_ENCODING_LINEAR;
+  ainfo.play.encoding = AUDIO_ENCODING_SLINEAR;
   ainfo.play.port = ports;
   ainfo.play.buffer_size = sunaudiosink->buffer_size;
-  ainfo.output_muted = 0;
 
   ret = ioctl (sunaudiosink->fd, AUDIO_SETINFO, &ainfo);
   if (ret == -1) {
@@ -343,10 +345,6 @@ gst_sunaudiosink_open (GstSunAudioSink * sunaudiosink)
   }
 
   GST_INFO ("monitor_gain %d", sunaudiosink->info.monitor_gain);
-  GST_INFO ("output_muted %d", sunaudiosink->info.output_muted);
-  GST_INFO ("hw_features %08x", sunaudiosink->info.hw_features);
-  GST_INFO ("sw_features %08x", sunaudiosink->info.sw_features);
-  GST_INFO ("sw_features_enabled %08x", sunaudiosink->info.sw_features_enabled);
 
   return TRUE;
 }

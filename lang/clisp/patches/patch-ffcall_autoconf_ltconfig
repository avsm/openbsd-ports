$OpenBSD: patch-ffcall_autoconf_ltconfig,v 1.2 2001/05/25 19:40:06 shell Exp $
--- ffcall/autoconf/ltconfig.orig	Fri May 25 13:02:38 2001
+++ ffcall/autoconf/ltconfig	Fri May 25 13:04:03 2001
@@ -1396,10 +1396,21 @@
     ;;
 
   openbsd*)
-    archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linkopts'
-    hardcode_libdir_flag_spec='-R$libdir'
     hardcode_direct=yes
     hardcode_shlibpath_var=no
+    case "$host_os" in
+      openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
+      archive_cmds='$LD -Bshareable -o $lib$libobjs'
+      hardcode_libdir_flag_spec='-R$libdir'
+      ;;
+      *)
+       archive_cmds='$CC -shared $pic_flag -o $lib$libobjs'
+       hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
+       if [ "`/usr/bin/file /usr/lib/libc.so.* | grep ELF`" != "" ]; then
+         export_dynamic_flag_spec='${wl}-E'
+       fi
+      ;;
+    esac
     ;;
 
   os2*)

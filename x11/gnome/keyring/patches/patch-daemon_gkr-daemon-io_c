$OpenBSD: patch-daemon_gkr-daemon-io_c,v 1.1 2008/05/08 10:56:24 ajacoutot Exp $
--- daemon/gkr-daemon-io.c.orig	Thu May  8 12:27:08 2008
+++ daemon/gkr-daemon-io.c	Thu May  8 12:29:26 2008
@@ -246,6 +246,17 @@ read_unix_socket_credentials (int fd,
 			g_warning ("getpeerucred() failed: %s", strerror (errno));
 			return FALSE;
 		}
+#elif defined(__OpenBSD__) /* configure should have a check for HAVE_GETPEEREID */
+		uid_t euid;
+		gid_t egid;
+		*pid = 0;
+
+		if (getpeereid (fd, &euid, &egid) == 0) {
+			*uid = euid;
+		} else {
+			g_warning ("getpeereid() failed: %s", strerror (errno));
+			return FALSE;
+		}
 #else /* !SO_PEERCRED && !HAVE_CMSGCRED */
 		g_warning ("Socket credentials not supported on this OS\n");
 		return FALSE;

--- Makefile.orig	Sat Sep 18 11:29:44 1999
+++ Makefile	Tue Sep 21 10:56:06 1999
@@ -3,20 +3,19 @@
 
 # Debugging options
 
-DEBUG = -g -DHEXDUMP
+#DEBUG = -g -DHEXDUMP
 #DEBUG = -g -DHEXDUMP -DNOCRYPTO
 #DEBUG = -O
+DEBUG = 
   
 # Installation 
 
 # Install program
 INSTALL = /usr/bin/install
-# Installation root directory
-INSTDIR = /usr/local
 # Binaries
-INSTDIR_BIN = $(INSTDIR)/bin
+INSTDIR_BIN = $(PREFIX)/bin
 # Manual pages
-INSTDIR_MAN = $(INSTDIR)/man
+INSTDIR_MAN = $(PREFIX)/man
 
 #   Uncomment the appropriate CC, CCFLAGS, and LFLAGS statements below
 #   according to your machine type.
@@ -38,9 +37,9 @@
 #    functionality is working.	Please see the detailed description
 #    of the available flags which follows these declarations.
 #
-CCFLAGS =  -DAUDIO_BLOCKING -DLINUX -DHALF_DUPLEX -DM_LITTLE_ENDIAN
-CC = gcc -O3 # for GNU's gcc compiler
-LFLAGS = -lncurses -lm
+#CCFLAGS =  -DAUDIO_BLOCKING -DLINUX -DHALF_DUPLEX -DM_LITTLE_ENDIAN
+#CC = gcc -O3 # for GNU's gcc compiler
+#LFLAGS = -lncurses -lm
 #
 # If the above LFLAGS doesn't work, try the one below.
 #LFLAGS = -lcurses -lm
@@ -223,6 +222,12 @@
 #CCFLAGS = -DM_LITTLE_ENDIAN
 #LFLAGS = -lcurses -ltermcap -lcompat -lm
 
+#			     OpenBSD 2.5
+
+#
+LFLAGS = -L${LOCALBASE}/lib -lcurses -ltermcap -lcompat -lm -lossaudio
+
+#				
 #			   Hewlett-Packard
 #		      (courtesy of Marc Kilian)
 #
@@ -238,7 +243,7 @@
 # If your audio hardware is half duplex, uncomment the next line.
 # You can also, if you wish, define this on the CCFLAGS definition
 # for your hardware platform.
-#DUPLEX = -DHALF_DUPLEX
+DUPLEX?= -DHALF_DUPLEX
 
 # If your getdomainname() does not return the DNS domainname, define:
 #DOMAIN=-DMYDOMAIN=\"somedomain.net\"
@@ -269,7 +274,7 @@
 
 #   Compiler flags
 
-CFLAGS = $(DEBUG) -Iadpcm -Ilpc -Igsm/inc -Imd5 -Iidea -Ilibdes -Iblowfish $(CARGS) $(DUPLEX) $(CCFLAGS) $(DOMAIN)
+CFLAGS += $(DEBUG) -Iadpcm -Ilpc -Imd5 -Iidea -Iblowfish -I/usr/include -I${LOCALBASE}/include $(CARGS) $(DUPLEX) $(CCFLAGS) $(DOMAIN)
 
 PROGRAMS = sfspeaker sfmike sflaunch sflwld sflwl sfecho sfreflect sfvod
 
@@ -278,12 +283,12 @@
 SPKROBJS = speaker.o codecs.o deskey.o g711.o rate.o rtpacket.o soundbyte.o ulaw.o usleep.o vatpkt.o vox.o audio_hp.o audio_sgi.o common.o
 
 sfspeaker: $(SPKROBJS) adpcmlib.o libblowfish.o lpclib.o lpc10lib.o gsmlib.o deslib.o md5lib.o idealib.o libdes.o xdsub.o 
-	$(CC) $(SPKROBJS) adpcm/adpcm-u.o blowfish/libblowfish.a des/des.a md5/md5.o idea/idea.a lpc10/liblpc10.a gsm/lib/libgsm.a lpc/lpc.o xdsub.o libdes/libdes.a $(LFLAGS) -o sfspeaker
+	$(CC) $(SPKROBJS) adpcm/adpcm-u.o blowfish/libblowfish.a des/des.a md5/md5.o idea/idea.a lpc10/liblpc10.a -lgsm lpc/lpc.o xdsub.o -ldes $(LFLAGS) -o sfspeaker
 
 MIKEOBJS = mike.o codecs.o deskey.o g711.o rate.o rtpacket.o soundbyte.o ulaw.o usleep.o vatpkt.o xdsub.o audio_hp.o audio_sgi.o
 
 sfmike: $(MIKEOBJS) adpcmlib.o libblowfish.o lpclib.o lpc10lib.o gsmlib.o deslib.o md5lib.o idealib.o libdes.o
-	$(CC) $(MIKEOBJS) adpcm/adpcm-u.o des/des.a md5/md5.o idea/idea.a -lm blowfish/libblowfish.a lpc10/liblpc10.a gsm/lib/libgsm.a lpc/lpc.o libdes/libdes.a $(LFLAGS) -o sfmike
+	$(CC) $(MIKEOBJS) adpcm/adpcm-u.o des/des.a md5/md5.o idea/idea.a -lm blowfish/libblowfish.a lpc10/liblpc10.a -lgsm lpc/lpc.o -ldes $(LFLAGS) -o sfmike
 
 LAUNCHOBJS = launch.o soundbyte.o usleep.o g711.o
 
@@ -337,11 +342,11 @@
 #	in make not necessarily available on all platforms.
 
 adpcmlib.o:
-	( echo "Building ADPCM library."; cd adpcm ; make CC="$(CC)" )
+	( echo "Building ADPCM library."; cd adpcm ; make CC="$(CC) $(CCFLAGS) $(DEBUG)" )
 	echo "ADPCM" >adpcmlib.o
 
 deslib.o:
-	( echo "Building DES library."; cd des ; make CC="$(CC) $(CCFLAGS)" )
+	( echo "Building DES library."; cd des ; make CC="$(CC) $(CCFLAGS) $(DEBUG)" )
 	echo "DES" >deslib.o
 
 libblowfish.o:
@@ -349,7 +354,6 @@
 	echo "BLOWFISH" >libblowfish.o
 
 libdes.o:
-	( echo "Building LIBDES library."; cd libdes ; make -f Makefile.sf CC="$(CC) $(CCFLAGS) $(DEBUG)" )
 	echo "LIBDES" >libdes.o
 
 lpclib.o:
@@ -361,15 +365,14 @@
 	echo "LPC" >lpc10lib.o
 
 gsmlib.o:
-	( echo "Building GSM library."; cd gsm ; make CC="$(CC)" )
 	echo "GSM" >gsmlib.o
 
 md5lib.o:
-	( echo "Building MD5 library."; cd md5 ; make CC="$(CC)" )
+	( echo "Building MD5 library."; cd md5 ; make CC="$(CC) $(CCFLAGS) $(DEBUG)" )
 	echo "MD5" >md5lib.o
 
 idealib.o:
-	( echo "Building IDEA library."; cd idea ; make CC="$(CC)" )
+	( echo "Building IDEA library."; cd idea ; make CC="$(CC) $(CCFLAGS) $(DEBUG)" )
 	echo "IDEA" >idealib.o
 
 #   Object file dependencies
@@ -462,5 +465,5 @@
 #	be root to install in system directories.
 
 install: $(PROGRAMS)
-	$(INSTALL) -o root -g root -m 755 -s $(PROGRAMS) $(INSTDIR_BIN)
-	$(INSTALL) -o root -g root -m 644 *.1 $(INSTDIR_MAN)/man1
+	$(INSTALL) -o root -g wheel -m 755 -s $(PROGRAMS) $(INSTDIR_BIN)
+	$(INSTALL) -o root -g wheel -m 444 *.1 $(INSTDIR_MAN)/man1

--- tcpip.c.orig	Mon Jul 26 23:42:08 1999
+++ tcpip.c	Mon Jul 26 23:44:55 1999
@@ -774,6 +774,7 @@
   switch(datalink) {
   case DLT_EN10MB: offset = 14; break;
   case DLT_IEEE802: offset = 22; break;
+  case DLT_LOOP:
   case DLT_NULL: offset = 4; break;
   case DLT_SLIP:
 #if (FREEBSD || OPENBSD || NETBSD || BSDI)
@@ -794,6 +795,7 @@
 #endif /* if freebsd || openbsd || netbsd || bsdi */
     break;
   case DLT_RAW: offset = 0; break;
+  case DLT_ENC: offset = 12; break;
   default: fatal("Unknown datalink type (%d)", datalink);
   }
 }

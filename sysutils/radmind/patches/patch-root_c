$OpenBSD: patch-root_c,v 1.3 2007/04/01 07:08:39 steven Exp $
--- root.c.orig	Fri Jan 14 15:53:27 2005
+++ root.c	Sun Apr  1 08:18:32 2007
@@ -33,7 +33,7 @@ get_root( char *radmind_path, char *path, char *file_r
         fprintf( stderr, "%s: path too long\n", p );
         return( -1 );
     }
-    strcpy( tran_name, p );
+    (void)strlcpy( tran_name, p, MAXPATHLEN );
 
     if ( snprintf( test_path, MAXPATHLEN, "%s/tmp/transcript",
             radmind_real_path ) > MAXPATHLEN - 1 ) {
@@ -81,8 +81,8 @@ get_root( char *radmind_path, char *path, char *file_r
 		return( -1 );
 	    }
         } else {
-            sprintf( file_root, "%s/../file", real_path );
-            sprintf( tran_root, "%s", real_path );
+            (void)snprintf( file_root, MAXPATHLEN, "%s/../file", real_path );
+            (void)snprintf( tran_root, MAXPATHLEN, "%s", real_path );
         }
     }
 

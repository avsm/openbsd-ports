# $OpenBSD: Makefile,v 1.24 2001/10/24 21:32:12 heko Exp $

COMMENT=	"mpeg audio 1/2 layer 1, 2 and 3 player"

DISTNAME=	mpg123-0.59r
CATEGORIES=	audio
NEED_VERSION=	1.364
HOMEPAGE=	http://www.mpg123.de/

# Long, unclear license in ${WRKSRC}/COPYING.
PERMIT_PACKAGE_CDROM=	No
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	No
PERMIT_DISTFILES_FTP=	Yes

MASTER_SITES=	http://www.mpg123.de/mpg123/ \
		http://www-ti.informatik.uni-tuebingen.de/~hippm/mpg123/ \
		ftp://ftp.tu-clausthal.de/pub/unix/audio/mpg123/ \
		http://ftp.tu-clausthal.de/pub/unix/audio/mpg123
MASTER_SITES0=	ftp://ftp.kame.net/pub/kame/misc/
MASTER_SITES1=	http://www.unix-ag.org/Linux-Alpha/Packages/

PATCHFILES=	mpg123-059r-v6-20000713b.diff.gz:0 \
		l3.diff.gz:1
PATCH_DIST_STRIP= -p1

FLAVORS=	esd
FLAVOR?=

.if ${FLAVOR:L:Mesd}
LIB_DEPENDS=	esd.2::audio/esound
ALL_TARGET=	openbsd-esd
.else
ALL_TARGET=	openbsd
.endif

MAKE_FLAGS=	CC='${CC}'

post-patch:
	@cp ${FILESDIR}/audio_openbsd.c ${FILESDIR}/term.c ${WRKSRC}

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/mpg123
	${INSTALL_DATA} ${WRKSRC}/COPYING ${PREFIX}/share/mpg123

.include <bsd.port.mk>

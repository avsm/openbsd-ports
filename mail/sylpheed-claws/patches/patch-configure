$OpenBSD: patch-configure,v 1.3 2005/04/12 20:29:26 naddy Exp $
--- configure.orig	Sat Mar 19 00:08:00 2005
+++ configure	Sun Apr  3 16:25:45 2005
@@ -22287,9 +22287,9 @@ echo "${ECHO_T}$LINGUAS" >&6
 localedir='${prefix}/${DATADIRNAME}/locale'
 
 
-manualdir='${prefix}/${DATADIRNAME}/${PACKAGE}/manual'
+manualdir='${prefix}/${DATADIRNAME}/doc/${PACKAGE}/manual'
 
-faqdir='${prefix}/${DATADIRNAME}/${PACKAGE}/faq'
+faqdir='${prefix}/${DATADIRNAME}/doc/${PACKAGE}/faq'
 
 
 if test "x${datadir}" = 'x${prefix}/share'; then
@@ -25979,115 +25979,77 @@ if test "${enable_openssl+set}" = set; t
   enableval="$enable_openssl"
   ac_cv_enable_openssl=$enableval
 else
-  ac_cv_enable_openssl=yes
+  ac_cv_enable_openssl=no
 fi;
-if test x"$ac_cv_enable_openssl" = xyes; then
+echo "$as_me:$LINENO: checking whether to use OpenSSL" >&5
+echo $ECHO_N "checking whether to use OpenSSL... $ECHO_C" >&6
+if test $ac_cv_enable_openssl = yes; then
+	echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
+	echo "$as_me:$LINENO: checking if openssl is available" >&5
+echo $ECHO_N "checking if openssl is available... $ECHO_C" >&6
+	LIBS="$LIBS -lssl -lcrypto"
+	cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
 
-  succeeded=no
+#include <openssl/opensslv.h>
 
-  if test -z "$PKG_CONFIG"; then
-    # Extract the first word of "pkg-config", so it can be a program name with args.
-set dummy pkg-config; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_PKG_CONFIG+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $PKG_CONFIG in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_PKG_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  test -z "$ac_cv_path_PKG_CONFIG" && ac_cv_path_PKG_CONFIG="no"
-  ;;
-esac
-fi
-PKG_CONFIG=$ac_cv_path_PKG_CONFIG
-
-if test -n "$PKG_CONFIG"; then
-  echo "$as_me:$LINENO: result: $PKG_CONFIG" >&5
-echo "${ECHO_T}$PKG_CONFIG" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  fi
-
-  if test "$PKG_CONFIG" = "no" ; then
-     echo "*** The pkg-config script could not be found. Make sure it is"
-     echo "*** in your path, or set the PKG_CONFIG environment variable"
-     echo "*** to the full path to pkg-config."
-     echo "*** Or see http://www.freedesktop.org/software/pkgconfig to get pkg-config."
-  else
-     PKG_CONFIG_MIN_VERSION=0.9.0
-     if $PKG_CONFIG --atleast-pkgconfig-version $PKG_CONFIG_MIN_VERSION; then
-        echo "$as_me:$LINENO: checking for openssl >= 0.9.7" >&5
-echo $ECHO_N "checking for openssl >= 0.9.7... $ECHO_C" >&6
-
-        if $PKG_CONFIG --exists "openssl >= 0.9.7" ; then
-            echo "$as_me:$LINENO: result: yes" >&5
+int
+main ()
+{
+ return OPENSSL_VERSION_NUMBER;
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+   echo "$as_me:$LINENO: result: yes" >&5
 echo "${ECHO_T}yes" >&6
-            succeeded=yes
 
-            echo "$as_me:$LINENO: checking OPENSSL_CFLAGS" >&5
-echo $ECHO_N "checking OPENSSL_CFLAGS... $ECHO_C" >&6
-            OPENSSL_CFLAGS=`$PKG_CONFIG --cflags "openssl >= 0.9.7"`
-            echo "$as_me:$LINENO: result: $OPENSSL_CFLAGS" >&5
-echo "${ECHO_T}$OPENSSL_CFLAGS" >&6
-
-            echo "$as_me:$LINENO: checking OPENSSL_LIBS" >&5
-echo $ECHO_N "checking OPENSSL_LIBS... $ECHO_C" >&6
-            OPENSSL_LIBS=`$PKG_CONFIG --libs "openssl >= 0.9.7"`
-            echo "$as_me:$LINENO: result: $OPENSSL_LIBS" >&5
-echo "${ECHO_T}$OPENSSL_LIBS" >&6
-        else
-            OPENSSL_CFLAGS=""
-            OPENSSL_LIBS=""
-            ## If we have a custom action on failure, don't print errors, but
-            ## do set a variable so people can do so.
-            OPENSSL_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors "openssl >= 0.9.7"`
-
-        fi
-
-
-
-     else
-        echo "*** Your version of pkg-config is too old. You need version $PKG_CONFIG_MIN_VERSION or newer."
-        echo "*** See http://www.freedesktop.org/software/pkgconfig"
-     fi
-  fi
-
-  if test $succeeded = yes; then
-     :
-  else
-     ac_cv_enable_openssl=no
-  fi
-
-	if test x$ac_cv_enable_openssl = xyes; then
-
 cat >>confdefs.h <<\_ACEOF
 #define USE_OPENSSL 1
 _ACEOF
 
-	fi
-fi
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
 
-
+ echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+	  LIBS="$ac_save_LIBS"
+	  ac_cv_enable_openssl=no
+fi
+rm -f conftest.err conftest.$ac_objext \
+      conftest$ac_exeext conftest.$ac_ext
+else
+	echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+fi
 
 OLDLIBS=$LIBS
 LIBS=

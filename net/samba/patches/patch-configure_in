--- configure.in.orig	Tue Aug 28 14:20:33 2001
+++ configure.in	Tue Aug 28 14:31:55 2001
@@ -18,7 +18,7 @@
     codepagedir="\$(LIBDIR)/codepages"
     configdir="\$(LIBDIR)"
     lockdir="\$(VARDIR)/locks"
-    logfilebase="\$(VARDIR)"
+    logfilebase="\$(VARDIR)/log"
     privatedir="\${prefix}/private"
     swatdir="\${prefix}/swat")
 
@@ -1771,45 +1771,47 @@
 AC_ARG_WITH(ssl,
 [  --with-ssl     Include SSL support
   --without-ssl  Don't include SSL support (default)
-  --with-sslinc=DIR Where the SSL includes are (defaults to /usr/local/ssl)],
+  --with-sslinc=DIR Where the SSL headers are (defaults to /usr/local/ssl/include)
+  --with-ssllib=DIR Where the SSL libraries are (defaults to /usr/local/ssl/lib)],
 [ case "$withval" in
   yes)
     AC_MSG_RESULT(yes)
     AC_DEFINE(WITH_SSL)
-    withval="/usr/local/ssl"     # default
+    sslinc="/usr/local/ssl/include" #default
+    ssllib="/usr/local/ssl/lib"     #default
 
     if test "${with_sslinc+set}" = set; then
-
 	withval="$with_sslinc"
 	case "$withval" in
 	yes|no)
-	  echo "configure: warning: --with-sslinc called without argument - will use default" 1>&w
-	  CFLAGS="-I/usr/local/ssl/include $CFLAGS"
-	  LIBS="-lssl -lcrypto $LIBS"
-	  LDFLAGS="=L/usr/local/ssl/lib $LDFLAGS"
+          AC_MSG_WARN(--with-sslinc called without argument - will use default)
 	;;
         * )
-          CFLAGS="-I${withval} $CFLAGS"
-	  LIBS="-lssl -lcrypto $LIBS"
-  	  LDFLAGS="-L${withval}/lib $LDFLAGS"
+          sslinc="${withval}"
 	;;
 	esac
+    fi
 
-    else
-
-	CFLAGS="-I/usr/local/ssl/include $CFLAGS"   
-	LIBS="-lssl -lcrypto $LIBS"
-	LDFLAGS="-L/usr/local/ssl/lib $LDFLAGS"
-
+    if test "${with_ssllib+set}" = set; then
+       withval="$with_ssllib"
+       case "$withval" in
+       yes|no)
+         AC_MSG_WARN(--with-ssllib called without argument - will use default)
+       ;;
+       * )
+         ssllib="${withval}"
+       ;;
+       esac
     fi
 
-    if test ! -d ${withval}; then
-      echo "configure: error: called with --with-ssl, but ssl base directory ${withval} does not exist or is not a directory. Aborting config" 1>&2
-      exit 1
-    fi 
+    CFLAGS="-I${sslinc} $CFLAGS"
+    LIBS="-lssl -lcrypto $LIBS"
+    LDFLAGS="-L${ssllib} $LDFLAGS"
 
     CFLAGS="-DHAVE_CRYPT_DECL $CFLAGS"  # Damn, SSLeay defines its own
 
+    echo "OpenSSL headers path: ${sslinc}"
+    echo "OpenSSL libraries path: ${ssllib}"
     ;;
   *)
     AC_MSG_RESULT(no)

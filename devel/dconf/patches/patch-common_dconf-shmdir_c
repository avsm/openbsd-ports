$OpenBSD: patch-common_dconf-shmdir_c,v 1.3 2011/04/05 18:45:05 ajacoutot Exp $
--- common/dconf-shmdir.c.orig	Tue Jan 18 06:48:15 2011
+++ common/dconf-shmdir.c	Tue Apr  5 14:42:47 2011
@@ -21,7 +21,7 @@
 
 #include "dconf-shmdir.h"
 
-#ifndef __FreeBSD__
+#if !(defined __FreeBSD__ || defined __OpenBSD__)
 #include <sys/statfs.h>
 #include <sys/vfs.h>
 #endif
@@ -53,7 +53,11 @@ is_local (const gchar *filename)
       while (s < 0 && errno == EINTR);
     }
 
+#ifndef __OpenBSD__
   return s == 0 && buf.f_type != NFS_SUPER_MAGIC;
+#else
+  return s == 0 && strcmp(buf.f_fstypename, MOUNT_NFS) != 0;
+#endif
 }
 
 gchar *

$OpenBSD: patch-jdk_src_solaris_native_java_net_PlainSocketImpl_c,v 1.4 2011/01/11 15:47:50 kurt Exp $
--- jdk/src/solaris/native/java/net/PlainSocketImpl.c.orig	Thu Oct 28 20:18:11 2010
+++ jdk/src/solaris/native/java/net/PlainSocketImpl.c	Mon Nov  1 13:16:32 2010
@@ -483,9 +483,11 @@ Java_java_net_PlainSocketImpl_socketConnect(JNIEnv *en
         if (connect_rv == JVM_IO_INTR) {
             JNU_ThrowByName(env, JNU_JAVAIOPKG "InterruptedIOException",
                             "operation interrupted");
+#if defined(EPROTO)
         } else if (errno == EPROTO) {
             NET_ThrowByNameWithLastError(env, JNU_JAVANETPKG "ProtocolException",
                            "Protocol error");
+#endif
         } else if (errno == ECONNREFUSED) {
             NET_ThrowByNameWithLastError(env, JNU_JAVANETPKG "ConnectException",
                            "Connection refused");
@@ -1001,7 +1003,7 @@ Java_java_net_PlainSocketImpl_socketGetOption(JNIEnv *
      */
     if (cmd == java_net_SocketOptions_SO_BINDADDR) {
         SOCKADDR him;
-        socklen_t len = 0;
+        socklen_t len;
         int port;
         jobject iaObj;
         jclass iaCntrClass;

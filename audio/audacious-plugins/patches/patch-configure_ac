$OpenBSD: patch-configure_ac,v 1.3 2009/09/15 21:49:55 fgsch Exp $
--- configure.ac.orig	Mon Jul  6 23:40:35 2009
+++ configure.ac	Sat Aug  1 16:52:50 2009
@@ -791,13 +791,21 @@ AC_ARG_ENABLE( jack,
                 [enable_jack="yes"])
 
 if test "x$enable_jack" = "xyes"; then
-        AM_PATH_JACK(have_jack=yes, have_jack=no)
+	PKG_CHECK_MODULES(JACK, jack >= 0.109.10, , [AC_MSG_WARN(
+	[*** Cannot find jack 0.109.10 or newer, jack will not be built ***])
+	enable_jack=no])
 else
         AC_MSG_RESULT([*** jack plugin disabled per user request ***])
-        have_jack=no
+        enable_jack=no
 fi
 
-if test "x$have_jack" = "xyes"; then
+if test "x$enable_jack" = xyes; then
+       PKG_CHECK_MODULES(SAMPLERATE, samplerate >= 0.0.15, , [AC_MSG_WARN(
+       [Could not find libsamplerate, necessary for jack output plugin.])
+       enable_jack=no])
+fi
+
+if test "x$enable_jack" = xyes; then
 	OUTPUT_PLUGINS="$OUTPUT_PLUGINS jack"
 fi
 
@@ -1555,6 +1563,20 @@ if test "x$have_bs2b" = "xyes"; then
 	EFFECT_PLUGINS="$EFFECT_PLUGINS bs2b"
 fi
 
+dnl *** sndio
+
+AC_ARG_ENABLE(sndio,
+    [  --enable-sndio          enable sndio output plugin (default=disabled) ],
+    [have_sndio=$enableval],
+    [have_sndio=no]
+)
+
+if test "x$have_sndio" = "xyes"; then
+	OUTPUT_PLUGINS="$OUTPUT_PLUGINS sndio"
+else
+	have_sndio=no
+fi
+
 dnl *** End of all plugin checks ***
 
 AC_SUBST(ARCH_DEFINES)
@@ -1652,6 +1674,7 @@ echo "    -> FileWriter Vorbis output part:     $have_
 echo "    -> FileWriter FLAC output part:       $have_writer_flac"
 echo "  Icecast audio output (icecast):         $have_shout"
 echo "  Null Audio output (null):               yes"
+echo "  Sndio Audio output (sndio):             $have_sndio"
 echo
 echo "  Input Plugins"
 echo "  -------------"

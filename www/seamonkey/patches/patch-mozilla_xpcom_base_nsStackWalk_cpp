$OpenBSD: patch-mozilla_xpcom_base_nsStackWalk_cpp,v 1.1 2010/04/03 09:30:15 landry Exp $
--- mozilla/xpcom/base/nsStackWalk.cpp.orig	Sat Dec  5 02:56:52 2009
+++ mozilla/xpcom/base/nsStackWalk.cpp	Sat Jan 16 16:28:38 2010
@@ -1124,7 +1124,7 @@ NS_FormatCodeAddressDetails(void *aPC, const nsCodeAdd
 #define __USE_GNU
 #endif
 
-#if defined(HAVE_LIBDL) || defined(XP_MACOSX)
+#if defined(HAVE_LIBDL) || defined(XP_MACOSX) || defined(__OpenBSD__)
 #include <dlfcn.h>
 #endif
 
@@ -1223,7 +1223,7 @@ myinit()
     if (! initialized) {
 #ifndef __GNUC__
         void *handle;
-        const char *libdem = "libdemangle.so.1";
+        const char *libdem = "libdemangle.so";
 
         /* load libdemangle if we can and need to (only try this once) */
         if ((handle = dlopen(libdem, RTLD_LAZY)) != NULL) {

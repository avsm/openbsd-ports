$OpenBSD: patch-configure_in,v 1.5 2010/05/20 09:21:17 espie Exp $
--- configure.in.orig	Fri Jan  9 19:17:46 2004
+++ configure.in	Thu May 20 11:18:39 2010
@@ -56,10 +56,8 @@ programs.  If you get compile errors, first upgrade to
 (but minimum 2.96-85) and try again. If the problem still exists, try with
 gcc 3.0.x (or 2.95.x) *BEFORE* reporting bugs!
 
-Press return to resume configuration (CTRL-C to abort).
 ================================================================================
 EOF
-	read dummy
 	fi
 fi
 
@@ -117,6 +115,7 @@ if test "x$have_gcrypt" != "xyes"; then
 	fi
 fi
 
+AC_CHECK_LIB(pthread, main, [AC_DEFINE(HAVE_LIBPTHREAD, 1), LIBS="$LIBS -pthread"])
 
 dnl Checks for libraries.
 AC_ARG_ENABLE(glib2,[  --disable-glib2           Use glib1.2 instead of glib 2.x])
@@ -258,7 +257,7 @@ else
 fi
 
 AC_MSG_CHECKING(whether MSG_NOSIGNAL exists)
-AC_TRY_COMPILE([#include <sys/socket.h>],
+AC_TRY_COMPILE([#include <sys/types.h> #include <sys/socket.h>],
 [
 int main()
 {
@@ -310,7 +309,7 @@ fi
 dnl Checks for header files.
 AC_HEADER_DIRENT
 AC_HEADER_STDC
-AC_CHECK_HEADERS(fcntl.h limits.h strings.h sys/file.h sys/ioctl.h sys/time.h unistd.h errno.h signal.h sys/poll.h sys/param.h openssl/md5.h openssl/md4.h gcrypt.h)
+AC_CHECK_HEADERS(fcntl.h limits.h strings.h sys/file.h sys/ioctl.h sys/time.h unistd.h errno.h signal.h sys/poll.h sys/param.h openssl/md5.h openssl/md4.h gcrypt.h linux/sem.h getopt.h)
 
 dnl Checks for typedefs, structures, and compiler characteristics.
 AC_C_CONST
@@ -323,7 +322,7 @@ AC_STRUCT_TM
 dnl Checks for library functions.
 AC_FUNC_MEMCMP
 AC_FUNC_MMAP
-AC_CHECK_FUNCS(getcwd mkdir select socket strdup strerror strstr strtod strtoul uname)
+AC_CHECK_FUNCS(getcwd mkdir select socket strdup strerror strstr strtod strtoul uname getopt_long)
 
 dnl *** Checks if the CPU allows unaligned access ***
 AC_MSG_CHECKING(CPU allows unaligned memory access)

$OpenBSD: patch-boost_detail_atomic_count_hpp,v 1.1 2008/06/05 12:55:56 kurt Exp $
--- boost/detail/atomic_count.hpp.orig	Wed Mar 30 17:52:54 2005
+++ boost/detail/atomic_count.hpp	Thu Jun  5 07:17:02 2008
@@ -93,7 +93,13 @@ typedef long atomic_count;
 #  include <boost/detail/atomic_count_pthreads.hpp>
 #elif defined(WIN32) || defined(_WIN32) || defined(__WIN32__)
 #  include <boost/detail/atomic_count_win32.hpp>
-#elif defined(__GLIBCPP__) || defined(__GLIBCXX__)
+#elif defined(__GLIBCXX__) && \
+        (defined(_GLIBCXX_HAVE_GTHR_DEFAULT) || \
+        defined(_GLIBCXX__PTHREADS))
+#  include <boost/detail/atomic_count_gcc.hpp>
+#elif defined(__GLIBCPP__) && \
+        (defined(_GLIBCPP_HAVE_GTHR_DEFAULT) || \
+        defined(_GLIBCPP__PTHREADS))
 #  include <boost/detail/atomic_count_gcc.hpp>
 #elif defined(BOOST_HAS_PTHREADS)
 #  define BOOST_AC_USE_PTHREADS

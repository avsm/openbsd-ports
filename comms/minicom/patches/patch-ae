--- util.c.~1~	Thu Jan 25 01:52:25 1996
+++ util.c	Wed Mar  4 12:42:55 1998
@@ -162,10 +162,12 @@
 void drop_all_privs()
 {
 #ifdef HAS_REUID
+#if ! BSD4_4
   /* Regain privs needed to drop privs :) */
   setregid(real_gid, eff_gid);
   setreuid(real_uid, eff_uid);
 #endif
+#endif
 
   /* Drop it. */
   setgid(real_gid);
@@ -179,9 +181,16 @@
 void drop_privs()
 {
 #ifdef HAS_REUID
+# if BSD4_4
+  setegid( real_gid );
+  if ( seteuid( real_uid ) < 0 )
+	fprintf(stderr, "minicom: cannot seteuid(%d)\n", real_uid);
+     
+# else
   setregid(eff_gid, real_gid);
   if (setreuid(eff_uid, real_uid) < 0)
 	fprintf(stderr, "minicom: cannot setreuid(%d, %d)\n", eff_uid, real_uid);
+# endif
   not_suid = 1;
 #endif
 }
@@ -190,9 +199,16 @@
 void set_privs()
 {
 #ifdef HAS_REUID
+# if BSD4_4
+  setegid( eff_gid );
+  if ( seteuid( eff_uid ) < 0 )
+	fprintf(stderr, "minicom: cannot seteuid(%d)\n", eff_uid);
+     
+# else
   setregid(real_gid, eff_gid);
   if (setreuid(real_uid, eff_uid) < 0)
 	fprintf(stderr, "minicom: cannot setreuid(%d, %d)\n", real_uid, eff_uid);
+# endif
   not_suid = 0;
 #endif
 }

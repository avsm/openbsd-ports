$OpenBSD: patch-Modules_FindQt4_cmake,v 1.7 2010/05/28 20:21:48 dcoppa Exp $
--- Modules/FindQt4.cmake.orig	Tue Apr  6 16:45:31 2010
+++ Modules/FindQt4.cmake	Fri Apr 23 22:57:32 2010
@@ -392,12 +392,18 @@ GET_FILENAME_COMPONENT(qt_install_version "[HKEY_CURRE
 # check for qmake
 # Debian uses qmake-qt4
 # macports' Qt uses qmake-mac
-FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake qmake4 qmake-qt4 qmake-mac PATHS
+IF(CMAKE_SYSTEM MATCHES "OpenBSD*")
+  FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake4 PATHS
+    $ENV{QTDIR}/bin
+  )
+ELSE(CMAKE_SYSTEM MATCHES "OpenBSD*")
+  FIND_PROGRAM(QT_QMAKE_EXECUTABLE NAMES qmake qmake4 qmake-qt4 qmake-mac PATHS
   "[HKEY_CURRENT_USER\\Software\\Trolltech\\Qt3Versions\\4.0.0;InstallDir]/bin"
   "[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\4.0.0;InstallDir]/bin"
   "[HKEY_CURRENT_USER\\Software\\Trolltech\\Versions\\${qt_install_version};InstallDir]/bin"
   $ENV{QTDIR}/bin
 )
+ENDIF(CMAKE_SYSTEM MATCHES "OpenBSD*")
 
 IF (QT_QMAKE_EXECUTABLE)
 
@@ -983,6 +989,12 @@ IF (QT4_QMAKE_FOUND)
     _QT4_ADJUST_LIB_VARS(QAxServer)
     _QT4_ADJUST_LIB_VARS(QAxContainer)
   ENDIF(WIN32)
+  # qt on OpenBSD needs to be linked with -pthread 
+  IF(CMAKE_SYSTEM MATCHES "OpenBSD*")
+    FIND_PACKAGE(Threads)
+    SET(QT_QTCORE_LIBRARY ${QT_QTCORE_LIBRARY}
+              ${CMAKE_THREAD_LIBS_INIT})
+  ENDIF(CMAKE_SYSTEM MATCHES "OpenBSD*")
 
   # If Qt is installed as a framework, we need to add QT_QTCORE_LIBRARY here (which
   # is the framework directory in that case), since this will make the cmake include_directories()
@@ -1017,13 +1029,13 @@ IF (QT4_QMAKE_FOUND)
   ENDIF(QT_QMAKE_CHANGED)
   
   FIND_PROGRAM(QT_MOC_EXECUTABLE
-    NAMES moc-qt4 moc
+    NAMES moc-qt4 moc4 moc 
     PATHS ${QT_BINARY_DIR}
     NO_DEFAULT_PATH
     )
 
   FIND_PROGRAM(QT_UIC_EXECUTABLE
-    NAMES uic-qt4 uic
+    NAMES uic-qt4 uic4 uic
     PATHS ${QT_BINARY_DIR}
     NO_DEFAULT_PATH
     )

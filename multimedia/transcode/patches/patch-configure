$OpenBSD: patch-configure,v 1.7 2008/07/09 02:13:01 jakemsr Exp $
--- configure.orig	Sat Jan  5 06:38:47 2008
+++ configure	Sat Jun 21 21:12:47 2008
@@ -1761,7 +1761,7 @@ Optional Packages:
                           prefix where libavcodec is installed (/usr)
   --with-libavcodec-includes=DIR
                           directory where libavcodec headers
-                          (ffmpeg/avcodec.h) are installed (/usr/include)
+                          (libavcodec/avcodec.h) are installed (/usr/include)
   --with-libavcodec-libs=DIR
                           directory where libavcodec libararies
                           (libavcodec.so) are installed (/usr/lib)
@@ -10222,6 +10222,7 @@ fi
 echo "${ECHO_T}$have_asm_altivec" >&6; }
 if test x"$have_asm_altivec" = x"yes" ; then
 
+CFLAGS="$CFLAGS -maltivec"
 cat >>confdefs.h <<\_ACEOF
 #define HAVE_PPC_ALTIVEC 1
 _ACEOF
@@ -27132,12 +27133,12 @@ echo "${ECHO_T}default" >&6; }
   LIBAVCODEC_EXTRA_CFLAGS="$LIBAVCODEC_EXTRA_CFLAGS $xi"
   LIBAVCODEC_EXTRA_CFLAGS="`echo $LIBAVCODEC_EXTRA_CFLAGS | sed -e 's/  */ /g'`"
 
-  if test x"ffmpeg/avcodec.h" != x"none" ; then
+  if test x"libavcodec/avcodec.h" != x"none" ; then
     save_CPPFLAGS="$CPPFLAGS"
     CPPFLAGS="$CPPFLAGS $libavcodec_ii"
     if test "${ac_cv_header_ffmpeg_avcodec_h+set}" = set; then
-  { echo "$as_me:$LINENO: checking for ffmpeg/avcodec.h" >&5
-echo $ECHO_N "checking for ffmpeg/avcodec.h... $ECHO_C" >&6; }
+  { echo "$as_me:$LINENO: checking for libavcodec/avcodec.h" >&5
+echo $ECHO_N "checking for libavcodec/avcodec.h... $ECHO_C" >&6; }
 if test "${ac_cv_header_ffmpeg_avcodec_h+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 fi
@@ -27145,8 +27146,8 @@ fi
 echo "${ECHO_T}$ac_cv_header_ffmpeg_avcodec_h" >&6; }
 else
   # Is the header compilable?
-{ echo "$as_me:$LINENO: checking ffmpeg/avcodec.h usability" >&5
-echo $ECHO_N "checking ffmpeg/avcodec.h usability... $ECHO_C" >&6; }
+{ echo "$as_me:$LINENO: checking libavcodec/avcodec.h usability" >&5
+echo $ECHO_N "checking libavcodec/avcodec.h usability... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -27154,7 +27155,7 @@ cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
-#include <ffmpeg/avcodec.h>
+#include <libavcodec/avcodec.h>
 _ACEOF
 rm -f conftest.$ac_objext
 if { (ac_try="$ac_compile"
@@ -27186,15 +27187,15 @@ rm -f core conftest.err conftest.$ac_objext conftest.$
 echo "${ECHO_T}$ac_header_compiler" >&6; }
 
 # Is the header present?
-{ echo "$as_me:$LINENO: checking ffmpeg/avcodec.h presence" >&5
-echo $ECHO_N "checking ffmpeg/avcodec.h presence... $ECHO_C" >&6; }
+{ echo "$as_me:$LINENO: checking libavcodec/avcodec.h presence" >&5
+echo $ECHO_N "checking libavcodec/avcodec.h presence... $ECHO_C" >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-#include <ffmpeg/avcodec.h>
+#include <libavcodec/avcodec.h>
 _ACEOF
 if { (ac_try="$ac_cpp conftest.$ac_ext"
 case "(($ac_try" in
@@ -27227,30 +27228,30 @@ echo "${ECHO_T}$ac_header_preproc" >&6; }
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
   yes:no: )
-    { echo "$as_me:$LINENO: WARNING: ffmpeg/avcodec.h: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: ffmpeg/avcodec.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: ffmpeg/avcodec.h: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: ffmpeg/avcodec.h: proceeding with the compiler's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: libavcodec/avcodec.h: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: libavcodec/avcodec.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: libavcodec/avcodec.h: proceeding with the compiler's result" >&5
+echo "$as_me: WARNING: libavcodec/avcodec.h: proceeding with the compiler's result" >&2;}
     ac_header_preproc=yes
     ;;
   no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: ffmpeg/avcodec.h: present but cannot be compiled" >&5
-echo "$as_me: WARNING: ffmpeg/avcodec.h: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: ffmpeg/avcodec.h:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: ffmpeg/avcodec.h:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: ffmpeg/avcodec.h: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: ffmpeg/avcodec.h: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: ffmpeg/avcodec.h:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: ffmpeg/avcodec.h:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: ffmpeg/avcodec.h: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: ffmpeg/avcodec.h: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: ffmpeg/avcodec.h: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: ffmpeg/avcodec.h: in the future, the compiler will take precedence" >&2;}
+    { echo "$as_me:$LINENO: WARNING: libavcodec/avcodec.h: present but cannot be compiled" >&5
+echo "$as_me: WARNING: libavcodec/avcodec.h: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: libavcodec/avcodec.h:     check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: libavcodec/avcodec.h:     check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: libavcodec/avcodec.h: see the Autoconf documentation" >&5
+echo "$as_me: WARNING: libavcodec/avcodec.h: see the Autoconf documentation" >&2;}
+    { echo "$as_me:$LINENO: WARNING: libavcodec/avcodec.h:     section \"Present But Cannot Be Compiled\"" >&5
+echo "$as_me: WARNING: libavcodec/avcodec.h:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { echo "$as_me:$LINENO: WARNING: libavcodec/avcodec.h: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: libavcodec/avcodec.h: proceeding with the preprocessor's result" >&2;}
+    { echo "$as_me:$LINENO: WARNING: libavcodec/avcodec.h: in the future, the compiler will take precedence" >&5
+echo "$as_me: WARNING: libavcodec/avcodec.h: in the future, the compiler will take precedence" >&2;}
 
     ;;
 esac
-{ echo "$as_me:$LINENO: checking for ffmpeg/avcodec.h" >&5
-echo $ECHO_N "checking for ffmpeg/avcodec.h... $ECHO_C" >&6; }
+{ echo "$as_me:$LINENO: checking for libavcodec/avcodec.h" >&5
+echo $ECHO_N "checking for libavcodec/avcodec.h... $ECHO_C" >&6; }
 if test "${ac_cv_header_ffmpeg_avcodec_h+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
@@ -27275,8 +27276,8 @@ else
 fi
 
 cat >> $tc_pkg_err_file <<EOF
-ERROR: $prob: cannot compile ffmpeg/avcodec.h
-ffmpeg/avcodec.h can be found in the following packages:
+ERROR: $prob: cannot compile libavcodec/avcodec.h
+libavcodec/avcodec.h can be found in the following packages:
   FFMpeg  http://www.ffmpeg.org/
 
 EOF
@@ -27450,7 +27451,7 @@ cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
 #include <stdio.h>
-#include <ffmpeg/avcodec.h>
+#include <libavcodec/avcodec.h>
 int
 main()
 {
@@ -27511,8 +27512,8 @@ else
 fi
 
 cat >> $tc_pkg_err_file <<EOF
-ERROR: $prob: cannot compile ffmpeg/avcodec.h
-ffmpeg/avcodec.h can be found in the following packages:
+ERROR: $prob: cannot compile libavcodec/avcodec.h
+libavcodec/avcodec.h can be found in the following packages:
   libavcodec  http://www.ffmpeg.org
 
 EOF
@@ -27537,7 +27538,7 @@ cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 
-#include <ffmpeg/avcodec.h>
+#include <libavcodec/avcodec.h>
 
 int
 main ()

$OpenBSD: patch-server_Makefile,v 1.3 2003/12/16 10:04:37 sturm Exp $
--- server/Makefile.orig	2003-12-11 10:32:40.000000000 -0800
+++ server/Makefile	2003-12-14 11:47:47.000000000 -0800
@@ -2,18 +2,14 @@ PACKAGE_D ?= gkrellmd
 PKG_CONFIG ?= pkg-config
 BINMODE ?= 755
 
-INSTALLROOT ?= $(DESTDIR)$(PREFIX)
-ifeq ($(INSTALLROOT),)
-	INSTALLROOT = /usr/local
-endif
-
-SINSTALLDIR ?= $(INSTALLROOT)/bin
+INSTALLROOT ?= ${PREFIX}
+SINSTALLDIR = $(INSTALLROOT)/sbin
 INSTALLDIRMODE ?= 755
-SMANDIR ?= $(INSTALLROOT)/share/man/man1
+SMANDIR ?= $(INSTALLROOT)/man/man1
 MANMODE ?= 644
 MANDIRMODE ?= 755
 INSTALL ?= install
-LINK_FLAGS ?= -Wl,-E
+LINK_FLAGS ?= -Wl
 CC ?= gcc
 STRIP ?= -s
 
@@ -23,12 +19,12 @@ PKG_LIB = `$(PKG_CONFIG) --libs glib-2.0
 GLIB12_INCLUDE = `glib-config --cflags gthread`
 GLIB12_LIB = `glib-config --libs gthread`
 
-FLAGS = -O2 -I.. $(PKG_INCLUDE) $(GTOP_INCLUDE)
+FLAGS+= -I.. $(PKG_INCLUDE) $(GTOP_INCLUDE)
 ifeq ($(glib12),1)
-FLAGS = -O2 -I.. $(GLIB12_INCLUDE) $(GTOP_INCLUDE)
+FLAGS += -I.. $(GLIB12_INCLUDE) $(GTOP_INCLUDE)
 endif
 ifeq ($(glib12),yes)
-FLAGS = -O2 -I.. $(GLIB12_INCLUDE) $(GTOP_INCLUDE)
+FLAGS += -I.. $(GLIB12_INCLUDE) $(GTOP_INCLUDE)
 endif
 
 FLAGS+= $(PTHREAD_INC)
@@ -70,9 +66,7 @@ ifeq ($(HAVE_GETADDRINFO),1)
     FLAGS += -DHAVE_GETADDRINFO
 endif
 
-
-override CC += -Wall $(FLAGS)
-
+CFLAGS += $(FLAGS)
 OS_NAME=$(shell uname -s)
 OS_RELEASE=$(shell uname -r)
 

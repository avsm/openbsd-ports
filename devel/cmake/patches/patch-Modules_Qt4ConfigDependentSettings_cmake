$OpenBSD: patch-Modules_Qt4ConfigDependentSettings_cmake,v 1.7 2011/03/13 18:23:02 dcoppa Exp $
--- Modules/Qt4ConfigDependentSettings.cmake.orig	Tue Feb 15 18:47:27 2011
+++ Modules/Qt4ConfigDependentSettings.cmake	Thu Mar 10 10:07:02 2011
@@ -26,6 +26,10 @@
 # if a user needs the dependencies, and they couldn't be found, they can set
 # the variables themselves.
 
+INCLUDE(FindIconv)
+INCLUDE(FindLibintl)
+INCLUDE(FindLCMS)
+
 SET(QT_QTGUI_LIB_DEPENDENCIES "")
 SET(QT_QTCORE_LIB_DEPENDENCIES "")
 SET(QT_QTNETWORK_LIB_DEPENDENCIES "")
@@ -60,10 +64,6 @@ IF(Q_WS_WIN  AND  NOT QT_IS_STATIC)
   SET(QT_DEFINITIONS ${QT_DEFINITIONS} -DQT_DLL)
 ENDIF(Q_WS_WIN  AND  NOT QT_IS_STATIC)
 
-IF(NOT QT_IS_STATIC)
-  RETURN()
-ENDIF(NOT QT_IS_STATIC)
-
 # QtOpenGL dependencies
 find_package(OpenGL)
 SET (QT_QTOPENGL_LIB_DEPENDENCIES ${OPENGL_glu_LIBRARY} ${OPENGL_gl_LIBRARY})
@@ -93,6 +93,15 @@ IF(QT_QCONFIG MATCHES "system-mng")
   SET(QT_QTGUI_LIB_DEPENDENCIES ${QT_QTGUI_LIB_DEPENDENCIES} ${MNG_LIBRARY})
 ENDIF(QT_QCONFIG MATCHES "system-mng")
 
+## system lcms
+IF(LCMS_FOUND)
+  FIND_LIBRARY(LCMS_LIBRARY NAMES lcms)
+  MARK_AS_ADVANCED(LCMS_LIBRARY)
+  IF(LCMS_LIBRARY)
+    SET(QT_QTGUI_LIB_DEPENDENCIES ${QT_QTGUI_LIB_DEPENDENCIES} ${LCMS_LIBRARY})
+  ENDIF(LCMS_LIBRARY)
+ENDIF(LCMS_FOUND)
+
 # for X11, get X11 library directory
 IF(Q_WS_X11)
   FIND_PACKAGE(X11)
@@ -180,6 +189,23 @@ IF(QT_QCONFIG MATCHES "system-zlib")
   SET(QT_QTCORE_LIB_DEPENDENCIES ${QT_QTCORE_LIB_DEPENDENCIES} ${ZLIB_LIBRARIES})
 ENDIF(QT_QCONFIG MATCHES "system-zlib")
 
+## iconv
+IF(ICONV_FOUND)
+  FIND_LIBRARY(QT_ICONV_LIBRARY NAMES iconv)
+  MARK_AS_ADVANCED(QT_ICONV_LIBRARY)
+  IF(QT_ICONV_LIBRARY)
+    SET(QT_QTCORE_LIB_DEPENDENCIES ${QT_QTCORE_LIB_DEPENDENCIES} ${QT_ICONV_LIBRARY})
+  ENDIF(QT_ICONV_LIBRARY)
+ENDIF(ICONV_FOUND)
+
+## libintl
+IF(LIBINTL_FOUND)
+  FIND_LIBRARY(QT_INTL_LIBRARY NAMES intl)
+  MARK_AS_ADVANCED(QT_INTL_LIBRARY)
+  IF(QT_INTL_LIBRARY)
+    SET(QT_QTCORE_LIB_DEPENDENCIES ${QT_QTCORE_LIB_DEPENDENCIES} ${QT_INTL_LIBRARY})
+  ENDIF(QT_INTL_LIBRARY)
+ENDIF(LIBINTL_FOUND)
 
 ## openssl
 IF(NOT Q_WS_WIN)

$OpenBSD: patch-src_methods_c,v 1.4 2005/07/21 15:16:47 aanriot Exp $
--- src/methods.c.orig	Wed Mar 23 14:00:54 2005
+++ src/methods.c	Fri Jul 15 12:24:01 2005
@@ -271,29 +271,29 @@ options[0] = '\0';
 
 if (INFORM)
    {
-   strcat(options,"-I ");
+   (void)strlcat(options,"-I ",sizeof(options));
    }
 
 if (IGNORELOCK)
    {
-   strcat(options,"-K ");
+   (void)strlcat(options,"-K ",sizeof(options));
    }
 
 if (VERBOSE)
    {
-   strcat(options,"-v ");
+   (void)strlcat(options,"-v ",sizeof(options));
    }
 
 if (DEBUG || D2)
    {
-   strcat(options,"-d2 ");
+   (void)strlcat(options,"-d2 ",sizeof(options));
    }
 
 ptr = IsDefinedMethod(name,digeststring);
 
-strcat(options,"-Z ");
-strcat(options,digeststring);
-strcat(options," ");
+(void)strlcat(options,"-Z ",sizeof(options));
+(void)strlcat(options,digeststring,sizeof(options));
+(void)strlcat(options," ",sizeof(options));
 
 snprintf(execstr,CF_BUFSIZE-1,"%s/bin/cfagent -f %s %s",CFWORKDIR,GetMethodFilename(ptr),options);
 
@@ -1066,10 +1066,10 @@ for (dirp = readdir(dirh); dirp != NULL;
    SplitMethodName(dirp->d_name,client,server,name,digeststring,extra);
 
    Debug("This request came from %s - our reply should be sent there!\n",client);
-   strcpy(METHODREPLYTO,client);
+   (void)strlcpy(METHODREPLYTO,client,sizeof(METHODREPLYTO));
 
    Debug("This request referred to us as %s - a plausible identity\n",client);
-   strcpy(METHODFOR,server);
+   (void)strlcpy(METHODFOR,server,sizeof(METHODFOR));
 
    if (strcmp(methodname,name) == 0)
       {

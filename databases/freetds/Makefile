# $OpenBSD: Makefile,v 1.26 2005/12/26 19:15:22 sturm Exp $

V=		0.63
DISTNAME=	freetds-$V
PKGNAME=	${DISTNAME}p0
CATEGORIES=	databases
SHARED_LIBS=	ct	3.0 \
		sybdb	5.0 \
		tds	4.0 \
		tdssrv	2.0
MODGNU_SHARED_LIBS=ct	'' \
		sybdb	'' \
		tds	'' \
		tdssrv	''
LIBct_ALIAS=	realct
LIBsybdb_ALIAS=	realsybdb
LIBtds_ALIAS=	realtds

# GPL
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

WANTLIB=	c ncurses readline

COMMENT=	"project to document and implement the TDS protocol"
HOMEPAGE=	http://www.freetds.org/
MASTER_SITES=	ftp://ftp.ibiblio.org/pub/Linux/ALPHA/freetds/stable/

MAINTAINER=	joshua stein <jcs@openbsd.org>

FLAVORS=	msdblib
FLAVOR?=

USE_LIBTOOL=	Yes

CONFIGURE_STYLE= gnu
CONFIGURE_ARGS=	${CONFIGURE_SHARED} \
		--enable-static \
		--with-libiconv-prefix="${LOCALBASE}" \
		--disable-threadsafe \
		--disable-odbc

.if $(FLAVOR:L:Mmsdblib)
CONFIGURE_ARGS+=--enable-msdblib
.endif

MAKE_ENV=	RM=rm
MODULES=	converters/libiconv
DOC=		share/doc/freetds-$V
SUBST_VARS=	DOC V

post-install:
	@sed -e "s:@sysconfdir@:${SYSCONFDIR}:g" ${WRKSRC}/freetds.conf > \
		${WRKSRC}/freetds.conf.new
	@mkdir ${PREFIX}/share/examples/freetds
	${INSTALL_DATA} ${WRKSRC}/freetds.conf.new \
		${PREFIX}/share/examples/freetds/freetds.conf-sample
	${INSTALL_DATA} ${WRKSRC}/src/pool/pool.conf \
		${PREFIX}/share/examples/freetds/pool.conf-sample

.include <bsd.port.mk>

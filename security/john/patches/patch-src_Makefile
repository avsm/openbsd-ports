$OpenBSD: patch-src_Makefile,v 1.2 2004/09/23 21:52:08 fgsch Exp $
--- src/Makefile.orig	Sat Nov 29 23:02:25 2003
+++ src/Makefile	Thu Sep 23 18:08:15 2004
@@ -16,7 +16,7 @@ NULL = /dev/null
 CPPFLAGS = -E
 CFLAGS = -c -Wall -O2 -fomit-frame-pointer
 ASFLAGS = -c
-LDFLAGS = -s
+LDFLAGS = -s -lm
 OPT_NORMAL = -funroll-loops
 OPT_INLINE = -finline-functions
 
@@ -204,11 +204,17 @@ openbsd-x86-any-elf:
 		JOHN_OBJS="$(JOHN_OBJS) x86.o" \
 		ASFLAGS="$(ASFLAGS) -DBSD"
 
+openbsd-x86-mmx-elf:
+	$(LN) x86-mmx.h arch.h
+	$(MAKE) $(PROJ) \
+		JOHN_OBJS="$(JOHN_OBJS) x86.o x86-mmx.o" \
+		ASFLAGS="$(ASFLAGS) -DBSD"
+
 openbsd-x86-any-a.out:
 	$(LN) x86-any.h arch.h
 	$(MAKE) $(PROJ) \
 		JOHN_OBJS="$(JOHN_OBJS) x86.o" \
-		ASFLAGS="$(ASFLAGS) -DUNDERSCORES -DALIGN_LOG -DBSD"
+		ASFLAGS="$(ASFLAGS) -DBSD"
 
 openbsd-sparc:
 	$(MAKE) use-openbsd-sparc HAMMER=use-openbsd-sparc NAIL=sparc.h
@@ -219,7 +225,7 @@ use-openbsd-sparc:
 	$(MAKE) $(NAIL) \
 		BENCH_DES_OBJS_DEPEND="$(BENCH_DES_OBJS_ORIG) sparc.o" \
 		JOHN_OBJS="$(JOHN_OBJS_ORIG) sparc.o" \
-		ASFLAGS="-c -DUNDERSCORES -DBSD"
+		ASFLAGS="-c -DBSD"
 
 openbsd-vax:
 	$(LN) vax.h arch.h

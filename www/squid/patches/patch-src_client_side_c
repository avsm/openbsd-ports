$OpenBSD: patch-src_client_side_c,v 1.6 2006/06/17 03:15:55 brad Exp $
--- src/client_side.c.orig	Fri Jun 16 22:20:57 2006
+++ src/client_side.c	Fri Jun 16 22:20:57 2006
@@ -2828,7 +2828,7 @@ parseHttpRequest(ConnStateData * conn, m
 #elif PF_TRANSPARENT
 	    static time_t last_reported = 0;
 	    if (pffd < 0)
-		pffd = open("/dev/pf", O_RDWR);
+		pffd = open("/dev/pf", O_RDONLY);
 	    if (pffd < 0) {
 		if (squid_curtime - last_reported > 60) {
 		    debug(50, 1) ("parseHttpRequest: PF open failed: %s\n", xstrerror());

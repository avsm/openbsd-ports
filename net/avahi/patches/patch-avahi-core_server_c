$OpenBSD: patch-avahi-core_server_c,v 1.4 2011/04/25 10:02:43 ajacoutot Exp $
--- avahi-core/server.c.orig	Tue Mar  8 22:54:10 2011
+++ avahi-core/server.c	Mon Apr 25 11:42:00 2011
@@ -911,6 +911,11 @@ static void dispatch_packet(AvahiServer *s, AvahiDnsPa
         return;
     }
 
+    if (port <= 0) {
+        avahi_log_warn("Received packet from invalid source port.");
+        return;
+    }
+
     if (avahi_address_is_ipv4_in_ipv6(src_address))
         /* This is an IPv4 address encapsulated in IPv6, so let's ignore it. */
         return;

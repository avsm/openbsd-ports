$OpenBSD: patch-configure_ac,v 1.4 2010/12/19 18:19:56 shadchin Exp $
--- configure.ac.orig	Wed Dec  8 04:14:55 2010
+++ configure.ac	Fri Dec 17 23:05:57 2010
@@ -793,13 +793,21 @@ AC_ARG_ENABLE( jack,
                 [enable_jack="yes"])
 
 if test "x$enable_jack" = "xyes"; then
-        AM_PATH_JACK(have_jack=yes, have_jack=no)
+	PKG_CHECK_MODULES(JACK, jack >= 0.109.10, , [AC_MSG_WARN(
+	[*** Cannot find jack 0.109.10 or newer, jack will not be built ***])
+	enable_jack=no])
 else
         AC_MSG_RESULT([*** jack plugin disabled per user request ***])
-        have_jack=no
+        enable_jack=no
 fi
 
-if test "x$have_jack" = "xyes"; then
+if test "x$enable_jack" = xyes; then
+       PKG_CHECK_MODULES(SAMPLERATE, samplerate >= 0.0.15, , [AC_MSG_WARN(
+       [Could not find libsamplerate, necessary for jack output plugin.])
+       enable_jack=no])
+fi
+
+if test "x$enable_jack" = xyes; then
 	OUTPUT_PLUGINS="$OUTPUT_PLUGINS jack"
 fi
 
@@ -1524,6 +1532,20 @@ if test "x$enable_resample" = "xyes"; then
 	EFFECT_PLUGINS="$EFFECT_PLUGINS resample"
 fi
 
+dnl *** sndio
+
+AC_ARG_ENABLE(sndio,
+    [  --enable-sndio          enable sndio output plugin (default=disabled) ],
+    [have_sndio=$enableval],
+    [have_sndio=no]
+)
+
+if test "x$have_sndio" = "xyes"; then
+	OUTPUT_PLUGINS="$OUTPUT_PLUGINS sndio"
+else
+	have_sndio=no
+fi
+
 dnl *** End of all plugin checks ***
 
 AC_SUBST(ARCH_DEFINES)
@@ -1619,6 +1641,7 @@ echo "    -> FileWriter MP3 output part:        $have_
 echo "    -> FileWriter Vorbis output part:     $have_vorbisenc"
 echo "    -> FileWriter FLAC output part:       $have_writer_flac"
 echo "  Null Audio output (null):               yes"
+echo "  Sndio Audio output (sndio):             $have_sndio"
 echo
 echo "  Input Plugins"
 echo "  -------------"

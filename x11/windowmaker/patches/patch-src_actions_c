--- src/actions.c	Mon Aug 11 15:29:31 2003
+++ src/actions.c	Mon Aug 11 15:31:56 2003
@@ -144,6 +144,14 @@
       old_scr=scr;
     old_focused=old_scr->focused_window;
 
+    /*
+     * Safeguard: make sure the timestamp is monotonically increasing
+     * (very unlikely that this will be needed, still a safeguard)
+     */
+    if (timestamp <= LastFocusChange)
+	    timestamp = LastFocusChange + 1;
+
+
     LastFocusChange = timestamp;
 
 /*
@@ -150,8 +158,8 @@
  * This is a hack, because XSetInputFocus() should have a proper
  * timestamp instead of CurrentTime but it seems that some times
  * clients will not receive focus properly that way.
+ */
     if (ignoreTimestamp)
-*/
       timestamp = CurrentTime;
 
     if (old_focused)

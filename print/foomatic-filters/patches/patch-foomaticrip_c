$OpenBSD: patch-foomaticrip_c,v 1.4 2010/05/07 16:08:54 ajacoutot Exp $

From pkgsrc.
Prevent bogus 'Job does not start with "%!", is it PostScript?' errors.

--- foomaticrip.c.orig	Fri May  7 17:58:43 2010
+++ foomaticrip.c	Fri May  7 18:00:38 2010
@@ -1053,6 +1053,7 @@ int print_file(const char *filename, int convert)
                 if (dup2(fileno(out), fileno(stdin)) < 0)
                     rip_die(EXIT_PRNERR_NORETRY_BAD_SETTINGS,
                             "Couldn't dup stdout of pdf-to-ps\n");
+		rewind(stdin);
 
                 ret = print_file("<STDIN>", 0);
 
@@ -1084,6 +1085,7 @@ int print_file(const char *filename, int convert)
             /* Read further data from the file converter and not from STDIN */
             if (dup2(fileno(fchandle), fileno(stdin)) < 0)
                 rip_die(EXIT_PRNERR_NORETRY_BAD_SETTINGS, "Couldn't dup fileconverterhandle\n");
+	    rewind(stdin);
 
             ret = print_file("<STDIN>", 0);
 

$OpenBSD: patch-configure,v 1.6 2004/07/09 15:07:07 kevlo Exp $
--- configure.orig	Wed Mar 10 15:56:10 2004
+++ configure	Fri Jul  9 16:30:17 2004
@@ -4524,7 +4524,7 @@ if test "${ac_cv_lib_resolv_res_search+s
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lresolv  $LIBS"
+ #LIBS="-lresolv  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 #line $LINENO "configure"
 /* confdefs.h.  */
@@ -9010,7 +9010,7 @@ if test "${ac_cv_lib_resolv_res_search+s
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lresolv  $LIBS"
+ #LIBS="-lresolv  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 #line $LINENO "configure"
 /* confdefs.h.  */
@@ -9063,7 +9063,7 @@ if test $ac_cv_lib_resolv_res_search = y
 #define HAVE_LIBRESOLV 1
 _ACEOF
 
-  LIBS="-lresolv $LIBS"
+  #LIBS="-lresolv $LIBS"
 
 fi
 
@@ -9777,6 +9777,9 @@ fi;
       *-*-aix*)
         platform=__aix
         ;;
+      *-*-openbsd*)
+	platform=__openbsd
+	;;
       *)
         { echo "$as_me:$LINENO: WARNING: The system type is not recognized. If you believe that CyberSafe GSSAPI works on this platform, please update the configure script" >&5
 echo "$as_me: WARNING: The system type is not recognized. If you believe that CyberSafe GSSAPI works on this platform, please update the configure script" >&2;}
@@ -9786,7 +9789,7 @@ echo "$as_me: WARNING: The system type i
     cmu_saved_CPPFLAGS=$CPPFLAGS
 
     if test -d ${gssapi}; then
-       CPPFLAGS="$CPPFLAGS -I$gssapi/include"
+       CPPFLAGS="$CPPFLAGS -I$gssapi/include/kerberosV"
 # We want to keep -I in our CPPFLAGS, but only if we succeed
        cmu_saved_CPPFLAGS=$CPPFLAGS
        LDFLAGS="$LDFLAGS -L$gssapi/lib"
@@ -10089,7 +10092,7 @@ if test "${ac_cv_lib_resolv_res_search+s
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lresolv  $LIBS"
+ #LIBS="-lresolv  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 #line $LINENO "configure"
 /* confdefs.h.  */
@@ -10142,7 +10145,7 @@ if test $ac_cv_lib_resolv_res_search = y
 #define HAVE_LIBRESOLV 1
 _ACEOF
 
-  LIBS="-lresolv $LIBS"
+  #LIBS="-lresolv $LIBS"
 
 fi
 
@@ -10167,7 +10170,7 @@ if test "${ac_cv_lib_gssapi_gss_unwrap+s
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lgssapi $GSSAPIBASE_LIBS -lgssapi -lkrb5 -lasn1 -lroken ${LIB_CRYPT} ${LIB_DES} -lcom_err ${LIB_SOCKET} $LIBS"
+LIBS="-lgssapi $GSSAPIBASE_LIBS -lgssapi -lkrb5 -lasn1 -lcrypto ${LIB_CRYPT} ${LIB_DES} -lcom_err ${LIB_SOCKET} $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 #line $LINENO "configure"
 /* confdefs.h.  */
@@ -10516,8 +10519,8 @@ fi
     GSSAPIBASE_LIBS="$GSSAPIBASE_LIBS -lgssapi_krb5 -lkrb5 -lk5crypto -lcom_err"
     GSSAPIBASE_STATIC_LIBS="$GSSAPIBASE_LIBS $gssapi_dir/libgssapi_krb5.a $gssapi_dir/libkrb5.a $gssapi_dir/libk5crypto.a $gssapi_dir/libcom_err.a"
   elif test "$gss_impl" = "heimdal"; then
-    GSSAPIBASE_LIBS="$GSSAPIBASE_LIBS -lgssapi -lkrb5 -lasn1 -lroken ${LIB_CRYPT} ${LIB_DES} -lcom_err"
-    GSSAPIBASE_STATIC_LIBS="$GSSAPIBASE_STATIC_LIBS $gssapi_dir/libgssapi.a $gssapi_dir/libkrb5.a $gssapi_dir/libasn1.a $gssapi_dir/libroken.a $gssapi_dir/libcom_err.a ${LIB_CRYPT}"
+    GSSAPIBASE_LIBS="$GSSAPIBASE_LIBS -lgssapi -lkrb5 -lasn1 -lcrypto ${LIB_CRYPT} ${LIB_DES} -lcom_err"
+    GSSAPIBASE_STATIC_LIBS="$GSSAPIBASE_STATIC_LIBS $gssapi_dir/libgssapi.a $gssapi_dir/libkrb5.a $gssapi_dir/libasn1.a $gssapi_dir/libcrypto.a $gssapi_dir/libcom_err.a ${LIB_CRYPT}"
   elif test "$gss_impl" = "cybersafe03"; then
 # Version of CyberSafe with two libraries
     CPPFLAGS="$CPPFLAGS -D$platform -I${gssapi}/appsec-sdk/include"
@@ -10709,7 +10712,7 @@ if test "${ac_cv_lib_resolv_res_search+s
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lresolv  $LIBS"
+ #LIBS="-lresolv  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 #line $LINENO "configure"
 /* confdefs.h.  */
@@ -10758,7 +10761,7 @@ fi
 echo "$as_me:$LINENO: result: $ac_cv_lib_resolv_res_search" >&5
 echo "${ECHO_T}$ac_cv_lib_resolv_res_search" >&6
 if test $ac_cv_lib_resolv_res_search = yes; then
-  GSSAPIBASE_LIBS="$GSSAPIBASE_LIBS -lresolv"
+ GSSAPIBASE_LIBS="$GSSAPIBASE_LIBS"
 fi
 
   SASL_MECHS="$SASL_MECHS libgssapiv2.la"
@@ -11756,7 +11759,7 @@ if test "${ac_cv_lib_resolv_inet_aton+se
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lresolv  $LIBS"
+ #LIBS="-lresolv  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 #line $LINENO "configure"
 /* confdefs.h.  */
@@ -11809,7 +11812,7 @@ if test $ac_cv_lib_resolv_inet_aton = ye
 #define HAVE_LIBRESOLV 1
 _ACEOF
 
-  LIBS="-lresolv $LIBS"
+  #LIBS="-lresolv $LIBS"
 
 fi
 

$OpenBSD: patch-protocols_yahoo_yahoo_util_c,v 1.3 2007/11/19 11:44:33 martynas Exp $
--- protocols/yahoo/yahoo_util.c.orig	Mon Aug 20 16:27:16 2007
+++ protocols/yahoo/yahoo_util.c	Mon Nov 19 13:39:01 2007
@@ -42,11 +42,11 @@ char * y_string_append(char * string, char * append)
 
 	if(new_string == NULL) {
 		new_string = y_new(char, size);
-		strcpy(new_string, string);
+		strlcpy(new_string, string, size);
 		FREE(string);
 	}
 
-	strcat(new_string, append);
+	strlcat(new_string, append, size);
 
 	return new_string;
 }
@@ -82,7 +82,7 @@ char ** y_strsplit(char * str, char * sep, int nelem)
 	for(p=str, s=strstr(p,sep); i<nelem && s; p=s+l, s=strstr(p,sep), i++) {
 		int len = s-p;
 		vector[i] = y_new(char, len+1);
-		strncpy(vector[i], p, len);
+		strlcpy(vector[i], p, len+1);
 		vector[i][len] = '\0';
 	}
 

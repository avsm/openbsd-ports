--- Makefile.orig	Tue Nov 16 10:55:22 1999
+++ Makefile	Mon Dec 27 00:37:06 1999
@@ -2,13 +2,14 @@
 # $Id: Makefile,v 1.7 1999-11-16 15:55:13+00 mgk25 Rel $
 
 # Select an ANSI/ISO C compiler here, GNU gcc is recommended
-CC = gcc
+#CC = gcc
 
 # Options for the compiler: A high optimization level is suggested
 CCFLAGS = -O2 -W
 #CCFLAGS = -O -g -W -Wall -ansi -pedantic #-DDEBUG  # developer only
 
-CFLAGS = $(CCFLAGS) -I../libjbig
+CFLAGS += -Wall -I../libjbig
+
 
 VERSION=1.1
 
@@ -16,7 +17,12 @@
 	@echo "Enter 'make test' in order to start some automatic tests."
 
 lib:
-	(cd libjbig;  make "CC=$(CC)" "CFLAGS=$(CFLAGS)")
+.if defined(NO_SHARED_LIBS) && ${NO_SHARED_LIBS:U} == YES
+	(cd libjbig;  make "CC=$(CC)" "CFLAGS=$(CFLAGS)" "VERSION=$(VERSION)" "NO_SHARED_LIBS=Yes")
+.else
+	(cd libjbig;  make "CC=$(CC)" "CFLAGS=$(CFLAGS)" "VERSION=$(VERSION)")
+.endif
+
 
 pbm: lib
 	(cd pbmtools; make "CC=$(CC)" "CFLAGS=$(CFLAGS)")
@@ -45,3 +51,21 @@
 	scp ANNOUNCE \
 	  $(DISTUID)@$(DISTHOST):$(DISTPATH)/jbigkit-$(VERSION)-announce.txt
 	mv ../jbigkit-$(VERSION).tar.gz $(HOME)/.www/download/
+
+install:
+	mkdir -p ${PREFIX}/bin
+	mkdir -p ${PREFIX}/include
+	mkdir -p ${PREFIX}/lib
+	mkdir -p ${PREFIX}/man/man1
+	mkdir -p ${PREFIX}/man/man5
+	install -c -s -m 755 -o bin -g bin pbmtools/jbgtopbm ${PREFIX}/bin
+	install -c -s -m 755 -o bin -g bin pbmtools/pbmtojbg ${PREFIX}/bin
+	install -c -m 644 -o bin -g bin pbmtools/pbmtojbg.1 ${PREFIX}/man/man1
+	install -c -m 644 -o bin -g bin pbmtools/jbgtopbm.1 ${PREFIX}/man/man1
+	install -c -m 644 -o bin -g bin pbmtools/pbm.5 ${PREFIX}/man/man5
+	install -c -m 644 -o bin -g bin pbmtools/pgm.5 ${PREFIX}/man/man5
+	install -c -m 644 -o bin -g bin libjbig/jbig.h ${PREFIX}/include
+	install -c -m 644 -o bin -g bin libjbig/libjbig.a ${PREFIX}/lib
+	@if [ -f libjbig/libjbig.so.$(VERSION) ]; then \
+	install -c -m 644 -o bin -g bin libjbig/libjbig.so.$(VERSION) ${PREFIX}/lib;\
+	fi

$OpenBSD: patch-Source_cmListFileLexer_c,v 1.2 2006/12/18 16:04:31 espie Exp $
--- Source/cmListFileLexer.c.orig	Mon Dec  4 17:03:58 2006
+++ Source/cmListFileLexer.c	Sun Dec 17 11:07:03 2006
@@ -2088,7 +2088,7 @@ static void cmListFileLexerSetToken(cmLi
     {
     if(text && length < lexer->size)
       {
-      strcpy(lexer->token.text, text);
+      strlcpy(lexer->token.text, text, lexer->size);
       lexer->token.length = length;
       return;
       }
@@ -2121,7 +2121,7 @@ static void cmListFileLexerAppend(cmList
   newSize = lexer->token.length + length + 1;
   if(lexer->token.text && newSize <= lexer->size)
     {
-    strcpy(lexer->token.text+lexer->token.length, text);
+    strlcpy(lexer->token.text+lexer->token.length, text, lexer->size - lexer->token.length);
     lexer->token.length += length;
     return;
     }
@@ -2239,11 +2239,11 @@ int cmListFileLexer_SetString(cmListFile
   cmListFileLexerDestroy(lexer);
   if(text)
     {
-    int length = (int)strlen(text);
+    size_t length = strlen(text);
     lexer->string_buffer = (char*)malloc(length+1);
     if(lexer->string_buffer)
       {
-      strcpy(lexer->string_buffer, text);
+      strlcpy(lexer->string_buffer, text, length+1);
       lexer->string_position = lexer->string_buffer;
       lexer->string_left = length;
       }

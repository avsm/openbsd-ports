--- clamav-milter/clamav-milter.c.orig	Mon Feb 12 23:36:49 2007
+++ clamav-milter/clamav-milter.c	Wed Feb 14 08:26:32 2007
@@ -1064,7 +1064,7 @@ main(int argc, char **argv)
 		 * uid == 0 for that
 		 */
 		on = 1;
-		if(setsockopt(broadcastSock, SOL_SOCKET, SO_BROADCAST, (int *)&on, sizeof(on)) < 0) {
+		if(setsockopt(broadcastSock, SOL_SOCKET, 0, (int *)&on, sizeof(on)) < 0) {
 			perror("setsockopt");
 			return EX_UNAVAILABLE;
 		}
@@ -1086,7 +1086,7 @@ main(int argc, char **argv)
 
 			memset(&ifr, '\0', sizeof(struct ifreq));
 			strncpy(ifr.ifr_name, iface, sizeof(ifr.ifr_name) - 1);
-			if(setsockopt(broadcastSock, SOL_SOCKET, SO_BINDTODEVICE, &ifr, sizeof(ifr)) < 0) {
+			if(setsockopt(broadcastSock, SOL_SOCKET, 0, &ifr, sizeof(ifr)) < 0) {
 				perror(iface);
 				return EX_CONFIG;
 			}

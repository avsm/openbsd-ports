$OpenBSD: patch-src_filters_c,v 1.2 2004/08/08 14:02:11 sturm Exp $
--- src/filters.c.orig	Thu Jun 24 15:01:11 2004
+++ src/filters.c	Mon Aug  2 13:30:34 2004
@@ -177,7 +177,7 @@ else
                        break;
                    }
                 
-                sprintf(ebuff,"%d",i);
+                (void)snprintf(ebuff,sizeof(ebuff),"%d",i);
                 break;
             case filterexecregex:
                 for (sp = ebuff+strlen(ebuff)-1; (*sp != '(') && (sp > ebuff); sp--)
@@ -1025,15 +1025,15 @@ int FilterProcSTimeMatch(char *name1,cha
   char year[5],month[4],hr[3],min[3],day[3],timestr[256];
   
 memset(year,0,5);
-strcpy(year,VYEAR);
+(void)strlcpy(year,VYEAR,sizeof(year));
 memset(month,0,4); 
-strcpy(month,VMONTH);
+(void)strlcpy(month,VMONTH,sizeof(month));
 memset(day,0,3); 
-strcpy(day,VDAY);
+(void)strlcpy(day,VDAY,sizeof(day));
 memset(hr,0,3); 
-strcpy(hr,VHR);
+(void)strlcpy(hr,VHR,sizeof(hr));
 memset(min,0,3); 
-strcpy(min,VMINUTE); 
+(void)strlcpy(min,VMINUTE,sizeof(min)); 
 
 fromtime = Date2Number(fromexpr,now);
 totime = Date2Number(toexpr,now);
@@ -1153,7 +1153,7 @@ int FilterOwnerMatch(struct stat *lstatp
   char buffer[64];
   struct passwd *pw;
 
-sprintf(buffer,"%d",lstatptr->st_uid);
+(void)snprintf(buffer,sizeof(buffer),"%d",lstatptr->st_uid);
 PrependItem(&attrib,buffer,""); 
 
 if ((pw = getpwuid(lstatptr->st_uid)) != NULL)
@@ -1185,7 +1185,7 @@ int FilterGroupMatch(struct stat *lstatp
   char buffer[64];
   struct group *gr;
 
-sprintf(buffer,"%d",lstatptr->st_gid);
+(void)snprintf(buffer,sizeof(buffer),"%d",lstatptr->st_gid);
 PrependItem(&attrib,buffer,""); 
 
 if ((gr = getgrgid(lstatptr->st_gid)) != NULL)

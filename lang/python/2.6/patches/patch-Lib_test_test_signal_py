$OpenBSD: patch-Lib_test_test_signal_py,v 1.3 2010/09/16 22:36:08 fgsch Exp $

workarounds for breakage caused by libpthread

--- Lib/test/test_signal.py.orig	Thu Jun  3 17:04:47 2010
+++ Lib/test/test_signal.py	Mon Aug 30 13:50:39 2010
@@ -364,6 +364,12 @@ class SiginterruptTest(unittest.TestCase):
         a false value for the second argument, when that signal arrives, it
         does not interrupt a syscall that's in progress.
         """
+        if sys.platform.startswith('openbsd'):
+            if test_support.verbose:
+                sys.stderr.write('skipping -- siginterrupt not reliable (does '
+                                 'not mix well with threading) on %s\n' %
+                                 sys.platform)
+            return
         signal.siginterrupt(self.signum, 0)
         i = self.readpipe_interrupted()
         self.assertFalse(i)
@@ -463,10 +469,11 @@ class ItimerTest(unittest.TestCase):
 
     def test_itimer_prof(self):
         # Issue 3864, unknown if this affects earlier versions of freebsd also
-        if sys.platform=='freebsd6':
+        if sys.platform=='freebsd6' or sys.platform.startswith('openbsd'):
             if test_support.verbose:
                 sys.stderr.write('skipping -- itimer not reliable (does not '
-                                 'mix well with threading) on freebsd6\n')
+                                 'mix well with threading) on %s\n' %
+                                 sys.platform)
             return
         self.itimer = signal.ITIMER_PROF
         signal.signal(signal.SIGPROF, self.sig_prof)

$OpenBSD: patch-src_md_c,v 1.3 2007/12/11 11:04:58 jakemsr Exp $
--- src/md.c.orig	Sat Jan  5 00:47:34 2002
+++ src/md.c	Tue Dec 11 00:04:50 2007
@@ -216,13 +216,13 @@ void md5_process_block (const void *buffer, unsigned c
 /****************************************************/
 /* convert the given md5sum into a printable string */
 /****************************************************/
-void md5tostr(const unsigned char md5sum[MD5SUMLEN],char str[3*MD5SUMLEN+1])
+void md5tostr(const unsigned char md5sum[MD5SUMLEN],char str[3*MD5SUMLEN+1], size_t len)
 {
 	int i;
 	for(i=0;i<MD5SUMLEN;i++)
 	{
 		unsigned int v=md5sum[i];
-		sprintf(str+3*i,"%1u%1u%1u",v/100,(v%100)/10,v%10);
+		snprintf(str+3*i,len-3*i,"%1u%1u%1u",v/100,(v%100)/10,v%10);
 	}
 }
 

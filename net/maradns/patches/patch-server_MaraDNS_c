$OpenBSD: patch-server_MaraDNS_c,v 1.1.2.1 2007/06/17 08:44:46 sturm Exp $
--- server/MaraDNS.c.orig	Thu May 17 06:01:44 2007
+++ server/MaraDNS.c	Sun Jun 17 10:41:34 2007
@@ -2999,6 +2999,8 @@ int star_collision(js_string *lookfor, m
               spot_data.datatype == MARA_DNS_LIST) {
             /* There is a RR phohibiting the star record.  Return
              * name error */
+		be_anal->string--;
+		js_destroy(be_anal);
             return 1;
             }
       	be_anal->string--;

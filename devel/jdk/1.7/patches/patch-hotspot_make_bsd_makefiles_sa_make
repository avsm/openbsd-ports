$OpenBSD: patch-hotspot_make_bsd_makefiles_sa_make,v 1.1 2009/01/04 23:25:16 kurt Exp $
--- hotspot/make/bsd/makefiles/sa.make.orig	Mon Dec 22 14:34:14 2008
+++ hotspot/make/bsd/makefiles/sa.make	Mon Dec 22 20:50:40 2008
@@ -31,6 +31,7 @@
 include $(GAMMADIR)/make/bsd/makefiles/rules.make
 
 AGENT_DIR = $(GAMMADIR)/agent
+SASRCDIR = $(AGENT_DIR)/src/os/$(Platform_os_family)
 
 include $(GAMMADIR)/make/sa.files
 
@@ -42,8 +43,8 @@ SA_CLASSPATH = $(BOOT_JAVA_HOME)/lib/tools.jar
 
 # gnumake 3.78.1 does not accept the *s that
 # are in AGENT_FILES1 and AGENT_FILES2, so use the shell to expand them
-AGENT_FILES1 := $(shell /usr/bin/test -d $(AGENT_DIR) && /bin/ls $(AGENT_FILES1))
-AGENT_FILES2 := $(shell /usr/bin/test -d $(AGENT_DIR) && /bin/ls $(AGENT_FILES2))
+AGENT_FILES1 := $(shell /bin/test -d $(AGENT_DIR) && /bin/ls $(AGENT_FILES1))
+AGENT_FILES2 := $(shell /bin/test -d $(AGENT_DIR) && /bin/ls $(AGENT_FILES2))
 
 SA_CLASSDIR = $(GENERATED)/saclasses
 
@@ -51,11 +52,11 @@ SA_BUILD_VERSION_PROP = "sun.jvm.hotspot.runtime.VM.sa
 
 SA_PROPERTIES = $(SA_CLASSDIR)/sa.properties
 
-# if $(AGENT_DIR) does not exist, we don't build SA
+# if $(SASRCDIR) does not exist, we don't build SA
 # also, we don't build SA on Itanium.
 
 all: 
-	if [ -d $(AGENT_DIR) -a "$(SRCARCH)" != "ia64" ] ; then \
+	if [ -d $(SASRCDIR) -a "$(SRCARCH)" != "ia64" ] ; then \
 	   $(MAKE) -f sa.make $(GENERATED)/sa-jdi.jar; \
 	fi
 

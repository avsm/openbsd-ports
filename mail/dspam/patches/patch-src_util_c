$OpenBSD: patch-src_util_c,v 1.1 2005/10/26 06:18:39 jakob Exp $
--- src/util.c.orig	Sat Oct  1 06:32:19 2005
+++ src/util.c	Mon Oct 17 14:48:42 2005
@@ -278,7 +278,7 @@ const char * _ds_userdir_path (char *pat
 #endif
 
   if (p == NULL) 
-      strcpy(userhome, home);
+      strlcpy(userhome, home, sizeof(userhome));
   else
       strlcpy(userhome, p->pw_dir, sizeof(userhome));
 
@@ -307,7 +307,7 @@ const char * _ds_userdir_path (char *pat
   free(f);
 #else
   strlcpy(username, filename, MAX_FILENAME_LENGTH);
-  strcpy(userpath, username);
+  strlcpy(userpath, username, sizeof (userpath));
 #endif
 
   /* Use home/opt-in/ and home/opt-out/ to store opt files, instead of
@@ -675,6 +675,7 @@ float _ds_round(float n) {
   return (r/100.0);
 }
 
+#ifndef __HAVE_STRCASESTR__
 char *
 strcasestr(s, find)
 	const char *s, *find;
@@ -695,6 +696,7 @@ strcasestr(s, find)
 	}
 	return ((char *)s);
 }
+#endif
 
 #ifndef HAVE_INET_NTOA_R
 /*
@@ -746,6 +748,7 @@ inet_ntoa_r(struct in_addr in, char *buf
     return(NULL);
   }
 
-  return strcpy(buf, b);
+  strlcpy(buf, b, len);
+  return buf;
 }
 #endif

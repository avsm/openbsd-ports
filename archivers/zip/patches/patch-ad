*** zipcloak.c.orig	Tue Nov 25 16:22:20 1997
--- zipcloak.c	Tue Nov 25 16:24:56 1997
***************
*** 342,350 ****
      attr = getfileattr(zipfile);
  
      /* Open output zip file for writing */
!     if ((tempzf = outzip = fopen(tempzip = tempname(zipfile), FOPW)) == NULL) {
          ziperr(ZE_TEMP, tempzip);
-     }
  
      /* Get password */
      if (getp("Enter password: ", passwd, PWLEN+1) == NULL)
--- 342,352 ----
      attr = getfileattr(zipfile);
  
      /* Open output zip file for writing */
!     tempzip = tempname(zipfile, outzip);
!     tempzf = outzip;
! 
!     if ((tempzip == NULL) || (outzip == NULL))
          ziperr(ZE_TEMP, tempzip);
  
      /* Get password */
      if (getp("Enter password: ", passwd, PWLEN+1) == NULL)

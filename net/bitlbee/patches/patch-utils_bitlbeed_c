$OpenBSD: patch-utils_bitlbeed_c,v 1.2 2004/10/21 14:48:51 naddy Exp $
--- utils/bitlbeed.c.orig	Wed Jul  7 23:27:38 2004
+++ utils/bitlbeed.c	Thu Oct 14 15:43:35 2004
@@ -408,14 +408,14 @@ void do_log( char *fmt, ... )
 	memset( line, 0, MAX_LOG_LEN );
 	
 	tm = time( NULL );
-	strcpy( line, ctime( &tm ) );
+	strlcpy( line, ctime( &tm ), sizeof(line) );
 	l = strlen( line );
 	line[l-1] = ' ';
 	
 	va_start( params, fmt );
-	vsnprintf( line + l, MAX_LOG_LEN - l - 2, fmt, params );
+	vsnprintf( line + l, sizeof(line) - l - 2, fmt, params );
 	va_end( params );
-	strcat( line, "\n" );
+	strlcat( line, "\n", sizeof(line) );
 	
 	fprintf( logfile, "%s", line );
 }

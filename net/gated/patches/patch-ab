--- src/task.c.orig	Sun Mar 14 13:21:49 1999
+++ src/task.c	Sun Mar 14 13:24:50 1999
@@ -5862,12 +5862,20 @@
 	}
 
 	/* Remove our association with a controling tty */
-#ifdef	USE_SETPGRP
+#if defined(USE_SETPGRP) || defined(USE_SETSID)
+#if defined(USE_SETPGRP)
 	t = setpgrp();
 	if (t < 0) {
 	    perror("task_daemonize: setpgrp");
 	    exit(1);
 	}
+#else  /* USE_SETPGRP */
+	t = setsid();
+	if (t < 0) {
+	    perror("task_daemonize: setsid");
+	    exit(1);
+	}
+#endif /* USE_SETPGRP */
 
 	task_signal_ignore(SIGHUP);
 
@@ -5886,7 +5894,7 @@
 	    /* Parent */
 	    exit(0);
 	}
-#else	/* USE_SETPGRP */
+#else  /* defined(USE_SETPGRP) || defined(USE_SETSID) */
 	t = setpgrp(0, getpid());
 	if (t < 0) {
 	    perror("task_daemonize: setpgrp");
@@ -5901,7 +5909,7 @@
 	    }
 	    (void) close(t);
 	}
-#endif	/* USE_SETPGRP */
+#endif /* defined(USE_SETPGRP) || defined(USE_SETSID) */
     }
 
     /* Close all open files */

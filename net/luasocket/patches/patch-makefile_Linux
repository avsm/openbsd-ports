$OpenBSD: patch-makefile_Linux,v 1.2 2004/12/29 07:29:16 pvalchev Exp $
--- makefile.Linux.orig	Mon Jul 26 14:17:35 2004
+++ makefile.Linux	Wed Dec 29 00:29:02 2004
@@ -3,28 +3,13 @@ MV=1.0
 
 LUAC=luac
 BIN2C=bin2c
-CC=gcc
-OPT=-O2  
-DEF = -DLUASOCKET_DEBUG #-Dsocklen_t=int
 
-LOBJS= \
-	luasocket.o \
-	timeout.o \
-	buffer.o \
-	io.o \
-	auxiliar.o \
-	except.o \
-	select.o \
-	options.o \
-	inet.o \
-	tcp.o \
-	udp.o \
-	usocket.o 
+LOBJS=	luasocket.o timeout.o buffer.o io.o auxiliar.o except.o select.o\
+	options.o inet.o tcp.o udp.o usocket.o 
 
-MOBJS= \
-	mime.o 
+MOBJS=	mime.o 
 
-CFLAGS=-I../../include $(PROF) $(OPT) $(DBG) $(DEF) -pedantic -W -Wall 
+CFLAGS+= -I$(LOCALBASE)/include -fPIC -DPIC
 
 LDYN=luasocket.so.$(LV)
 
@@ -33,10 +18,10 @@ MDYN=mime.so.$(MV)
 all: $(LDYN) $(MDYN)
 
 $(LDYN): $(LOBJS)
-	gcc -shared -o $(LDYN) $(LOBJS)
+	$(CC) -shared -fPIC -o $(LDYN) $(LOBJS)
 
 $(MDYN): $(MOBJS)
-	gcc -shared -o $(MDYN) $(MOBJS)
+	$(CC) -shared -fPIC -o $(MDYN) $(MOBJS)
 
 # dependencies
 auxiliar.o: auxiliar.c auxiliar.h

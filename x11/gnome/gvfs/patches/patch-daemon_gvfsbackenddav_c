$OpenBSD: patch-daemon_gvfsbackenddav_c,v 1.2 2009/10/11 13:32:27 ajacoutot Exp $

Fix unmounting webdav share:
    http://bugzilla.gnome.org/show_bug.cgi?id=567664

--- daemon/gvfsbackenddav.c.orig	Tue Jul 14 13:07:59 2009
+++ daemon/gvfsbackenddav.c	Sun Oct 11 11:37:38 2009
@@ -2304,13 +2304,13 @@ do_set_display_name (GVfsBackend           *backend,
   soup_uri_free (source);
 }
 
-static gboolean
-try_unmount (GVfsBackend    *backend,
+static void
+do_unmount (GVfsBackend    *backend,
              GVfsJobUnmount *job,
              GMountUnmountFlags flags,
              GMountSource *mount_source)
 {
-  _exit (0);
+  g_vfs_job_succeeded (G_VFS_JOB (job));
 }
 
 /* ************************************************************************* */
@@ -2338,5 +2338,5 @@ g_vfs_backend_dav_class_init (GVfsBackendDavClass *kla
   backend_class->make_directory    = do_make_directory;
   backend_class->delete            = do_delete;
   backend_class->set_display_name  = do_set_display_name;
-  backend_class->try_unmount       = try_unmount;
+  backend_class->unmount           = do_unmount;
 }

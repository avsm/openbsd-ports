$OpenBSD: patch-src_common_util_c,v 1.1 2006/06/10 08:33:36 steven Exp $
--- src/common/util.c.orig	Fri Jun  9 18:22:20 2006
+++ src/common/util.c	Fri Jun  9 18:23:58 2006
@@ -609,7 +609,7 @@ esc_for_log(const char *s)
         len += 2;
         break;
       default:
-        if (TOR_ISPRINT(*cp))
+        if (TOR_ISPRINT(*cp) && ((uint8_t)*cp)<127) 
           ++len;
         else
           len += 4;
@@ -640,7 +640,7 @@ esc_for_log(const char *s)
         *outp++ = 'r';
         break;
       default:
-        if (TOR_ISPRINT(*cp)) {
+        if (TOR_ISPRINT(*cp) && ((uint8_t)*cp)<127) { 
           *outp++ = *cp;
         } else {
           tor_snprintf(outp, 5, "\\%03o", (uint8_t) *cp);

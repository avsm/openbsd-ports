$OpenBSD: patch-panels_printers_pp-new-printer-dialog_c,v 1.4 2011/10/02 13:31:33 ajacoutot Exp $

No PackageKit on OpenBSD.

https://bugzilla.gnome.org/show_bug.cgi?id=660692

--- panels/printers/pp-new-printer-dialog.c.orig	Mon Sep 26 18:04:02 2011
+++ panels/printers/pp-new-printer-dialog.c	Sun Oct  2 15:24:36 2011
@@ -1514,6 +1514,7 @@ new_printer_add_button_cb (GtkButton *button,
                        pp->devices[device_id].device_make_and_model,
                        pp->devices[device_id].device_uri);
 
+#ifndef __OpenBSD__
           if (ppd_name == NULL || ppd_name->ppd_match_level < PPD_EXACT_MATCH)
             {
               /* Try PackageKit to install printer driver */
@@ -1568,6 +1569,7 @@ new_printer_add_button_cb (GtkButton *button,
                   g_free (device_ids);
                 }
             }
+#endif
 
           /* Add the new printer */
           if (ppd_name && ppd_name->ppd_name)
@@ -1665,7 +1667,9 @@ new_printer_add_button_cb (GtkButton *button,
 
 
               /* Set default PaperSize according to the locale */
+#ifdef LC_PAPER
               locale = setlocale (LC_PAPER, NULL);
+#endif
               if (locale == NULL)
                 locale = setlocale (LC_MESSAGES, NULL);
 

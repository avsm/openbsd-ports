$OpenBSD: patch-Makefile,v 1.5 2009/03/24 14:51:04 naddy Exp $
--- Makefile.orig	Mon Aug 25 22:11:23 2008
+++ Makefile	Tue Mar 24 15:50:10 2009
@@ -1,14 +1,24 @@
 objects := $(patsubst %.c,%.o,$(wildcard *.c))
 
-CFLAGS= -Os -s -Wall -DNUTDIR=\".nutdb\" -DFOODDIR=\"/usr/local/lib/nut\" -ansi -pedantic
+CFLAGS+= -Wall -pedantic -ansi -DNUTDIR=\".nutdb\" -DFOODDIR=\"$(PREFIX)/lib/nutdb\"
 
 nut:	$(objects)
-	gcc ${CFLAGS} -lm -o nut $(objects)
+	${CC} ${CFLAGS} -o nut $(objects) -lm
 
+anameal.o: anameal.c
+	${CC} ${CFLAGS} $(EXTRA_CFLAGS) -c $< -o $@
+
+food.o: food.c
+	${CC} ${CFLAGS} $(EXTRA_CFLAGS) -c $< -o $@
+
 deps:
 	makedepend *.c
 
 clean:
 	rm -f *.o nut preprocess/*.o preprocess/dbjw
 
-# DO NOT DELETE
+install:
+	mkdir $(PREFIX)/lib/nutdb/
+	${BSD_INSTALL_PROGRAM} nut $(PREFIX)/bin/nutdb
+	${BSD_INSTALL_MAN} nut.1 $(PREFIX)/man/man1/nutdb.1
+	${BSD_INSTALL_DATA} raw.data/* $(PREFIX)/lib/nutdb/

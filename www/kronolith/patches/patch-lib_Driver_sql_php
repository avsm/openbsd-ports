$OpenBSD: patch-lib_Driver_sql_php,v 1.2 2008/11/08 11:23:07 mbalmer Exp $
--- lib/Driver/sql.php.orig	Wed Sep  3 22:29:54 2008
+++ lib/Driver/sql.php	Sat Nov  8 12:21:21 2008
@@ -307,17 +307,17 @@ class Kronolith_Driver_sql extends Kronolith_Driver {
         $etime = sprintf('%04d-%02d-%02d 00:00:00', $endInterval->year, $endInterval->month, $endInterval->mday);
         if (isset($startInterval)) {
             $stime = sprintf('%04d-%02d-%02d 00:00:00', $startInterval->year, $startInterval->month, $startInterval->mday);
-            $q .= 'event_end > ? AND ';
+            $q .= 'event_end > CAST(? as timestamp) AND ';
             $values[] = $stime;
         }
-        $q .= 'event_start < ?) OR (';
+        $q .= 'event_start < CAST(? as timestamp)) OR (';
         $values[] = $etime;
         if (isset($stime)) {
-            $q .= 'event_recurenddate >= ? AND ';
+            $q .= 'event_recurenddate >= CAST(? as timestamp) AND ';
             $values[] = $stime;
         }
-        $q .= 'event_start <= ?' .
-            ' AND event_recurtype <> ?))';
+        $q .= 'event_start <= CAST(? as timestamp)' .
+            ' AND event_recurtype <> CAST(? as varchar)))';
         array_push($values, $etime, HORDE_DATE_RECUR_NONE);
 
         /* Log the query at a DEBUG log level. */

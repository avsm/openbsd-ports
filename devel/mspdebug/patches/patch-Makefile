$OpenBSD: patch-Makefile,v 1.1.1.1 2010/12/02 10:35:04 jasper Exp $

- Add missing libraries and cflags.

--- Makefile.orig	Wed Aug  4 04:08:43 2010
+++ Makefile	Thu Aug 12 12:58:14 2010
@@ -15,7 +15,7 @@
 # along with this program; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 
-CC = gcc
+CC ?= gcc
 INSTALL = /usr/bin/install
 PREFIX ?= /usr/local
 
@@ -24,7 +24,7 @@ ifdef WITHOUT_READLINE
 	READLINE_LIBS =
 else
 	READLINE_CFLAGS = -DUSE_READLINE
-	READLINE_LIBS = -lreadline
+	READLINE_LIBS = -lreadline -ltermcap
 endif
 
 # Mac OS X/MacPorts stuff
@@ -57,7 +57,7 @@ mspdebug: main.o fet.o rf2500.o dis.o uif.o olimex.o i
           util.o bsl.o sim.o symmap.o gdb.o btree.o rtools.o sym.o devcmd.o \
 	  cproc.o vector.o cproc_util.o expr.o fet_error.o binfile.o fet_db.o \
 	  usbutil.o titext.o srec.o device.o coff.o
-	$(CC) $(LDFLAGS) $(MACPORTS_LDFLAGS) -o $@ $^ -lusb $(READLINE_LIBS)
+	$(CC) $(LDFLAGS) $(MACPORTS_LDFLAGS) -o $@ $^ `pkg-config --libs libelf libusb` $(READLINE_LIBS)
 
 .c.o:
-	$(CC) $(CFLAGS) $(MACPORTS_CFLAGS) $(READLINE_CFLAGS) $(MSPDEBUG_CFLAGS) -o $@ -c $*.c
+	$(CC) $(CFLAGS) `pkg-config --cflags libelf libusb` $(MACPORTS_CFLAGS) $(READLINE_CFLAGS) $(MSPDEBUG_CFLAGS) -o $@ -c $*.c

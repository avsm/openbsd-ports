$OpenBSD: patch-security_manager_ssl_src_nsNSSComponent_cpp,v 1.1.1.1 2009/07/27 21:36:01 martynas Exp $
--- security/manager/ssl/src/nsNSSComponent.cpp.orig	Tue Jul  1 01:54:11 2008
+++ security/manager/ssl/src/nsNSSComponent.cpp	Wed Jul 16 14:18:08 2008
@@ -702,11 +702,10 @@ nsNSSComponent::InstallLoadableRoots()
       return;
 
     const char *possible_ckbi_locations[] = {
+      0, // This special value means: 
+        //   search for ckbi in the the system NSS_LIBDIR
       NS_GRE_DIR,
-      NS_XPCOM_CURRENT_PROCESS_DIR,
-      0 // This special value means: 
-        //   search for ckbi in the directories on the shared
-        //   library/DLL search path
+      NS_XPCOM_CURRENT_PROCESS_DIR
     };
 
     for (size_t il = 0; il < sizeof(possible_ckbi_locations)/sizeof(const char*); ++il) {
@@ -715,7 +714,7 @@ nsNSSComponent::InstallLoadableRoots()
 
       if (!possible_ckbi_locations[il])
       {
-        fullModuleName = PR_GetLibraryName(nsnull, "nssckbi");
+        fullModuleName = PR_GetLibraryName(NSS_LIBDIR, "nssckbi");
       }
       else
       {

--- bonobo-activation/bonobo-activation-fork-server.c.orig	Wed Jul 20 00:02:15 2005
+++ bonobo-activation/bonobo-activation-fork-server.c	Sun Sep 11 20:22:42 2005
@@ -359,10 +359,18 @@ bonobo_activation_server_by_forking (
                 g_source_destroy (source);
                 g_source_unref (source);
                 
+                g_io_channel_shutdown (ai.ioc, FALSE, NULL);
                 g_io_channel_unref (ai.ioc);
                 
                 if (use_new_loop)
                         g_main_context_unref (context);
+
+                close (iopipes[1]);
+
+                g_strfreev(newenv);
+
+                if (fd_arg != 0)
+                        g_free ((char *) cmd[fd_arg]);
 
 		return CORBA_OBJECT_NIL;
 	}

# $OpenBSD: Makefile,v 1.6 2004/04/04 14:10:09 brad Exp $

COMMENT=	"tools and library routines for working with GIF images"

DISTNAME=	libungif-4.1.0b1
CATEGORIES=	graphics
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=libungif/}
EXTRACT_SUFX=	.tar.bz2

HOMEPAGE=	http://sourceforge.net/projects/libungif/

MAINTAINER=	Brad Smith <brad@openbsd.org>

PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

CONFIGURE_STYLE= autoconf
CONFIGURE_ARGS+= ${CONFIGURE_SHARED}
CONFIGURE_ARGS+= --enable-static --without-x

PATCH_LIST=	${PORTSDIR}/infrastructure/patches/patch-lt1.3.3-ltconfig \
		${PORTSDIR}/infrastructure/patches/patch-lt1.3.3-ltmain_sh \
		patch-*

DOCS=	COPYING UNCOMPRESSED_GIF
HTMLDOCS= *.html *.txt *.png
DOCSDIR= ${PREFIX}/share/doc/libungif

pre-build:
	@touch ${WRKSRC}/aclocal.m4
	@find ${WRKSRC} -name 'Makefile.in' -print | xargs touch

post-install:
	@cd ${PREFIX}/lib; \
	for f in libungif.a libungif.so.5.0; do \
		g=`echo $$f | sed -e s#libungif#libgif#g`; \
		ln -sf $$f $$g; \
	done && \
	sed -e s#libungif#libgif#g libungif.la > libgif.la && \
	chown ${LIBOWN}:${LIBGRP} libgif.la && \
	chmod 755 libgif.la
	${INSTALL_DATA_DIR} ${DOCSDIR}
	cd ${WRKSRC}; ${INSTALL_DATA} ${DOCS} ${DOCSDIR}
	${INSTALL_DATA_DIR} ${DOCSDIR}/html
	cd ${WRKSRC}/doc; ${INSTALL_DATA} ${HTMLDOCS} ${DOCSDIR}/html

.include <bsd.port.mk>

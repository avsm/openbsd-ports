$OpenBSD: patch-configure_in,v 1.3 2008/08/25 15:14:43 jasper Exp $
--- configure.in.orig	Fri Jan  9 19:17:46 2004
+++ configure.in	Sun Aug 24 13:24:50 2008
@@ -117,6 +117,7 @@ if test "x$have_gcrypt" != "xyes"; then
 	fi
 fi
 
+AC_CHECK_LIB(pthread, main, [AC_DEFINE(HAVE_LIBPTHREAD, 1), LIBS="$LIBS -pthread"])
 
 dnl Checks for libraries.
 AC_ARG_ENABLE(glib2,[  --disable-glib2           Use glib1.2 instead of glib 2.x])
@@ -143,7 +144,7 @@ if test "x$db_dir" != "x"; then
 fi
 
 dnl Check if BerkeleyDB include is available
-AC_CHECK_HEADERS(db.h, ,AC_MSG_ERROR(BerkeleyDB include required.))
+AC_CHECK_HEADERS(db/db.h, ,AC_MSG_ERROR(BerkeleyDB include required.))
 
 dnl choose between auto-detected Berkeley DB using db.h content and manually try to link db
 AC_ARG_ENABLE(manual-db-detect,[  --enable-manual-db-detect  Disable automatic Berkeley DB version detection using db.h], [manu_db="yes"], [manu_db="no"])
@@ -258,7 +259,7 @@ else
 fi
 
 AC_MSG_CHECKING(whether MSG_NOSIGNAL exists)
-AC_TRY_COMPILE([#include <sys/socket.h>],
+AC_TRY_COMPILE([#include <sys/types.h> #include <sys/socket.h>],
 [
 int main()
 {
@@ -310,7 +311,7 @@ fi
 dnl Checks for header files.
 AC_HEADER_DIRENT
 AC_HEADER_STDC
-AC_CHECK_HEADERS(fcntl.h limits.h strings.h sys/file.h sys/ioctl.h sys/time.h unistd.h errno.h signal.h sys/poll.h sys/param.h openssl/md5.h openssl/md4.h gcrypt.h)
+AC_CHECK_HEADERS(fcntl.h limits.h strings.h sys/file.h sys/ioctl.h sys/time.h unistd.h errno.h signal.h sys/poll.h sys/param.h openssl/md5.h openssl/md4.h gcrypt.h linux/sem.h getopt.h)
 
 dnl Checks for typedefs, structures, and compiler characteristics.
 AC_C_CONST
@@ -323,7 +324,7 @@ AC_STRUCT_TM
 dnl Checks for library functions.
 AC_FUNC_MEMCMP
 AC_FUNC_MMAP
-AC_CHECK_FUNCS(getcwd mkdir select socket strdup strerror strstr strtod strtoul uname)
+AC_CHECK_FUNCS(getcwd mkdir select socket strdup strerror strstr strtod strtoul uname getopt_long)
 
 dnl *** Checks if the CPU allows unaligned access ***
 AC_MSG_CHECKING(CPU allows unaligned memory access)

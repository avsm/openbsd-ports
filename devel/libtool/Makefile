# $OpenBSD: Makefile,v 1.35 2004/12/18 21:38:18 brad Exp $
# $FreeBSD: Makefile,v 1.2 1998/09/23 16:15:53 vanilla Exp $

COMMENT=	"generic shared library support script"
COMMENT-ltdl=	"GNU libtool system independent dlopen wrapper"

VERSION=	1.5.10
DISTNAME=	libtool-${VERSION}
PKGNAME=	${DISTNAME}p1
PKGNAME-ltdl=	libltdl-${VERSION}
CATEGORIES=	devel
MASTER_SITES=	${MASTER_SITE_GNU:=libtool/}

HOMEPAGE=	http://www.gnu.org/software/libtool/

AUTOCONF_VERSION= 2.59
BUILD_DEPENDS+=	${MODGNU_AUTOCONF_DEPENDS}

MAINTAINER=	Brad Smith <brad@openbsd.org>

# GPL
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

MAKE_ENV+=	MAKEINFOFLAGS="--no-split"

CONFIGURE_STYLE= gnu
CONFIGURE_ARGS+= ${CONFIGURE_SHARED}

MULTI_PACKAGES=	-ltdl
SUBPACKAGE?=

.if defined(PACKAGING)
. if empty(SUBPACKAGE)
RUN_DEPENDS+=	::devel/libtool,-ltdl
. endif
.endif

pre-configure:
	@rm -f ${WRKSRC}/doc/libtool.info*

do-regress:
	cd ${WRKDIR}/bin && ln -sf ${LOCALBASE}/bin/autoconf-2.59 autoconf
	cd ${WRKBUILD} && exec ${SETENV} ${MAKE_ENV} ${MAKE_PROGRAM} check

.include <bsd.port.mk>

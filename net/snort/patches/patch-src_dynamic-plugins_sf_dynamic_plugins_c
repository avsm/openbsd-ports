$OpenBSD: patch-src_dynamic-plugins_sf_dynamic_plugins_c,v 1.3 2009/02/12 22:12:08 rui Exp $
--- src/dynamic-plugins/sf_dynamic_plugins.c.orig	Wed Apr 30 20:53:15 2008
+++ src/dynamic-plugins/sf_dynamic_plugins.c	Fri Aug  8 14:57:43 2008
@@ -227,8 +227,7 @@ void LoadAllLibs(char *path, LoadLibraryFunc loadFunc)
         dirEntry = readdir(directory);
         while (dirEntry)
         {
-            if (dirEntry->d_reclen &&
-                !fnmatch(EXT, dirEntry->d_name, FNM_PATHNAME | FNM_PERIOD))
+                if(!fnmatch(EXT, dirEntry->d_name, FNM_PATHNAME | FNM_PERIOD))
             {
                 SnortSnprintf(path_buf, PATH_MAX, "%s%s%s", path, "/", dirEntry->d_name);
                 loadFunc(path_buf, 1);

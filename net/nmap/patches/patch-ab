--- tcpip.c.orig	Thu Jan 27 04:52:19 2000
+++ tcpip.c	Sun Jan 30 01:06:43 2000
@@ -963,6 +963,7 @@
  switch(datalink) {
  case DLT_EN10MB: offset = 14; break;
  case DLT_IEEE802: offset = 22; break;
+ case DLT_LOOP:
  case DLT_NULL: offset = 4; break;
  case DLT_SLIP:
 #ifdef DLT_SLIP_BSDOS
@@ -990,6 +991,7 @@
    break;
  case DLT_RAW: offset = 0; break;
  case DLT_FDDI: offset = 21; break;
+ case DLT_ENC: offset = 12; break;
  default: fatal("Unknown datalink type (%d)", datalink);
  }
 

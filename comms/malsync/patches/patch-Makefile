$OpenBSD: patch-Makefile,v 1.1 2001/05/23 20:45:02 jakob Exp $

--- Makefile	Sun May 14 21:17:35 2000
+++ Makefile	Sat May 19 22:08:16 2001
@@ -12,7 +12,16 @@ LINKLIBS = -ldl -lm
 endif
 
 TREETOP = ../../..
+ifeq ($(PLAT),OpenBSD)
+PILOT_LINK_DIR = ${PREFIX}
+PILOT_LINK_LIB = ${PILOT_LINK_DIR}/lib
+else
 PILOT_LINK_DIR = $(TREETOP)/vendor/pilot/pilot-link.0.9.3
+PILOT_LINK_LIB = ${PILOT_LINK_DIR}/libsock
+endif
+
+BINDIR=${PREFIX}/bin
+DOCDIR=${PREFIX}/share/doc/malsync
 
 CFLAGS = -Wall -g -DMALSYNC -I$(TREETOP)/mal/common \
   -I$(TREETOP)/mal/client/common -I$(PILOT_LINK_DIR)/include -I.
@@ -55,17 +64,23 @@ endif
 
 OBJS = $(SRC:.c=.o)
 
+all:${TARGET}
 
 $(TARGET): $(OBJS)
 	$(CC) -rdynamic  $(CFLAGS) -o $@ $(OBJS) \
-          -L${PILOT_LINK_DIR}/libsock -lpisock $(LINKLIBS)
+          -L${PILOT_LINK_LIB} -lpisock $(LINKLIBS)
 clean:
 	rm -f $(OBJS) $(TARGET)
 
 .c.o:
 	gcc $(CFLAGS) -c -o $@ $<
 
-
+install: ${TARGET}
+	install -c ${TARGET} ${BINDIR}
+	@if [ -d ${DOCDIR} ]; then set +x; \
+	else (set -x; mkdir -p ${DOCDIR}); fi
+	install -c -m 0644 ${TREETOP}/Doc/README* ${DOCDIR}
+	install -c -m 0644 ${TREETOP}/mal/MPL-* ${DOCDIR}
 
 
 

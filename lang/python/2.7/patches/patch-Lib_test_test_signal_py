$OpenBSD: patch-Lib_test_test_signal_py,v 1.2 2011/05/08 22:46:19 fgsch Exp $

workarounds for breakage caused by libpthread

--- Lib/test/test_signal.py.orig	Sun Nov 21 13:34:58 2010
+++ Lib/test/test_signal.py	Sat May  7 10:45:56 2011
@@ -362,6 +362,8 @@ class SiginterruptTest(unittest.TestCase):
         i = self.readpipe_interrupted()
         self.assertTrue(i)
 
+    @unittest.skipIf(sys.platform in ('openbsd3', 'openbsd4'),
+        'siginterrupt not reliable (does not mix well with threading) on some BSDs.')
     def test_siginterrupt_off(self):
         """If a signal handler is installed and siginterrupt is called with
         a false value for the second argument, when that signal arrives, it
@@ -461,8 +463,8 @@ class ItimerTest(unittest.TestCase):
         self.assertEqual(self.hndl_called, True)
 
     # Issue 3864. Unknown if this affects earlier versions of freebsd also.
-    @unittest.skipIf(sys.platform=='freebsd6',
-        'itimer not reliable (does not mix well with threading) on freebsd6')
+    @unittest.skipIf(sys.platform in ('freebsd6', 'openbsd3', 'openbsd4'),
+        'itimer not reliable (does not mix well with threading) on some BSDs.')
     def test_itimer_prof(self):
         self.itimer = signal.ITIMER_PROF
         signal.signal(signal.SIGPROF, self.sig_prof)

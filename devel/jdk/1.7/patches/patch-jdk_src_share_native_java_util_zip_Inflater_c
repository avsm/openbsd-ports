$OpenBSD: patch-jdk_src_share_native_java_util_zip_Inflater_c,v 1.3 2011/01/11 15:47:50 kurt Exp $
--- jdk/src/share/native/java/util/zip/Inflater.c.orig	Thu Dec 16 17:14:38 2010
+++ jdk/src/share/native/java/util/zip/Inflater.c	Tue Jan  4 18:25:21 2011
@@ -67,6 +67,10 @@ Java_java_util_zip_Inflater_init(JNIEnv *env, jclass c
         return jlong_zero;
     } else {
         char *msg;
+// BSDXXX needed for FreeBSD 5.4 and below with system zlib
+#if defined(__FreeBSD__) && __FreeBSD__ < 6
+	strm->adler = 1;
+#endif
         switch (inflateInit2(strm, nowrap ? -MAX_WBITS : MAX_WBITS)) {
           case Z_OK:
             return ptr_to_jlong(strm);
@@ -215,6 +219,10 @@ Java_java_util_zip_Inflater_reset(JNIEnv *env, jclass 
     if (inflateReset(jlong_to_ptr(addr)) != Z_OK) {
         JNU_ThrowInternalError(env, 0);
     }
+// BSDXXX needed for FreeBSD 5.4 and below with system zlib
+#if defined(__FreeBSD__) && __FreeBSD__ < 6
+    ((z_stream *)jlong_to_ptr(strm))->adler = 1;
+#endif
 }
 
 JNIEXPORT void JNICALL

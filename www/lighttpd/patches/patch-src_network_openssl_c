$OpenBSD: patch-src_network_openssl_c,v 1.1 2008/04/03 10:18:15 jasper Exp $
--- src/network_openssl.c.orig	Wed Apr  2 19:20:16 2008
+++ src/network_openssl.c	Wed Apr  2 19:21:18 2008
@@ -85,6 +85,7 @@ int network_write_chunkqueue_openssl(server *srv, conn
 			 *
 			 */
 
+			ERR_clear_error();
 			if ((r = SSL_write(ssl, offset, toSend)) <= 0) {
 				unsigned long err;
 
@@ -187,6 +188,7 @@ int network_write_chunkqueue_openssl(server *srv, conn
 
 				close(ifd);
 
+				ERR_clear_error();
 				if ((r = SSL_write(ssl, s, toSend)) <= 0) {
 					unsigned long err;
 

$OpenBSD: patch-make_lib_mak,v 1.2 2010/03/26 14:24:42 ajacoutot Exp $
--- make/lib.mak.orig	Mon Sep 21 02:25:30 2009
+++ make/lib.mak	Fri Mar 26 15:18:29 2010
@@ -29,10 +29,14 @@
 #
 
 ifeq (,$(findstring $(OSTYPE),Darwin cygwin mingw))
-  ifeq ($(BUILD_TYPE),.)
-    LIBNAME_PAT	= $(LIB_FILENAME).$(MAJOR_VERSION).$(MINOR_VERSION).$(BUILD_NUMBER)
+  ifeq ($(OSTYPE),OpenBSD)
+    LIBNAME_PAT = $(LIB_FILENAME).$(MAJOR_VERSION).$(MINOR_VERSION)
   else
-    LIBNAME_PAT	= $(LIB_FILENAME).$(MAJOR_VERSION).$(MINOR_VERSION)-$(BUILD_TYPE)$(BUILD_NUMBER)
+    ifeq ($(BUILD_TYPE),.)
+      LIBNAME_PAT	= $(LIB_FILENAME).$(MAJOR_VERSION).$(MINOR_VERSION).$(BUILD_NUMBER)
+    else
+      LIBNAME_PAT	= $(LIB_FILENAME).$(MAJOR_VERSION).$(MINOR_VERSION)-$(BUILD_TYPE)$(BUILD_NUMBER)
+    endif
   endif
 else
   ifeq ($(BUILD_TYPE),.)
@@ -98,10 +102,14 @@ ifeq ($(P_SHAREDLIB),1)
       LDSOOPTS += -Wl,--kill-at
     else
       ifneq ($(OSTYPE),Darwin)
-        LDSOOPTS += -Wl,-soname,$(LIB_SONAME)
+        ifneq ($(OSTYPE),OpenBSD)
+          LDSOOPTS += -Wl,-soname,$(LIB_SONAME)
+        endif
       endif
     endif
   endif
+
+  LDSOOPTS += -fPIC
 
   $(LIBDIR)/$(LIB_FILENAME): $(LIBDIR)/$(LIBNAME_PAT)
 	@cd $(LIBDIR) ; rm -f $(LIB_FILENAME) ; ln -sf $(LIBNAME_PAT) $(LIB_FILENAME)

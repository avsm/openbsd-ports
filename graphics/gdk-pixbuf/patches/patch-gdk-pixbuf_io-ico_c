$OpenBSD: patch-gdk-pixbuf_io-ico_c,v 1.2 2009/01/09 16:13:22 naddy Exp $
--- gdk-pixbuf/io-ico.c.orig	Sat Sep 28 00:19:15 2002
+++ gdk-pixbuf/io-ico.c	Fri Jan  9 17:12:25 2009
@@ -330,6 +330,11 @@ DecodeHeader (guchar *Data, gint Bytes, struct ico_pro
 
 	State->HeaderSize+=I;
 
+	if (State->HeaderSize < 0) {
+		g_error ("DecodeHeader(): Invalid header in icon");
+		return;
+	}
+
  	if (State->HeaderSize>State->BytesInHeaderBuf) {
 		guchar *tmp=realloc(State->HeaderBuf,State->HeaderSize);
 		if (!tmp)

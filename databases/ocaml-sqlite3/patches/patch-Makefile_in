$OpenBSD: patch-Makefile_in,v 1.1.1.1 2006/06/01 01:20:25 avsm Exp $
--- Makefile.in.orig	Mon Oct 17 03:25:28 2005
+++ Makefile.in	Mon May 29 22:19:44 2006
@@ -5,7 +5,7 @@ exec_prefix=@exec_prefix@
 bindir=@bindir@
 
 CC=@CC@
-CFLAGS=@CPPFLAGS@ @CFLAGS@ 
+CFLAGS=@CPPFLAGS@ @CFLAGS@ @DEFS@
 LIBS=@LIBS@
 LDFLAGS=@LDFLAGS@
 
@@ -34,9 +34,8 @@ distclean: clean
 # install rebuilds sqlite3top to point to the findlib-managed dll and not the
 # one in . 
 install: sqlite3.cma sqlite3.cmxa sqlite3top
-	ocamlfind install sqlite3 META sqlite3.cmi sqlite3.mli sqlite3.cma *.cmxa *.a *.cmx *.so
-	ocamlfind ocamlmktop -o sqlite3top -package "sqlite3" sqlite3.cma
-	$(INSTALL) sqlite3top $(bindir)/sqlite3top
+	ocamlfind install sqlite3 META sqlite3.cmi sqlite3.mli sqlite3.cma -optional *.cmxa *.a *.cmx *.so
+	$(INSTALL) sqlite3top $(DESTDIR)$(bindir)/sqlite3top
 
 remove: uninstall
 uninstall:
@@ -48,7 +47,7 @@ update: sqlite3.cma
 	make install
 
 sqlite3top: sqlite3.cma
-	ocamlfind ocamlmktop -o sqlite3top sqlite3.cma
+	ocamlfind ocamlmktop -o sqlite3top libsqlite3.a sqlite3.cma
 
 sqlite3.cma: sqlite3.cmo sqlite3_stubs.o
 	ocamlmklib -o sqlite3 sqlite3.cmo sqlite3_stubs.o $(LDFLAGS) $(LIBS) $(MKLIBFLAGS)

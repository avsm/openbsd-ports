--- portscanner.c.orig	Sun Aug  9 14:50:35 1998
+++ portscanner.c	Thu Dec  3 11:15:05 1998
@@ -24,18 +24,21 @@
 /***********************************************************/
 
 #include <stdio.h>
+#include <stdlib.h>
+#include <unistd.h>
 #include <sys/socket.h>
 #include <sys/types.h>
 #include <netinet/in.h>
-#include <unistd.h>
+#include <arpa/inet.h>
 #include <netdb.h>
 #include <sys/time.h>
 #include <fcntl.h>
+#include <string.h>
 
 int sock = -1;
 struct sockaddr_in address;
 int result;
-extern char *sys_errlist[];
+/* extern char *sys_errlist[]; */
 extern int errno;
 int current_port = 0; 
 u_short base_port = 0;
@@ -83,7 +86,7 @@
           } else if (verbose == 2) printf(" address valid\n");
    
    if ((base_port > end_port) || ((short)base_port < 0)) { 
-     fprintf(stderr,"Bad port range : start=%d end=%d !\n");
+     fprintf(stderr,"Bad port range : start=%d end=%d !\n",base_port,end_port);
      exit(1);
    } else if (verbose == 2) {
             printf("Port range: %d to %d\n",base_port,end_port);

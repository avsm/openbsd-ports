$OpenBSD: patch-src_IO_http_c,v 1.2 2002/05/02 19:16:25 couderc Exp $
--- src/IO/http.c.orig	Wed Apr 10 03:10:36 2002
+++ src/IO/http.c	Wed May  1 15:20:41 2002
@@ -237,7 +237,7 @@ static int Http_connect_socket(ChainLink
 {
    gint status;
    struct sockaddr_in name;
-   SocketData_t *S = a_Klist_get_data(ValidSocks, (gint)Info->LocalKey);
+   SocketData_t *S = a_Klist_get_data(ValidSocks, GPOINTER_TO_INT(Info->LocalKey));
 
    /* Some OSes require this...  */
    memset(&name, 0, sizeof(name));
@@ -332,7 +332,7 @@ static gint Http_get(ChainLink *Info, vo
 {
    void *link;
    const DilloUrl *Url = Data;
-   SocketData_t *S = a_Klist_get_data(ValidSocks, (gint)Info->LocalKey);
+   SocketData_t *S = a_Klist_get_data(ValidSocks, GPOINTER_TO_INT(Info->LocalKey));
    gchar hostname[256], *Host = hostname;
 
    /* Reference Info data */
@@ -377,7 +377,7 @@ static gint Http_get(ChainLink *Info, vo
 void
  a_Http_ccc(int Op, int Branch, ChainLink *Info, void *Data, void *ExtraData)
 {
-   gint SKey = (gint)Info->LocalKey;
+   gint SKey = GPOINTER_TO_INT(Info->LocalKey);
    SocketData_t *S = a_Klist_get_data(ValidSocks, SKey);
 
    if ( Branch == 1 ) {
@@ -385,7 +385,7 @@ void
       switch (Op) {
       case OpStart:
          SKey = Http_sock_new();
-         Info->LocalKey = (void *) SKey;
+         Info->LocalKey = GPOINTER_TO_INT(SKey);
          if (Http_get(Info, Data, ExtraData) < 0) {
             DEBUG_MSG(2, " HTTP: new abort handler! #2\n");
             S = a_Klist_get_data(ValidSocks, SKey);

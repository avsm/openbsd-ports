$OpenBSD: patch-src_gui_kernel_qapplication_x11_cpp,v 1.5 2006/06/04 09:37:43 espie Exp $
--- src/gui/kernel/qapplication_x11.cpp.orig	Mon May 22 12:31:11 2006
+++ src/gui/kernel/qapplication_x11.cpp	Mon May 22 12:31:28 2006
@@ -5554,7 +5554,7 @@ static void sm_performSaveYourself(QSess
     sm_setProperty(QString::fromLatin1(SmProgram), QString::fromLocal8Bit(qApp->argv()[0]));
     // tell the session manager about our user as well.
     struct passwd *entryPtr = 0;
-#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS)
+#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)
     QVarLengthArray<char, 1024> buf(sysconf(_SC_GETPW_R_SIZE_MAX));
     struct passwd entry;
     getpwuid_r(geteuid(), &entry, buf.data(), buf.size(), &entryPtr);

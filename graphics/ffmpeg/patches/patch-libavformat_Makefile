$OpenBSD: patch-libavformat_Makefile,v 1.8 2005/02/09 23:41:43 naddy Exp $
--- libavformat/Makefile.orig	Tue Jan 11 00:16:04 2005
+++ libavformat/Makefile	Tue Feb  8 17:03:23 2005
@@ -42,7 +42,7 @@ OBJS+= avio.o aviobuf.o file.o 
 OBJS+= framehook.o 
 
 ifeq ($(CONFIG_VIDEO4LINUX),yes)
-OBJS+= grab.o
+OBJS+= grab_bsdbktr.o
 endif
 
 ifeq ($(CONFIG_DV1394),yes)
@@ -83,6 +83,7 @@ endif
 LIB= $(LIBPREF)avformat$(LIBSUF)
 ifeq ($(BUILD_SHARED),yes)
 SLIB= $(SLIBPREF)avformat$(SLIBSUF)
+CFLAGS += ${PIC} -DPIC
 endif
 
 EXTRALIBS+=-lavcodec -L../libavcodec
@@ -104,7 +105,7 @@ ifeq ($(CONFIG_WIN32),yes)
 	$(CC) $(SHFLAGS) -Wl,--output-def,$(@:.dll=.def) -o $@ $(OBJS) $(PPOBJS) $(EXTRALIBS) $(VPATH)/../libavcodec/avcodec.dll
 	-lib /machine:i386 /def:$(@:.dll=.def)
 else
-	$(CC) $(SHFLAGS) -o $@ $(OBJS) $(PPOBJS) $(EXTRALIBS)
+	$(CC) $(SHFLAGS) -o $@ $(OBJS) $(PPOBJS) $(LDFLAGS)
 endif
 
 depend: $(SRCS)

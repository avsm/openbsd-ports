$OpenBSD: patch-hotspot_build_bsd_makefiles_gcc_make,v 1.4 2008/12/22 13:22:12 kurt Exp $
--- hotspot/build/bsd/makefiles/gcc.make.orig	Sat Dec 20 22:26:49 2008
+++ hotspot/build/bsd/makefiles/gcc.make	Sat Dec 20 23:52:53 2008
@@ -25,9 +25,10 @@
 #------------------------------------------------------------------------
 # CC, CPP & AS
 
-CPP = g++
-CC  = gcc
-AS  = $(CC) -c
+CXX ?= g++
+CPP  = $(CXX)
+CC  ?= gcc
+AS   = $(CC) -c
 
 # -dumpversion in gcc-2.91 shows "egcs-2.91.66". In later version, it only
 # prints the numbers (e.g. "2.95", "3.2.1")
@@ -50,19 +51,12 @@ PICFLAG = -fPIC
 
 VM_PICFLAG/LIBJVM = $(PICFLAG)
 VM_PICFLAG/AOUT   =
-
-ifneq ($(BUILDARCH), i486)
 VM_PICFLAG        = $(VM_PICFLAG/$(LINK_INTO))
-else
-# PIC has significant overhead on x86, build nonpic VM for now.
-# Link JVM at a "good" base location to avoid unnecessary .text patching.
-JVM_BASE_ADDR     = 0x06000000
-endif
 
 CFLAGS += $(VM_PICFLAG)
 CFLAGS += -fno-rtti
 CFLAGS += -fno-exceptions
-CFLAGS += -D_REENTRANT
+CFLAGS += -pthread
 CFLAGS += -fcheck-new
 
 ARCHFLAG = $(ARCHFLAG/$(BUILDARCH))
@@ -90,7 +84,7 @@ else
 endif
 
 # Compiler warnings are treated as errors
-WARNINGS_ARE_ERRORS = -Werror
+#WARNINGS_ARE_ERRORS = -Werror
 # Except for a few acceptable ones
 ACCEPTABLE_WARNINGS = -Wpointer-arith -Wconversion -Wsign-compare
 CFLAGS_WARN/DEFAULT = $(WARNINGS_ARE_ERRORS) $(ACCEPTABLE_WARNINGS)
@@ -136,7 +130,7 @@ MAPFLAG = -Xlinker --version-script=FILENAME
 SONAMEFLAG = -Xlinker -soname=SONAME
 
 # Build shared library
-SHARED_FLAG = -shared
+SHARED_FLAG = -shared $(VM_PICFLAG)
 
 # Keep symbols even they are not used
 AOUT_FLAGS += -export-dynamic
